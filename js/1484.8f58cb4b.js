"use strict";(globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[]).push([[1484],{7474:(e,a,s)=>{s.r(a),s.d(a,{default:()=>R});var n=s(9835),o=s(6970),t=s(1957);const r={class:"messages"},i={key:0};function c(e,a,s,c,l,p){const d=(0,n.up)("q-menu"),u=(0,n.up)("q-btn"),m=(0,n.up)("PageHeader"),v=(0,n.up)("ConversationItem"),g=(0,n.up)("BaseIcon"),k=(0,n.up)("json-viewer"),h=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(m,{"back-button":""},{addon:(0,n.w5)((()=>[(0,n.Wm)(u,{icon:"more_vert",size:"md",round:"",flat:""},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{anchor:"bottom right",self:"top right",offset:[0,6],class:"options-popup"},{default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.iD)("a",{onClick:a[0]||(a[0]=(...e)=>p.markAllAsRead&&p.markAllAsRead(...e))},[(0,n.Uk)((0,o.zw)(e.$t("Mark all as read")),1)])),[[h]])])),_:1})])),_:1})])),_:1}),(0,n._)("div",r,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(p.conversations,(e=>((0,n.wg)(),(0,n.j4)(v,{key:e.pubkey,conversation:e},null,8,["conversation"])))),128)),p.conversations?.length?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",i,[(0,n.Uk)((0,o.zw)(e.$t("To send a message, click on the"))+" ",1),(0,n.Wm)(g,{icon:"messages"}),(0,n.Uk)(" "+(0,o.zw)(e.$t("icon in the recipient's profile.")),1)]))]),l.opendata?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(u,{key:0,color:"primary",size:"sm",onClick:a[1]||(a[1]=(0,t.iM)((e=>p.openToggle()),["stop"])),label:"raw data",class:"qbtn-style","icon-right":"arrow_drop_down"})),l.opendata?((0,n.wg)(),(0,n.j4)(u,{key:1,color:"primary",size:"sm",onClick:a[2]||(a[2]=(0,t.iM)((e=>p.openToggle()),["stop"])),label:"raw data",class:"qbtn-style","icon-right":"arrow_drop_up"})):(0,n.kq)("",!0),l.opendata?((0,n.wg)(),(0,n.j4)(k,{key:2,value:p.conversations,clickable:"",onClick:a[3]||(a[3]=(0,t.iM)((()=>{}),["stop"])),theme:"my-awesome-json-theme"},null,8,["value"])):(0,n.kq)("",!0)],64)}var l=s(8803),p=s.n(l),d=s(4586),u=s(3099),m=s(8039),v=s(3413);const g=e=>((0,n.dD)("data-v-4ee7086d"),e=e(),(0,n.Cn)(),e),k={class:"conversation-item-avatar"},h={class:"conversation-item-content"},b=g((()=>(0,n._)("div",{class:"usernbsp"}," Â  ",-1))),w={class:"username"},y={class:"conversation-item-info"},_={key:0,class:"created-at"};function f(e,a,s,t,r,i){const c=(0,n.up)("UserAvatar"),l=(0,n.up)("UserName"),p=(0,n.up)("q-badge");return(0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)(["conversation-item",{"has-unread":s.conversation.numUnread}]),onClick:a[0]||(a[0]=e=>i.goToConversation())},[(0,n._)("div",k,[(0,n.Wm)(c,{pubkey:s.conversation.pubkey},null,8,["pubkey"])]),(0,n._)("div",h,[b,(0,n._)("div",w,[(0,n.Wm)(l,{pubkey:s.conversation.pubkey,"show-verified":""},null,8,["pubkey"])])]),(0,n._)("div",y,[s.conversation.latestMessage?((0,n.wg)(),(0,n.iD)("div",_,(0,o.zw)(i.createdAt),1)):(0,n.kq)("",!0),s.conversation.numUnread?((0,n.wg)(),(0,n.j4)(p,{key:1,label:s.conversation.numUnread,color:"primary",class:"unreads",rounded:""},null,8,["label"])):(0,n.kq)("",!0)])],2)}s(9665);var C=s(5501),q=s(9715),Z=s(5532),A=s(2296),M=s(4520);const U={name:"ConversationItem",components:{EncryptedMessage:Z.Z,UserName:q.Z,UserAvatar:C.Z,JsonViewer:p()},props:{conversation:{type:Object,required:!0}},computed:{createdAt(){if(!this.conversation.latestMessage)return;const e=this.$q.screen.lt.md?"short":"long";return A.Z.formatFromNow(this.conversation.latestMessage.created_at,e)}},data(){return{opendata:!1}},methods:{openToggle(){this.opendata=!this.opendata},goToConversation(){this.$router.push({name:"conversation",params:{pubkey:(0,M.jm)(this.conversation.pubkey,"npub")}})}}};var j=s(1639),T=s(8879),D=s(990),I=s(9984),W=s.n(I);const z=(0,j.Z)(U,[["render",f],["__scopeId","data-v-4ee7086d"]]),B=z;W()(U,"components",{QBtn:T.Z,QBadge:D.Z});var F=s(7664);const P={name:"Messages",components:{BaseIcon:F.Z,ConversationItem:B,PageHeader:d.Z,JsonViewer:p()},setup(){return{app:(0,u.q)(),nostr:(0,m.D)(),messages:(0,v.G)()}},data(){return{opendata:!1}},computed:{conversations(){return this.app.isSignedIn?this.messages.getConversations(this.app.myPubkey):[]}},methods:{openToggle(){this.opendata=!this.opendata},markAllAsRead(){this.messages.markAllAsRead(this.app.myPubkey)}}};var Q=s(6362),$=s(2146);const H=(0,j.Z)(P,[["render",c],["__scopeId","data-v-7f2f53d2"]]),R=H;W()(P,"components",{QBtn:T.Z,QMenu:Q.Z}),W()(P,"directives",{ClosePopup:$.Z})}}]);