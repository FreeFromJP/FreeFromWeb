"use strict";(globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[]).push([[1977],{6198:(e,s,a)=>{a.r(s),a.d(s,{default:()=>H});var n=a(9835),o=a(6970);const t={class:"messages"},r={key:0};function i(e,s,a,i,c,l){const p=(0,n.up)("q-menu"),u=(0,n.up)("q-btn"),d=(0,n.up)("PageHeader"),m=(0,n.up)("ConversationItem"),v=(0,n.up)("BaseIcon"),g=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(d,{"back-button":""},{addon:(0,n.w5)((()=>[(0,n.Wm)(u,{icon:"more_vert",size:"md",round:"",flat:""},{default:(0,n.w5)((()=>[(0,n.Wm)(p,{anchor:"bottom right",self:"top right",offset:[0,6],class:"options-popup"},{default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.iD)("a",{onClick:s[0]||(s[0]=(...e)=>l.markAllAsRead&&l.markAllAsRead(...e))},[(0,n.Uk)((0,o.zw)(e.$t("Mark all as read")),1)])),[[g]])])),_:1})])),_:1})])),_:1}),(0,n._)("div",t,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.conversations,(e=>((0,n.wg)(),(0,n.j4)(m,{key:e.pubkey,conversation:e},null,8,["conversation"])))),128)),l.conversations?.length?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("p",r,[(0,n.Uk)((0,o.zw)(e.$t("To send a message, click on the"))+" ",1),(0,n.Wm)(v,{icon:"messages"}),(0,n.Uk)(" "+(0,o.zw)(e.$t("icon in the recipient's profile.")),1)]))])],64)}var c=a(9010),l=a(3099),p=a(6166),u=a(3413),d=a(1957);const m={class:"conversation-item-avatar"},v={class:"conversation-item-content"},g={class:"username"},k={key:0,class:"message"},h={class:"conversation-item-info"},b={key:0,class:"created-at"};function w(e,s,a,t,r,i){const c=(0,n.up)("UserAvatar"),l=(0,n.up)("UserName"),p=(0,n.up)("EncryptedMessage"),u=(0,n.up)("q-btn"),w=(0,n.up)("json-viewer"),y=(0,n.up)("q-badge");return(0,n.wg)(),(0,n.iD)("div",{class:(0,o.C_)(["conversation-item",{"has-unread":a.conversation.numUnread}]),onClick:s[3]||(s[3]=e=>i.goToConversation())},[(0,n._)("div",m,[(0,n.Wm)(c,{pubkey:a.conversation.pubkey},null,8,["pubkey"])]),(0,n._)("div",v,[(0,n._)("div",g,[(0,n.Wm)(l,{pubkey:a.conversation.pubkey,"show-verified":""},null,8,["pubkey"])]),a.conversation.latestMessage?((0,n.wg)(),(0,n.iD)("div",k,[(0,n.Wm)(p,{message:a.conversation.latestMessage},null,8,["message"])])):(0,n.kq)("",!0),r.opendata?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(u,{key:1,color:"primary",size:"sm",onClick:s[0]||(s[0]=(0,d.iM)((e=>i.openToggle()),["stop"])),label:"raw data",class:"qbtn-style","icon-right":"arrow_drop_down"})),r.opendata?((0,n.wg)(),(0,n.j4)(u,{key:2,color:"primary",size:"sm",onClick:s[1]||(s[1]=(0,d.iM)((e=>i.openToggle()),["stop"])),label:"raw data",class:"qbtn-style","icon-right":"arrow_drop_up"})):(0,n.kq)("",!0),r.opendata?((0,n.wg)(),(0,n.j4)(w,{key:3,value:a.conversation,clickable:"",onClick:s[2]||(s[2]=(0,d.iM)((()=>{}),["stop"])),theme:"my-awesome-json-theme"},null,8,["value"])):(0,n.kq)("",!0)]),(0,n._)("div",h,[a.conversation.latestMessage?((0,n.wg)(),(0,n.iD)("div",b,(0,o.zw)(i.createdAt),1)):(0,n.kq)("",!0),a.conversation.numUnread?((0,n.wg)(),(0,n.j4)(y,{key:1,label:a.conversation.numUnread,color:"primary",class:"unreads",rounded:""},null,8,["label"])):(0,n.kq)("",!0)])],2)}a(9665);var y=a(8803),_=a.n(y),f=a(5501),q=a(9715),C=a(528),M=a(2296),Z=a(4520);const A={name:"ConversationItem",components:{EncryptedMessage:C.Z,UserName:q.Z,UserAvatar:f.Z,JsonViewer:_()},props:{conversation:{type:Object,required:!0}},computed:{createdAt(){if(!this.conversation.latestMessage)return;const e=this.$q.screen.lt.md?"short":"long";return M.Z.formatFromNow(this.conversation.latestMessage.created_at,e)}},data(){return{opendata:!1}},methods:{openToggle(){this.opendata=!this.opendata},goToConversation(){this.$router.push({name:"conversation",params:{pubkey:(0,Z.jm)(this.conversation.pubkey,"npub")}})}}};var U=a(1639),j=a(8879),W=a(990),D=a(9984),I=a.n(D);const T=(0,U.Z)(A,[["render",w],["__scopeId","data-v-5fd1ccc7"]]),z=T;I()(A,"components",{QBtn:j.Z,QBadge:W.Z});var B=a(7664);const F={name:"Messages",components:{BaseIcon:B.Z,ConversationItem:z,PageHeader:c.Z},setup(){return{app:(0,l.q)(),nostr:(0,p.D)(),messages:(0,u.G)()}},computed:{conversations(){return this.app.isSignedIn?this.messages.getConversations(this.app.myPubkey):[]}},methods:{markAllAsRead(){this.messages.markAllAsRead(this.app.myPubkey)}}};var P=a(6362),Q=a(2146);const $=(0,U.Z)(F,[["render",i],["__scopeId","data-v-0112f406"]]),H=$;I()(F,"components",{QBtn:j.Z,QMenu:P.Z}),I()(F,"directives",{ClosePopup:Q.Z})}}]);