"use strict";(globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[]).push([[4933],{8365:(e,t,i)=>{i.r(t),i.d(t,{default:()=>B});var a=i(9835);const l={class:"settings"};function s(e,t,i,s,n,o){const r=(0,a.up)("PageHeader"),u=(0,a.up)("ProfileSettings"),d=(0,a.up)("RelaySettings");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(r,{"back-button":""}),(0,a._)("div",l,[(0,a.Wm)(u),(0,a.Wm)(d)])],64)}var n=i(4586),o=i(6970),r=i(1957);const u={class:"relay-settings"},d={class:"relay-url"},p={class:"buttons"},c=["disabled"];function m(e,t,i,l,s,n){const m=(0,a.up)("q-tooltip"),b=(0,a.up)("q-btn"),h=(0,a.up)("q-input"),f=(0,a.up)("q-form");return(0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("h3",null,(0,o.zw)(e.$t("Relays")),1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.settings.relays,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t,class:"relay"},[(0,a._)("span",d,(0,o.zw)(t),1),(0,a.Wm)(b,{icon:"delete_outline",size:"sm",class:"btn-icon",flat:"",round:"",onClick:e=>n.removeRelay(t)},{default:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.$t("Delete relay")),1)])),_:1})])),_:2},1032,["onClick"])])))),128)),(0,a.Wm)(f,{class:"add-relay",onSubmit:(0,r.iM)(n.addRelay,["stop"])},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{modelValue:s.newRelayUrl,"onUpdate:modelValue":t[0]||(t[0]=e=>s.newRelayUrl=e),label:e.$t("Add relay"),dense:""},null,8,["modelValue","label"]),(0,a.Wm)(b,{type:"submit",icon:"add_circle_outline",size:"sm",flat:"",round:"",disabled:!s.newRelayUrl,class:"btn-icon"},null,8,["disabled"])])),_:1},8,["onSubmit"]),(0,a._)("div",p,[(0,a._)("button",{class:"btn btn-sm",disabled:!n.changed,onClick:t[1]||(t[1]=e=>l.settings.restoreDefaultRelays())},(0,o.zw)(e.$t("Restore defaults")),9,c)])])}i(5516),i(3036),i(2309);var b=i(6840),h=i(6827);const f={name:"RelaySettings",setup(){return{settings:(0,b.F)()}},data(){return{newRelayUrl:""}},computed:{changed(){return!this.settings.hasDefaultRelays()}},methods:{addRelay(){let e;try{e=new URL(this.newRelayUrl?.trim())}catch(i){return void h.Z.create({message:"Invalid URL",color:"negative"})}if("wss:"!==e.protocol)return void h.Z.create({message:"Must be a wss:// URL",color:"negative"});let t=e.href;"/"===e.pathname&&(t=t.slice(0,-1)),this.settings.hasRelay(t)?h.Z.create({message:"Relay already exists",color:"negative"}):(this.settings.addRelay(t),this.newRelayUrl="")},removeRelay(e){this.settings.removeRelay(e)}}};var g=i(1639),y=i(2857),v=i(8879),w=i(6858),R=i(8326),_=i(9687),k=i(8149),Z=i(9984),P=i.n(Z);const U=(0,g.Z)(f,[["render",m],["__scopeId","data-v-6aa1c0c5"]]),F=U;P()(f,"components",{QIcon:y.Z,QBtn:v.Z,QTooltip:w.Z,QForm:R.Z,QInput:_.Z,QField:k.Z});const V={class:"input"},D={class:"input"},W={class:"input"},S=["src"],$={class:"input"},q={class:"buttons"},z=["disabled"],I=["disabled"];function Q(e,t,i,l,s,n){const u=(0,a.up)("q-input"),d=(0,a.up)("q-icon"),p=(0,a.up)("q-form");return l.app.isSignedIn?((0,a.wg)(),(0,a.j4)(p,{key:0,class:"profile-settings",onSubmit:(0,r.iM)(n.updateProfile,["stop"])},{default:(0,a.w5)((()=>[(0,a._)("h3",null,(0,o.zw)(e.$t("Profile")),1),(0,a._)("div",V,[(0,a.Wm)(u,{modelValue:s.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.name=e),label:e.$t("Name"),maxlength:"64",dense:""},null,8,["modelValue","label"])]),(0,a._)("div",D,[(0,a.Wm)(u,{modelValue:s.about,"onUpdate:modelValue":t[1]||(t[1]=e=>s.about=e),label:e.$t("About"),maxlength:"150",autogrow:"",dense:""},null,8,["modelValue","label"])]),(0,a._)("div",W,[(0,a.Wm)(u,{modelValue:s.picture,"onUpdate:modelValue":t[2]||(t[2]=e=>s.picture=e),label:e.$t("Picture URL"),dense:""},null,8,["modelValue","label"]),s.picture?((0,a.wg)(),(0,a.iD)("img",{key:0,src:s.picture,class:"picture-preview",loading:"lazy"},null,8,S)):(0,a.kq)("",!0)]),(0,a._)("div",$,[(0,a.Wm)(u,{modelValue:s.nip05,"onUpdate:modelValue":t[3]||(t[3]=e=>s.nip05=e),label:e.$t("NIP05 Identifier"),dense:""},null,8,["modelValue","label"]),s.verified?((0,a.wg)(),(0,a.j4)(d,{key:0,name:"verified",class:"nip05-verified",size:"sm"})):(0,a.kq)("",!0)]),(0,a._)("div",q,[(0,a._)("button",{type:"submit",disabled:!n.changed,class:"btn btn-sm btn-primary"},(0,o.zw)(e.$t("Save")),9,z),(0,a._)("button",{class:"btn btn-sm",disabled:!n.changed,onClick:t[4]||(t[4]=(...e)=>n.setDataFromProfile&&n.setDataFromProfile(...e))},(0,o.zw)(e.$t("Reset")),9,I)])])),_:1},8,["onSubmit"])):(0,a.kq)("",!0)}var C=i(8039),H=i(3099),L=i(556),x=i(1153),M=i(5155);const T={name:"ProfileSettings",components:{},setup(){return{app:(0,H.q)(),nostr:(0,C.D)()}},data(){return{name:"",about:"",picture:"",nip05:"",verified:!1}},computed:{pubkey(){return this.app.myPubkey},profile(){if(this.pubkey)return this.nostr.getProfile(this.pubkey)},changed(){return this.name!==(this.profile?.name||"")||this.about!==(this.profile?.about||"")||this.picture!==(this.profile?.picture||"")||this.nip05!==(this.profile?.nip05?.url||"")}},methods:{setDataFromProfile(){this.name=this.profile?.name||"",this.about=this.profile?.about||"",this.picture=this.profile?.picture||"",this.nip05=this.profile?.nip05.url||"",this.verified=this.profile?.nip05.verified},async updateProfile(){const e={name:this.name||void 0,about:this.about||void 0,picture:this.picture||void 0,nip05:this.nip05||void 0},t=x.Z.metadata(this.pubkey,e).build();await this.app.signEvent(t)&&(await this.nostr.publish(t)||this.$q.notify({message:(0,M.$t)("Failed to update profile"),color:"negative"}))}},watch:{profile(){this.setDataFromProfile()},async nip05(){this.verified=await L.Z.verify(this.pubkey,this.nip05)}},mounted(){this.setDataFromProfile()}},j=(0,g.Z)(T,[["render",Q],["__scopeId","data-v-7fcaa4aa"]]),A=j;P()(T,"components",{QForm:R.Z,QInput:_.Z,QIcon:y.Z,QField:k.Z});const N={name:"Settings",components:{PageHeader:n.Z,ProfileSettings:A,RelaySettings:F}},Y=(0,g.Z)(N,[["render",s],["__scopeId","data-v-e80a2846"]]),B=Y}}]);