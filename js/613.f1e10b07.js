"use strict";(globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[]).push([[613],{9010:(e,t,a)=>{a.d(t,{Z:()=>c});var i=a(9835),s=a(6970);const l={key:0},n={class:"addon"};function o(e,t,a,o,r,u){const d=(0,i.up)("base-icon");return(0,i.wg)(),(0,i.iD)("div",{class:(0,s.C_)(["page-header",{dense:e.dense}])},[e.backButton?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"back-button",onClick:t[0]||(t[0]=t=>e.$router.go(-1))},[(0,i.Wm)(d,{icon:"back"})])):(0,i.kq)("",!0),(0,i._)("div",{class:(0,s.C_)({"profile-info":!!e.subline})},[(0,i.WI)(e.$slots,"default",{},(()=>[(0,i._)("h2",null,(0,s.zw)(e.$t(e.title||e.titleFromRoute()||"Home")),1),e.subline?((0,i.wg)(),(0,i.iD)("span",l,(0,s.zw)(e.subline),1)):(0,i.kq)("",!0)]))],2),(0,i._)("div",n,[(0,i.WI)(e.$slots,"addon")])],2)}var r=a(7664);const u=(0,i.aZ)({name:"PageHeader",components:{BaseIcon:r.Z},props:{title:{type:String,default:void 0},subline:{type:String,default:void 0},backButton:{type:Boolean,default:!1},logo:{type:Boolean,default:!1},dense:{type:Boolean,default:!1}},methods:{titleFromRoute(){const e=this.$route.name?.toLowerCase();return e?.charAt(0).toUpperCase()+e?.substring(1)}}});var d=a(1639);const p=(0,d.Z)(u,[["render",o]]),c=p},2613:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var i=a(9835);const s={class:"settings"};function l(e,t,a,l,n,o){const r=(0,i.up)("PageHeader"),u=(0,i.up)("ProfileSettings"),d=(0,i.up)("RelaySettings");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(r,{"back-button":""}),(0,i._)("div",s,[(0,i.Wm)(u),(0,i.Wm)(d)])],64)}var n=a(9010),o=a(6970),r=a(1957);const u={class:"relay-settings"},d={class:"relay-url"},p={class:"buttons"},c=["disabled"];function m(e,t,a,s,l,n){const m=(0,i.up)("q-tooltip"),b=(0,i.up)("q-btn"),h=(0,i.up)("q-input"),f=(0,i.up)("q-form");return(0,i.wg)(),(0,i.iD)("div",u,[(0,i._)("h3",null,(0,o.zw)(e.$t("Relays")),1),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.settings.relays,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"relay"},[(0,i._)("span",d,(0,o.zw)(t),1),(0,i.Wm)(b,{icon:"delete_outline",size:"sm",class:"btn-icon",flat:"",round:"",onClick:e=>n.removeRelay(t)},{default:(0,i.w5)((()=>[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("Delete relay")),1)])),_:1})])),_:2},1032,["onClick"])])))),128)),(0,i.Wm)(f,{class:"add-relay",onSubmit:(0,r.iM)(n.addRelay,["stop"])},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{modelValue:l.newRelayUrl,"onUpdate:modelValue":t[0]||(t[0]=e=>l.newRelayUrl=e),label:e.$t("Add relay"),dense:""},null,8,["modelValue","label"]),(0,i.Wm)(b,{type:"submit",icon:"add_circle_outline",size:"sm",flat:"",round:"",disabled:!l.newRelayUrl,class:"btn-icon"},null,8,["disabled"])])),_:1},8,["onSubmit"]),(0,i._)("div",p,[(0,i._)("button",{class:"btn btn-sm",disabled:!n.changed,onClick:t[1]||(t[1]=e=>s.settings.restoreDefaultRelays())},(0,o.zw)(e.$t("Restore defaults")),9,c)])])}var b=a(6840),h=a(6827);const f={name:"RelaySettings",setup(){return{settings:(0,b.F)()}},data(){return{newRelayUrl:""}},computed:{changed(){return!this.settings.hasDefaultRelays()}},methods:{addRelay(){let e;try{e=new URL(this.newRelayUrl?.trim())}catch(a){return void h.Z.create({message:"Invalid URL",color:"negative"})}if("wss:"!==e.protocol)return void h.Z.create({message:"Must be a wss:// URL",color:"negative"});let t=e.href;"/"===e.pathname&&(t=t.slice(0,-1)),this.settings.hasRelay(t)?h.Z.create({message:"Relay already exists",color:"negative"}):(this.settings.addRelay(t),this.newRelayUrl="")},removeRelay(e){this.settings.removeRelay(e)}}};var g=a(1639),y=a(2857),v=a(8879),w=a(6858),k=a(8326),_=a(9687),R=a(8149),Z=a(9984),P=a.n(Z);const $=(0,g.Z)(f,[["render",m],["__scopeId","data-v-07cc700f"]]),D=$;P()(f,"components",{QIcon:y.Z,QBtn:v.Z,QTooltip:w.Z,QForm:k.Z,QInput:_.Z,QField:R.Z});const F={class:"input"},U={class:"input"},W={class:"input"},S=["src"],V={class:"input"},q={class:"buttons"},I=["disabled"],z=["disabled"];function C(e,t,a,s,l,n){const u=(0,i.up)("q-input"),d=(0,i.up)("q-icon"),p=(0,i.up)("q-form");return s.app.isSignedIn?((0,i.wg)(),(0,i.j4)(p,{key:0,class:"profile-settings",onSubmit:(0,r.iM)(n.updateProfile,["stop"])},{default:(0,i.w5)((()=>[(0,i._)("h3",null,(0,o.zw)(e.$t("Profile")),1),(0,i._)("div",F,[(0,i.Wm)(u,{modelValue:l.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.name=e),label:e.$t("Name"),maxlength:"64",dense:""},null,8,["modelValue","label"])]),(0,i._)("div",U,[(0,i.Wm)(u,{modelValue:l.about,"onUpdate:modelValue":t[1]||(t[1]=e=>l.about=e),label:e.$t("About"),maxlength:"150",autogrow:"",dense:""},null,8,["modelValue","label"])]),(0,i._)("div",W,[(0,i.Wm)(u,{modelValue:l.picture,"onUpdate:modelValue":t[2]||(t[2]=e=>l.picture=e),label:e.$t("Picture URL"),dense:""},null,8,["modelValue","label"]),l.picture?((0,i.wg)(),(0,i.iD)("img",{key:0,src:l.picture,class:"picture-preview",loading:"lazy"},null,8,S)):(0,i.kq)("",!0)]),(0,i._)("div",V,[(0,i.Wm)(u,{modelValue:l.nip05,"onUpdate:modelValue":t[3]||(t[3]=e=>l.nip05=e),label:e.$t("NIP05 Identifier"),dense:""},null,8,["modelValue","label"]),l.verified?((0,i.wg)(),(0,i.j4)(d,{key:0,name:"verified",class:"nip05-verified",size:"sm"})):(0,i.kq)("",!0)]),(0,i._)("div",q,[(0,i._)("button",{type:"submit",disabled:!n.changed,class:"btn btn-sm btn-primary"},(0,o.zw)(e.$t("Save")),9,I),(0,i._)("button",{class:"btn btn-sm",disabled:!n.changed,onClick:t[4]||(t[4]=(...e)=>n.setDataFromProfile&&n.setDataFromProfile(...e))},(0,o.zw)(e.$t("Reset")),9,z)])])),_:1},8,["onSubmit"])):(0,i.kq)("",!0)}var Q=a(6166),B=a(3099),H=a(556),L=a(1153),x=a(5155);const A={name:"ProfileSettings",components:{},setup(){return{app:(0,B.q)(),nostr:(0,Q.D)()}},data(){return{name:"",about:"",picture:"",nip05:"",verified:!1}},computed:{pubkey(){return this.app.myPubkey},profile(){if(this.pubkey)return this.nostr.getProfile(this.pubkey)},changed(){return this.name!==(this.profile?.name||"")||this.about!==(this.profile?.about||"")||this.picture!==(this.profile?.picture||"")||this.nip05!==(this.profile?.nip05?.url||"")}},methods:{setDataFromProfile(){this.name=this.profile?.name||"",this.about=this.profile?.about||"",this.picture=this.profile?.picture||"",this.nip05=this.profile?.nip05.url||"",this.verified=this.profile?.nip05.verified},async updateProfile(){const e={name:this.name||void 0,about:this.about||void 0,picture:this.picture||void 0,nip05:this.nip05||void 0},t=L.Z.metadata(this.pubkey,e).build();await this.app.signEvent(t)&&(await this.nostr.publish(t)||this.$q.notify({message:(0,x.$t)("Failed to update profile"),color:"negative"}))}},watch:{profile(){this.setDataFromProfile()},async nip05(){this.verified=await H.Z.verify(this.pubkey,this.nip05)}},mounted(){this.setDataFromProfile()}},M=(0,g.Z)(A,[["render",C],["__scopeId","data-v-743d44a1"]]),T=M;P()(A,"components",{QForm:k.Z,QInput:_.Z,QIcon:y.Z,QField:R.Z});const j={name:"Settings",components:{PageHeader:n.Z,ProfileSettings:T,RelaySettings:D}},N=(0,g.Z)(j,[["render",l],["__scopeId","data-v-e80a2846"]]),Y=N}}]);