"use strict";(globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[]).push([[6645],{9944:(e,t,o)=>{function n(e=100){return{data(){return{displayPriority:0}},mounted(){this.runDisplayPriority()},methods:{runDisplayPriority(){const t=()=>{requestAnimationFrame((()=>{this.displayPriority++,this.displayPriority<e&&t()}))};t()},defer(e){return this.displayPriority>=e}}}}o.d(t,{Z:()=>n})},6401:(e,t,o)=>{o.d(t,{Z:()=>m});var n=o(9835),s=o(6970);const a={key:0,class:"list-placeholder"},l={key:1};function i(e,t,o,i,r,u){const d=(0,n.up)("q-spinner");return o.count?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",a,[o.loading?((0,n.wg)(),(0,n.j4)(d,{key:0,size:"sm"})):((0,n.wg)(),(0,n.iD)("p",l,(0,s.zw)(e.$t(o.label)),1))]))}const r={name:"ListPlaceholder",props:{count:{type:Number,default:0},loading:{type:Boolean,default:!1},label:{type:String,default:"Nothing here."}}};var u=o(1639),d=o(3940),c=o(9984),p=o.n(c);const h=(0,u.Z)(r,[["render",i],["__scopeId","data-v-fdc49960"]]),m=h;p()(r,"components",{QSpinner:d.Z})},9010:(e,t,o)=>{o.d(t,{Z:()=>p});var n=o(9835),s=o(6970);const a={key:0},l={class:"addon"};function i(e,t,o,i,r,u){const d=(0,n.up)("base-icon");return(0,n.wg)(),(0,n.iD)("div",{class:(0,s.C_)(["page-header",{dense:e.dense}])},[e.backButton?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"back-button",onClick:t[0]||(t[0]=t=>e.$router.go(-1))},[(0,n.Wm)(d,{icon:"back"})])):(0,n.kq)("",!0),(0,n._)("div",{class:(0,s.C_)({"profile-info":!!e.subline})},[(0,n.WI)(e.$slots,"default",{},(()=>[(0,n._)("h2",null,(0,s.zw)(e.$t(e.title||e.titleFromRoute()||"Home")),1),e.subline?((0,n.wg)(),(0,n.iD)("span",a,(0,s.zw)(e.subline),1)):(0,n.kq)("",!0)]))],2),(0,n._)("div",l,[(0,n.WI)(e.$slots,"addon")])],2)}var r=o(7664);const u=(0,n.aZ)({name:"PageHeader",components:{BaseIcon:r.Z},props:{title:{type:String,default:void 0},subline:{type:String,default:void 0},backButton:{type:Boolean,default:!1},logo:{type:Boolean,default:!1},dense:{type:Boolean,default:!1}},methods:{titleFromRoute(){const e=this.$route.name?.toLowerCase();return e?.charAt(0).toUpperCase()+e?.substring(1)}}});var d=o(1639);const c=(0,d.Z)(u,[["render",i]]),p=c},2051:(e,t,o)=>{o.d(t,{Z:()=>d});var n=o(9835);const s={class:"thread"};function a(e,t,o,a,l,i){const r=(0,n.up)("ListPost");return(0,n.wg)(),(0,n.iD)("div",s,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredThread,((e,t)=>((0,n.wg)(),(0,n.j4)(r,{key:e.id,note:e,"connector-top":i.filteredThread.length>1&&t>0,"connector-bottom":i.filteredThread.length>1&&t<i.filteredThread.length-1||o.forceBottomConnector,actions:"",clickable:""},null,8,["note","connector-top","connector-bottom"])))),128))])}var l=o(2017);const i={name:"Thread",components:{ListPost:l.Z},props:{thread:{type:Array,required:!0},forceBottomConnector:{type:Boolean,default:!1}},computed:{filteredThread(){return this.thread.filter((e=>!!e))}}};var r=o(1639);const u=(0,r.Z)(i,[["render",a],["__scopeId","data-v-70ea85be"]]),d=u},6645:(e,t,o)=>{o.r(t),o.d(t,{default:()=>x});var n=o(9835),s=o(6970);const a={class:"profile-header"},l={class:"profile-header-content"},i={class:"username"},r={class:"about"},u={class:"followers"},d={class:"actions"},c=["href"],p={class:"profile-tabs"};function h(e,t,o,h,m,g){const b=(0,n.up)("PageHeader"),f=(0,n.up)("UserAvatar"),y=(0,n.up)("UserName"),k=(0,n.up)("FollowButton"),w=(0,n.up)("BaseIcon"),v=(0,n.up)("q-tooltip"),_=(0,n.up)("q-icon"),Z=(0,n.up)("q-tab"),T=(0,n.up)("q-tabs"),W=(0,n.up)("ListPost"),P=(0,n.up)("AsyncLoadLink"),$=(0,n.up)("q-tab-panel"),B=(0,n.up)("Thread"),C=(0,n.up)("ListPlaceholder"),F=(0,n.up)("q-tab-panels"),q=(0,n.up)("q-page");return(0,n.wg)(),(0,n.j4)(q,{class:"profile"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{"back-button":""}),(0,n._)("div",a,[(0,n.Wm)(f,{pubkey:e.pubkey,class:"profile-header-avatar"},null,8,["pubkey"]),(0,n._)("div",l,[(0,n._)("p",i,[(0,n.Wm)(y,{pubkey:e.pubkey,"two-line":"",header:"","show-verified":""},null,8,["pubkey"]),(0,n.Wm)(k,{pubkey:e.pubkey},null,8,["pubkey"])]),(0,n._)("p",r,(0,s.zw)(e.profile?.about),1),(0,n._)("p",u,[(0,n._)("a",{onClick:t[0]||(t[0]=t=>e.goToFollowers("following"))},[(0,n._)("strong",null,(0,s.zw)(e.contacts?.length||0),1),(0,n.Uk)(" "+(0,s.zw)(e.$t("Following")),1)]),(0,n._)("a",{onClick:t[1]||(t[1]=t=>e.goToFollowers("followers"))},[(0,n._)("strong",null,(0,s.zw)(e.followers?.length?`${e.followers?.length}+`:0),1),(0,n.Uk)(" "+(0,s.zw)(e.$t("Followers")),1)])]),(0,n._)("p",d,[(0,n._)("a",{onClick:t[2]||(t[2]=(...t)=>e.goToConversation&&e.goToConversation(...t))},[(0,n.Wm)(w,{icon:"messages"}),(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.$t("Send private message")),1)])),_:1})]),(0,n._)("a",{href:e.lightningLink,class:(0,s.C_)({disabled:!e.lightningLink})},[(0,n.Wm)(_,{name:"bolt",size:"sm"}),(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.$t("Tip with Bitcoin Lightning")),1)])),_:1})],10,c),(0,n._)("a",{onClick:t[3]||(t[3]=t=>e.copyUserId(e.pubkey))},[(0,n.Wm)(_,{name:"content_copy",size:"sm"}),(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.$t("Copy UserID")),1)])),_:1})])])])]),(0,n._)("div",p,[(0,n.Wm)(T,{modelValue:e.activeTab,"onUpdate:modelValue":t[4]||(t[4]=t=>e.activeTab=t),outline:"",align:"justify","indicator-color":"primary",breakpoint:0},{default:(0,n.w5)((()=>[(0,n.Wm)(Z,{name:"posts",label:e.$t("Posts")},null,8,["label"]),(0,n.Wm)(Z,{name:"replies",label:e.$t("Replies")},null,8,["label"]),(0,n.Wm)(Z,{name:"reactions",label:e.$t("Reactions")},null,8,["label"]),(0,n.Wm)(Z,{name:"relays",label:e.$t("Relays")},null,8,["label"])])),_:1},8,["modelValue"])]),(0,n.Wm)(F,{modelValue:e.activeTab,"onUpdate:modelValue":t[5]||(t[5]=t=>e.activeTab=t),class:"profile-tab-panels",animated:""},{default:(0,n.w5)((()=>[(0,n.Wm)($,{name:"posts",class:"no-padding"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.posts,((t,o)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[e.defer(o)?((0,n.wg)(),(0,n.j4)(W,{key:t.id,note:t,clickable:"",actions:""},null,8,["note"])):(0,n.kq)("",!0)],64)))),256)),(0,n.Wm)(P,{"load-fn":e.loadMorePosts,"has-items":!!e.posts?.length},null,8,["load-fn","has-items"])])),_:1}),(0,n.Wm)($,{name:"replies",class:"no-padding"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.replies,((t,o)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[e.defer(o)?((0,n.wg)(),(0,n.j4)(B,{key:t[1].id,thread:t},null,8,["thread"])):(0,n.kq)("",!0)],64)))),256)),(0,n.Wm)(P,{"load-fn":e.loadMorePosts,"has-items":!!e.replies?.length},null,8,["load-fn","has-items"])])),_:1}),(0,n.Wm)($,{name:"reactions",class:"no-padding"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.reactions,((t,o)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[e.defer(o)?((0,n.wg)(),(0,n.j4)(B,{key:t[1].id,thread:t},null,8,["thread"])):(0,n.kq)("",!0)],64)))),256)),(0,n.Wm)(P,{"load-fn":e.loadMoreReactions,"has-items":!!e.reactions?.length},null,8,["load-fn","has-items"])])),_:1}),(0,n.Wm)($,{name:"relays",class:"no-padding"},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{count:0})])),_:1})])),_:1},8,["modelValue"])])),_:1})}o(9665);var m=o(9010),g=o(5501),b=o(9715),f=o(2017),y=o(2051),k=o(6401),w=o(7328),v=o(7664);const _={key:1};function Z(e,t,o,a,l,i){const r=(0,n.up)("q-spinner");return(0,n.wg)(),(0,n.iD)("div",{ref:"link",class:"async-load-link",onClick:t[0]||(t[0]=(...t)=>e.load&&e.load(...t))},[e.loading?((0,n.wg)(),(0,n.j4)(r,{key:0,size:"sm"})):((0,n.wg)(),(0,n.iD)("span",_,[(0,n.Uk)((0,s.zw)(e.$t(e.noMore?e.prefixNoMore:e.hasItems?"":e.prefix))+" ",1),(0,n._)("a",null,(0,s.zw)(e.$t(e.noMore?e.labelNoMore:e.label)),1)]))],512)}const T=(0,n.aZ)({name:"AsyncLoadLink",emits:["loading","loaded"],props:{loadFn:{type:Function,required:!0},label:{type:String,default:"Load more"},labelNoMore:{type:String,default:"Try again?"},prefix:{type:String,default:"Nothing here."},prefixNoMore:{type:String,default:"Nothing found."},hasItems:{type:Boolean,default:!1},autoload:{type:Boolean,default:!1}},data(){return{loading:!1,noMore:!1,observer:null}},methods:{async load(){if(this.loading)return;this.loading=!0,this.$emit("loading");const e=await this.loadFn();this.noMore=!e||!e.length,this.loading=!1,this.$emit("loaded",e)}},mounted(){this.autoload&&(this.observer=new IntersectionObserver(this.load.bind(this),{root:null,threshold:.5}),this.observer.observe(this.$refs.button))},unmounted(){this.observer&&this.observer.disconnect()}});var W=o(1639),P=o(3940),$=o(9984),B=o.n($);const C=(0,W.Z)(T,[["render",Z],["__scopeId","data-v-92dd1492"]]),F=C;B()(T,"components",{QSpinner:P.Z});var q=o(3099),D=o(6166),L=o(4520),z=o(9944),A=o(7498),I=o(2296);const N=(0,n.aZ)({name:"Profile",components:{PageHeader:m.Z,UserAvatar:g.Z,UserName:b.Z,BaseIcon:v.Z,FollowButton:w.Z,Thread:y.Z,ListPlaceholder:k.Z,ListPost:f.Z,AsyncLoadLink:F},mixins:[(0,z.Z)()],setup(){return{app:(0,q.q)(),nostr:(0,D.D)()}},data(){return{activeScreen:"posts",activeTab:this.$route.params.tab||"posts",loadingNotes:!0,loadingReactions:!0}},computed:{pubkey(){return(0,L.FX)(this.$route.params.pubkey)},profile(){return this.nostr.getProfile(this.pubkey)},notes(){return this.nostr.getPostsByAuthor(this.pubkey)},posts(){return console.log("this.notes---------------",this.notes),this.notes?.filter((e=>!e.hasAncestor()))},replies(){return this.notes?.filter((e=>e.hasAncestor())).map((e=>[this.nostr.getNote(e.ancestor()),e])).slice(0,50)},reactions(){return this.nostr.getReactionsByAuthor(this.pubkey).map((e=>[this.nostr.getNote(e.ancestor()),e])).slice(0,50)},relays(){return[]},contacts(){return this.nostr.getContacts(this.pubkey)},followers(){return this.nostr.getFollowers(this.pubkey)},lightningLink(){const e=this.profile?.lud06||this.profile?.lud16;return e?`lightning:${e}`:null}},methods:{loadMorePosts(){const e=this.notes?.[this.notes.length-1]?.createdAt||I.Z.now();return this.nostr.fetch({kinds:[A.nS.NOTE],authors:[this.pubkey],until:e,limit:100})},loadMoreReactions(){const e=this.reactions?.[this.reactions.length-1]?.createdAt||I.Z.now();return this.nostr.fetch({kinds:[A.nS.REACTION],authors:[this.pubkey],until:e,limit:100})},goToFollowers(e="following"){this.$router.push({name:"followers",params:{pubkey:(0,L.jm)(this.pubkey,"npub"),tab:e}})},goToConversation(){this.$router.push({name:"conversation",params:{pubkey:(0,L.jm)(this.pubkey,"npub")}})},async copyUserId(e){const t=(0,L.jm)(this.pubkey,"npub");await navigator.clipboard.writeText(t).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})}))}},watch:{activeTab(){this.$router.replace({params:{tab:this.activeTab}})}},mounted(){this.nostr.fetchPostsByAuthor(this.pubkey,50).then((()=>this.loadingNotes=!1)),this.nostr.fetchReactionsByAuthor(this.pubkey,50).then((()=>this.loadingReactions=!1)),this.nostr.fetchFollowers(this.pubkey,1e3),this.stream=this.nostr.streamFullProfile(this.pubkey)},unmounted(){this.stream&&this.nostr.cancelStream(this.stream)}});var U=o(9885),S=o(6858),M=o(2857),R=o(2230),j=o(900),H=o(4016),Q=o(4106);const Y=(0,W.Z)(N,[["render",h],["__scopeId","data-v-83f1154c"]]),x=Y;B()(N,"components",{QPage:U.Z,QTooltip:S.Z,QIcon:M.Z,QTabs:R.Z,QTab:j.Z,QTabPanels:H.Z,QTabPanel:Q.Z})}}]);