(globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[]).push([[9764],{3003:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>ut});var o=s(9835),n=s(6970),i=s(4954),r=s.n(i);const a={key:0,class:"downloadtips"},A=(0,o._)("span",{class:"downloadtips_span"},"FreeFrom",-1),l={ref:"ancestors"},c={key:1,style:{"padding-left":"1.5rem"}},h={key:1,class:"openapp"},g={key:2,class:"qcode"},d=(0,o._)("img",{src:r()},null,-1),I=(0,o._)("br",null,null,-1),C=(0,o._)("span",null,"Download for a better experience",-1),p=[d,I,C];function u(t,e,s,i,r,d){const I=(0,o.up)("q-btn"),C=(0,o.up)("sharePost"),u=(0,o.up)("q-spinner"),m=(0,o.up)("q-item"),B=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(B,{ref:"page"},{default:(0,o.w5)((()=>[t.mobiletips?((0,o.wg)(),(0,o.iD)("div",a,[A,(0,o.Wm)(I,{unelevated:"",rounded:"",color:"primary",size:"md",label:"Download",class:"qbtn-style","icon-right":"get_app"})])):(0,o.kq)("",!0),(0,o._)("div",l,null,512),(0,o.Wm)(m,{ref:"main",class:"no-padding column"},{default:(0,o.w5)((()=>[t.note?.id?((0,o.wg)(),(0,o.j4)(C,{key:0,note:t.note,connector:t.ancestors?.length>0,raw:t.raw},null,8,["note","connector","raw"])):((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(u,{size:"sm",style:{"margin-right":"0.5rem"}}),(0,o.Uk)(" "+(0,n.zw)(t.$t("Loading...")),1)]))])),_:1},512),t.mobiletips?((0,o.wg)(),(0,o.iD)("div",h,[(0,o.Wm)(I,{unelevated:"",rounded:"",style:{background:"rgba(108, 108, 108, 1)",color:"white"},size:"md",label:"Open In FreeFrom App"})])):(0,o.kq)("",!0),t.pcqcode?((0,o.wg)(),(0,o.iD)("div",g,p)):(0,o.kq)("",!0)])),_:1},512)}s(9665);var m=s(4586),B=s(2141);const E=t=>((0,o.dD)("data-v-3bd9003e"),t=t(),(0,o.Cn)(),t),Q={class:"post"},w={class:"post-author"},v={class:"post-author-avatar"},y=E((()=>(0,o._)("div",{class:"connector-top"},null,-1))),D={class:"post-author-name"},M={class:"post-content"},f={class:"post-content-header"},k={key:0,class:"in-reply-to"},b={class:"post-content-body"},Z={class:"post-content-footer"},L={class:"created-at"},W=E((()=>(0,o._)("span",null,"Â·",-1)));function F(t,e,s,i,r,a){const A=(0,o.up)("UserAvatar"),l=(0,o.up)("UserName"),c=(0,o.up)("PostRenderer");return(0,o.wg)(),(0,o.iD)("div",Q,[(0,o._)("div",w,[(0,o._)("div",v,[y,(0,o.Wm)(A,{pubkey:s.note.author},null,8,["pubkey"])]),(0,o._)("div",D,[(0,o.Wm)(l,{pubkey:s.note.author,"two-line":"","show-verified":""},null,8,["pubkey"])])]),(0,o._)("div",M,[(0,o._)("div",f,[s.note.hasAncestor()?((0,o.wg)(),(0,o.iD)("p",k,[(0,o.Uk)((0,n.zw)(t.$t("Replying to"))+" ",1),(0,o._)("a",null,[a.ancestor?.author?((0,o.wg)(),(0,o.j4)(l,{key:0,pubkey:a.ancestor?.author},null,8,["pubkey"])):(0,o.kq)("",!0)])])):(0,o.kq)("",!0)]),(0,o._)("div",b,[(0,o._)("p",null,[(0,o.Wm)(c,{note:s.note},null,8,["note"])])]),(0,o._)("div",Z,[(0,o._)("p",L,[(0,o._)("span",null,(0,n.zw)(a.formatTime(s.note.createdAt)),1),W,(0,o._)("span",null,(0,n.zw)(a.formatDate(s.note.createdAt)),1)])])])])}var z=s(499),Y=s(8803),O=s.n(Y),j=s(9715),_=s(5501),T=s(1925),R=s(4175),G=s(8039),N=s(3099),S=s(2929),P=s(2296);const V={class:"action-item comment"},q={class:"action-item repost"};function x(t,e,s,i,r,a){const A=(0,o.up)("BaseIcon");return(0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(["post-actions",s.flavor])},[(0,o._)("div",V,[(0,o.Wm)(A,{icon:"comment"}),(0,o._)("span",null,(0,n.zw)(a.stats.comments||""),1)]),(0,o._)("div",q,[(0,o.Wm)(A,{icon:"repost"}),(0,o._)("span",null,(0,n.zw)(a.stats.shares||""),1)]),(0,o._)("div",{class:(0,n.C_)(["action-item like",{active:a.liked}])},[(0,o.Wm)(A,{icon:a.liked?"like_filled":"like"},null,8,["icon"]),(0,o._)("span",null,(0,n.zw)(a.stats.reactions||""),1)],2)],2)}var $=s(7664),J=s(734),U=s(1153),H=s(5155),X=s(4520);const K={name:"PostActions",components:{BaseIcon:$.Z},emits:["comment","repost"],data(){return{metadataDialog:!1,noteStr:"",CopyStr:""}},props:{note:{type:Object,required:!0},flavor:{type:String,default:"list"}},setup(){return{app:(0,N.q)(),stat:(0,J.a)(),nostr:(0,G.D)()}},computed:{stats(){return this.stat.get(this.note.id)},ourReactions(){return this.nostr.getOurReactionsTo(this.note.id)},liked(){return this.ourReactions.length>0}},methods:{info(){this.metadataDialog=!0;let t=(0,X.Sk)(this.nostr.getNote(this.note.id)),e=JSON.stringify(this.nostr.getNote(this.note.id));this.noteStr=t,this.CopyStr=e},comment(){"list"===this.flavor?this.app.createPost({ancestor:this.note.id}):this.$emit("comment")},async repost(){if("list"===this.flavor){const t=U.Z.share(this.note,this.app.myPubkey).build();if(!await this.app.signEvent(t))return;await this.nostr.publish(t)||this.$q.notify({message:(0,H.$t)("Failed to publish reaction"),color:"negative"})}else this.$emit("repost")},like(){return this.liked?this.deleteLike():this.publishLike()},async copystr(t){t&&await navigator.clipboard.writeText(t).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})}))},async publishLike(){const t=U.Z.reaction(this.note,this.app.myPubkey).build();await this.app.signEvent(t)&&(await this.nostr.publish(t)||this.$q.notify({message:(0,H.$t)("Failed to publish reaction"),color:"negative"}))},async deleteLike(){const t=this.ourReactions.map((t=>t.id)),e=U.Z.delete(this.app.myPubkey,t).build();await this.app.signEvent(e)&&(await this.nostr.publish(e)||this.$q.notify({message:(0,H.$t)("Failed to delete reaction"),color:"negative"}))}}};var tt=s(1639),et=s(7743),st=s(8879),ot=s(2146),nt=s(9984),it=s.n(nt);const rt=(0,tt.Z)(K,[["render",x],["__scopeId","data-v-65edef91"]]),at=rt;it()(K,"components",{QDialog:et.Z,QBtn:st.Z}),it()(K,"directives",{ClosePopup:ot.Z});const At={name:"HeroPost",mixins:[S.Z],components:{PostActions:at,UserName:j.Z,UserAvatar:_.Z,PostEditor:R.Z,PostRenderer:T.Z,JsonViewer:O()},props:{note:{type:Object,required:!0},connector:{type:Boolean,default:!1},raw:Boolean},setup(t){const e=(0,z.qj)({opendata:!1});return(0,o.YP)((()=>t.raw),(t=>{e.opendata=t})),{app:(0,N.q)(),nostr:(0,G.D)(),formState:e}},computed:{ancestor(){return this.note.hasAncestor()?this.nostr.getNote(this.note.ancestor()):null}},data(){return{}},methods:{formatDate:P.Z.formatDate,formatTime:P.Z.formatTime,openToggle(){this.formState.opendata=!this.formState.opendata}}},lt=(0,tt.Z)(At,[["render",F],["__scopeId","data-v-3bd9003e"]]),ct=lt;it()(At,"components",{QBtn:st.Z});var ht=s(5547);const gt=(0,o.aZ)({name:"sharePage",components:{sharePost:ct,Thread:B.Z,PageHeader:m.Z},setup(){return{nostr:(0,G.D)()}},data(){return{subId:null,resizeObserver:null,raw:!1,pcqcode:!1,mobiletips:!1}},computed:{noteId(){const t=this.$route.params.id;return t&&t.startsWith("note")?(0,X.FX)(t):t},note(){if(this.noteId)return this.nostr.getNote(this.noteId)},noteLoaded(){return this.noteId&&this.note?.id===this.noteId},rootId(){if(this.noteLoaded)return this.note.hasAncestor()?this.note.root():this.note.id},root(){if(this.rootId)return this.nostr.getNote(this.rootId)},rootLoaded(){if(this.noteLoaded)return this.root?.id===this.rootId},ancestors(){if(!this.noteLoaded)return;const t=this.allAncestors(this.note);return t.length>0&&t[0].id!==this.rootId&&console.error(`Invalid thread structure: expected root ${this.rootId} but found ${t[0].id}`),this.collectPredecessors(t,this.note)},children(){if(!this.noteLoaded)return;const t=this.note.hasAncestor()?this.nostr.getNote(this.note.ancestor()):null;return this.collectChildren(this.note,t)}},watch:{root(){this.rootLoaded&&this.startStream()}},mounted(){this.startStream(),this.resizeObserver=new ResizeObserver(this.scrollToMain.bind(this)),this.resizeObserver.observe(this.$refs.ancestors),setTimeout((()=>this.resizeObserver.disconnect()),2e3),this.isMobile()?(this.pcqcode=!1,this.mobiletips=!0):(this.pcqcode=!0,this.mobiletips=!1)},unmounted(){this.closeStream(),this.resizeObserver.disconnect()},methods:{isMobile(){let t=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);return t},startStream(){this.rootId&&(this.stream=this.nostr.streamThread(this.rootId))},closeStream(){this.stream&&(this.stream.close(),this.stream=null)},scrollToMain(){const t=this.$refs.main?.$el;if(!t)return;const e=this.$q.screen.xs?61:78,s=Math.max(t.offsetTop-e,0);window.scrollTo(0,s)},collectPredecessors(t,e){if(!t||!t.length)return[];const s=t.pop(),o=this.nostr.getRepliesTo(s.id,ht.i.CREATION_DATE_ASC),n=o.findIndex((t=>t.id===e.id)),i=[s].concat(o.slice(0,n));return this.collectPredecessors(t,s).concat(i)},collectChildren(t,e){const s=[];if(e){const o=this.nostr.getRepliesTo(e.id,ht.i.CREATION_DATE_ASC),n=o.findIndex((e=>e.id===t.id)),i=o.slice(n+1);i.length&&s.push(i)}const o=this.nostr.getRepliesTo(t.id,ht.i.CREATION_DATE_DESC);for(const n of o)s.push(this.unrollLongest(n));return s},unrollLinear(t){const e=[t];let s=this.nostr.getRepliesTo(t.id,ht.i.CREATION_DATE_ASC);while(1===s.length)e.push(s[0]),t=s[0],s=this.nostr.getRepliesTo(t.id,ht.i.CREATION_DATE_ASC);return e},unrollLongest(t){let e=[],s=this.nostr.getRepliesTo(t.id,ht.i.CREATION_DATE_ASC);for(const n of s)e.push(this.unrollLongest(n));let o=[];for(const n of e)n.length>=o.length&&(o=n);return[t].concat(o)},allAncestors(t){if(!t.hasAncestor())return[];const e=this.nostr.getNote(t.ancestor());return e?this.allAncestors(e).concat([e]):(console.error(`Couldn't fetch ancestor ${t.ancestor()}`),[])}}});var dt=s(9885),It=s(490),Ct=s(3940);const pt=(0,tt.Z)(gt,[["render",u]]),ut=pt;it()(gt,"components",{QPage:dt.Z,QBtn:st.Z,QItem:It.Z,QSpinner:Ct.Z})},4954:t=>{t.exports="data:image/png;base64,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"}}]);