(()=>{var e={2019:(e,t,s)=>{"use strict";var n=s(1957),u=s(1947),o=s(499),i=s(9835);function r(e,t,s,n,u,o){const r=(0,i.up)("MainLayout");return(0,i.wg)(),(0,i.j4)(r)}var a=s(6166),c=s(6840),l=s(6970);const D={class:"layout-menu"},d={class:"layout-flow"},p={key:0,class:"mobile-menu-backdrop fixed-full"};function h(e,t,s,u,o,r){const a=(0,i.up)("MainMenu"),c=(0,i.up)("router-view"),h=(0,i.up)("q-page-container"),m=(0,i.up)("BaseIcon"),g=(0,i.up)("SignInDialog"),F=(0,i.up)("CreatePostDialog"),f=(0,i.up)("q-layout"),b=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(f,null,{default:(0,i.w5)((()=>[(0,i._)("div",{class:"layout",onClick:t[3]||(t[3]=t=>e.mobileMenuOpen=!1)},[(0,i._)("div",D,[(0,i._)("div",{class:(0,l.C_)(["layout-menu-fixed",{active:e.mobileMenuOpen}])},[(0,i.Wm)(a,{onClick:t[0]||(t[0]=(0,n.iM)((()=>{}),["stop"])),onMobileMenuClose:t[1]||(t[1]=t=>e.mobileMenuOpen=!1),"hide-items-requiring-sign-in":""})],2)]),(0,i._)("div",d,[(0,i.Wm)(h,{ref:"pageContainer"},{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((({Component:t})=>[((0,i.wg)(),(0,i.j4)(i.Ob,{include:e.cachedPages},[((0,i.wg)(),(0,i.j4)((0,i.LL)(t),{key:e.$route.path}))],1032,["include"]))])),_:1})])),_:1},512)]),(0,i._)("div",{class:"mobile-menu-toggler",onClick:t[2]||(t[2]=(0,n.iM)((t=>e.mobileMenuOpen=!e.mobileMenuOpen),["stop"]))},[(0,i.Wm)(m,{icon:"hamburger"})]),e.mobileMenuOpen?(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",p,null,512)),[[b]]):(0,i.kq)("",!0)]),(0,i.Wm)(g),(0,i.Wm)(F)])),_:1})}var m=s(9302);const g={class:"menu-nav"},F={class:"label"},f={style:{position:"sticky",bottom:"0"}},b={class:"label"},y={class:"icon"};function C(e,t,s,n,u,o){const r=(0,i.up)("MenuItem"),a=(0,i.up)("BaseIcon"),c=(0,i.up)("ProfilePopup"),D=(0,i.up)("q-icon");return(0,i.wg)(),(0,i.iD)("menu",null,[(0,i._)("div",g,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(u.items,((u,o)=>((0,i.wg)(),(0,i.iD)("div",{key:o},[s.hideItemsRequiringSignIn&&u.signInRequired&&!n.app.isSignedIn?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(r,{key:0,icon:u.name.toLowerCase(),to:u.path,enabled:!1!==u.enabled,indicator:u.indicator&&u.indicator(),onClick:t[0]||(t[0]=t=>e.$emit("mobile-menu-close"))},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t(u.name)),1)])),_:2},1032,["icon","to","enabled","indicator"]))])))),128)),!s.hideItemsRequiringSignIn||n.app.isSignedIn?((0,i.wg)(),(0,i.j4)(r,{key:0,icon:"profile",to:`/profile/${o.hexToBech32(n.app.myPubkey,"npub")}`,enabled:n.app.isSignedIn,onClick:t[1]||(t[1]=t=>e.$emit("mobile-menu-close"))},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t("Profile")),1)])),_:1},8,["to","enabled"])):(0,i.kq)("",!0),!s.hideItemsRequiringSignIn||n.app.isSignedIn?((0,i.wg)(),(0,i.j4)(r,{key:1,icon:"key",to:"/key",onClick:t[2]||(t[2]=t=>e.$emit("mobile-menu-close"))},{default:(0,i.w5)((()=>[(0,i.Uk)(" KEY ")])),_:1})):(0,i.kq)("",!0),!s.hideItemsRequiringSignIn||n.app.isSignedIn?((0,i.wg)(),(0,i.j4)(r,{key:2,icon:"like",to:"/Following",onClick:t[3]||(t[3]=t=>e.$emit("mobile-menu-close"))},{default:(0,i.w5)((()=>[(0,i.Uk)(" Following ")])),_:1})):(0,i.kq)("",!0),!s.hideItemsRequiringSignIn||n.app.isSignedIn?((0,i.wg)(),(0,i.j4)(r,{key:3,icon:"comment",to:"/Traffic",onClick:t[4]||(t[4]=t=>e.$emit("mobile-menu-close"))},{default:(0,i.w5)((()=>[(0,i.Uk)(" Traffic ")])),_:1})):(0,i.kq)("",!0),!s.hideItemsRequiringSignIn||n.app.isSignedIn?((0,i.wg)(),(0,i.j4)(r,{key:4,icon:"search",to:"/SearchTag",onClick:t[5]||(t[5]=t=>e.$emit("mobile-menu-close"))},{default:(0,i.w5)((()=>[(0,i.Uk)(" SearchTag ")])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(r,{icon:"settings",to:"/settings",onClick:t[6]||(t[6]=t=>e.$emit("mobile-menu-close"))},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.$t("Settings")),1)])),_:1}),!s.hideItemsRequiringSignIn||n.app.isSignedIn?((0,i.wg)(),(0,i.iD)("div",{key:5,class:"menu-post-button",onClick:t[7]||(t[7]=(...e)=>o.createPost&&o.createPost(...e))},[(0,i._)("span",F,(0,l.zw)(e.$t("Post")),1),(0,i.Wm)(a,{class:"icon",icon:"pen"})])):(0,i.kq)("",!0)]),(0,i._)("div",f,[n.app.isSignedIn?((0,i.wg)(),(0,i.j4)(c,{key:0})):((0,i.wg)(),(0,i.iD)("div",{key:1,class:"sign-in",onClick:t[8]||(t[8]=(...e)=>o.signIn&&o.signIn(...e))},[(0,i.Wm)(D,{class:"icon",name:"login",size:"sm"}),(0,i._)("div",b,(0,l.zw)(e.$t("Log in")),1)]))]),(0,i._)("div",{class:"mobile-close-menu-button",onClick:t[9]||(t[9]=t=>e.$emit("mobile-menu-close"))},[(0,i._)("div",y,[(0,i.Wm)(a,{icon:"left"})]),(0,i._)("span",null,(0,l.zw)(e.$t("Close")),1)])])}const E={class:"menu-item"},v={class:"menu-item-logo"},k={class:"menu-item-content"};function w(e,t,s,n,u,o){const r=(0,i.up)("base-icon"),a=(0,i.up)("q-badge");return(0,i.wg)(),(0,i.j4)((0,i.LL)(s.enabled?"router-link":"div"),{to:s.enabled?s.to:"",onClick:t[0]||(t[0]=t=>s.enabled&&e.$emit("click"))},{default:(0,i.w5)((()=>[(0,i._)("div",E,[(0,i._)("div",v,[(0,i.Wm)(r,{icon:s.icon,"icon-color":s.iconColor},null,8,["icon","icon-color"]),s.indicator?((0,i.wg)(),(0,i.j4)(a,{key:0,floating:"",rounded:"",color:"primary",class:"indicator"})):(0,i.kq)("",!0)]),(0,i._)("div",k,[(0,i.WI)(e.$slots,"default",{},void 0,!0)])])])),_:3},8,["to"])}var A=s(7664);const B={name:"MenuItem",components:{BaseIcon:A.Z},props:{icon:{type:String,default:"more"},iconColor:{type:String,default:"#fff"},to:{type:String,default:""},enabled:{type:Boolean,default:!0},indicator:{type:Boolean,default:!1}},emits:["click"]};var _=s(1639),T=s(990),I=s(9984),S=s.n(I);const x=(0,_.Z)(B,[["render",w],["__scopeId","data-v-3f8d3fba"]]),R=x;S()(B,"components",{QBadge:T.Z});const $={class:"menu-profile-wrapper"},P={class:"menu-profile"},O={class:"menu-profile-pic"},N={class:"menu-profile-items"},q={class:"profile-info"},Z={class:"more"},j=["onClick"],M={class:"sidebar-profile-pic"},z={class:"menu-profile-items"},U={class:"profile-info"},L={key:0,class:"more"},W=(0,i._)("hr",{class:"popup-spacing"},null,-1),Q={class:"popup-body"},V=(0,i._)("hr",{class:"popup-spacing"},null,-1);function K(e,t,s,n,u,o){const r=(0,i.up)("UserAvatar"),a=(0,i.up)("UserName"),c=(0,i.up)("BaseIcon"),D=(0,i.up)("q-menu"),d=(0,i.up)("LogoutDialog"),p=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",$,[(0,i._)("div",P,[(0,i._)("div",O,[(0,i.Wm)(r,{pubkey:o.pubkey,clickable:!1},null,8,["pubkey"])]),(0,i._)("div",N,[(0,i._)("div",q,[(0,i._)("p",null,[(0,i.Wm)(a,{pubkey:o.pubkey,"two-line":"",wrap:"","show-verified":""},null,8,["pubkey"])])]),(0,i._)("div",Z,[(0,i.Wm)(c,{icon:"more"})])])]),(0,i.Wm)(D,{offset:[0,20],target:".menu-profile",class:"menu-profile-popup"},{default:(0,i.w5)((()=>[(0,i._)("div",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.settings.accounts,((e,t)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{key:t,class:"popup-header",onClick:e=>n.app.switchAccount(t)},[(0,i._)("div",M,[(0,i.Wm)(r,{pubkey:t,clickable:!1},null,8,["pubkey"])]),(0,i._)("div",z,[(0,i._)("div",U,[(0,i._)("p",null,[(0,i.Wm)(a,{pubkey:t,clickable:!1,"two-line":""},null,8,["pubkey"])])]),t===o.pubkey?((0,i.wg)(),(0,i.iD)("div",L,[(0,i.Wm)(c,{icon:"tick"})])):(0,i.kq)("",!0)])],8,j)),[[p]]))),128)),W,(0,i._)("div",Q,[(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"popup-body-item",onClick:t[0]||(t[0]=e=>n.app.signIn())},[(0,i._)("p",null,(0,l.zw)(e.$t("Add an account")),1)])),[[p]]),V,(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"popup-body-item",onClick:t[1]||(t[1]=t=>e.$refs.logout.show())},[(0,i._)("p",null,[(0,i.Uk)((0,l.zw)(e.$t("Logout from"))+" ",1),(0,i._)("span",null,[(0,i.Wm)(a,{pubkey:o.pubkey},null,8,["pubkey"])])])])),[[p]])])])])),_:1})]),(0,i.Wm)(d,{pubkey:o.pubkey,ref:"logout"},null,8,["pubkey"])],64)}var H=s(5501),Y=s(9715);const J={class:"logout-dialog"},G={key:0,class:"warning"},X={class:"warning-icon"},ee={class:"warning-content"},te=["value"],se={class:"buttons"},ne={class:"btn btn-sm"};function ue(e,t,s,n,u,o){const r=(0,i.up)("q-btn"),a=(0,i.up)("UserName"),c=(0,i.up)("q-icon"),D=(0,i.up)("q-dialog"),d=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(D,{modelValue:u.dialogOpen,"onUpdate:modelValue":t[1]||(t[1]=e=>u.dialogOpen=e)},{default:(0,i.w5)((()=>[(0,i._)("div",J,[(0,i.wy)((0,i.Wm)(r,{icon:"close",size:"md",class:"icon",flat:"",round:""},null,512),[[d]]),(0,i._)("h3",null,[(0,i.Uk)((0,l.zw)(e.$t("Do you really want to log out from"))+" ",1),(0,i.Wm)(a,{pubkey:s.pubkey},null,8,["pubkey"]),(0,i.Uk)("? ")]),o.privateKey?((0,i.wg)(),(0,i.iD)("p",G,[(0,i._)("span",X,[(0,i.Wm)(c,{name:"warning",size:"lg"})]),(0,i._)("span",ee,(0,l.zw)(e.$t("Make sure you have a backup of your private key! Otherwise it is impossible to log back in to your account.")),1)])):(0,i.kq)("",!0),o.privateKey?((0,i.wg)(),(0,i.iD)("input",{key:1,value:o.hexToBech32(o.privateKey,"nsec"),readonly:""},null,8,te)):(0,i.kq)("",!0),(0,i._)("div",se,[(0,i.wy)(((0,i.wg)(),(0,i.iD)("button",{class:"btn btn-sm btn-primary",onClick:t[0]||(t[0]=(...e)=>o.logout&&o.logout(...e))},[(0,i.Uk)((0,l.zw)(e.$t("Log out")),1)])),[[d]]),(0,i.wy)(((0,i.wg)(),(0,i.iD)("button",ne,[(0,i.Uk)((0,l.zw)(e.$t("Cancel")),1)])),[[d]])])])])),_:1},8,["modelValue"])}var oe=s(3099),ie=s(4520);const re={name:"LogoutDialog",components:{UserName:Y.Z},props:{pubkey:{type:String,required:!0},open:{type:Boolean,default:!1}},data(){return{dialogOpen:this.open}},computed:{privateKey(){return(0,oe.q)().activeAccount.privkey}},methods:{hexToBech32:ie.jm,logout(){(0,c.F)().removeAccount(this.pubkey)},show(){this.dialogOpen=!0},dismiss(){this.dialogOpen=!1}}};var ae=s(7743),ce=s(8879),le=s(2857),De=s(2146);const de=(0,_.Z)(re,[["render",ue],["__scopeId","data-v-6f9e2686"]]),pe=de;S()(re,"components",{QDialog:ae.Z,QBtn:ce.Z,QIcon:le.Z}),S()(re,"directives",{ClosePopup:De.Z});const he={name:"ProfilePopup",components:{LogoutDialog:pe,UserName:Y.Z,UserAvatar:H.Z,BaseIcon:A.Z},setup(){return{app:(0,oe.q)(),settings:(0,c.F)()}},computed:{pubkey(){return this.app.myPubkey},accounts(){return this.settings.accounts}}};var me=s(6362);const ge=(0,_.Z)(he,[["render",K]]),Fe=ge;S()(he,"components",{QMenu:me.Z}),S()(he,"directives",{ClosePopup:De.Z});var fe=s(3413);const be=[{name:"Home",path:"/"},{name:"Notifications",path:"/notifications",signInRequired:!0},{name:"Messages",path:"/messages",signInRequired:!0,indicator:()=>(0,fe.G)().getNumUnread((0,oe.q)().myPubkey)>0}],ye={name:"MainMenu",components:{MenuItem:R,BaseIcon:A.Z,ProfilePopup:Fe},props:{hideItemsRequiringSignIn:{type:Boolean,default:!1}},emits:["mobile-menu-close"],data(){return{items:be}},setup(){return{app:(0,oe.q)()}},methods:{createPost(){this.$emit("mobile-menu-close"),this.app.createPost()},signIn(){this.$emit("mobile-menu-close"),this.app.signIn()},hexToBech32:ie.jm}},Ce=(0,_.Z)(ye,[["render",C]]),Ee=Ce;S()(ye,"components",{QIcon:le.Z});var ve=s(7573);const ke={key:0,class:"welcome"},we={class:"welcome-header"},Ae={class:"welcome-content"};function Be(e,t,s,u,o,r){return u.app.isSignedIn?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",ke,[(0,i._)("div",we,[(0,i._)("h3",null,(0,l.zw)(e.$t("New to Nostr?")),1)]),(0,i._)("div",Ae,[o.nip07available?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"btn btn-primary",onClick:t[0]||(t[0]=(0,n.iM)((e=>r.signInNip07()),["stop"]))},(0,l.zw)(e.$t("Log in with Extension")),1)):(0,i.kq)("",!0),(0,i._)("button",{class:(0,l.C_)(["btn",{"btn-primary":!o.nip07available}]),onClick:t[1]||(t[1]=(0,n.iM)(((...e)=>r.signUp&&r.signUp(...e)),["stop"]))},(0,l.zw)(e.$t("Create Account")),3),o.nip07available?((0,i.wg)(),(0,i.iD)("a",{key:2,onClick:t[3]||(t[3]=(0,n.iM)(((...e)=>r.signIn&&r.signIn(...e)),["stop"]))},(0,l.zw)(e.$t("Log in with key")),1)):((0,i.wg)(),(0,i.iD)("button",{key:1,class:"btn",onClick:t[2]||(t[2]=(0,n.iM)(((...e)=>r.signIn&&r.signIn(...e)),["stop"]))},(0,l.zw)(e.$t("Log in")),1))])]))}var _e=s(4968);const Te={name:"WelcomeBox",setup(){return{app:(0,oe.q)(),nostr:(0,a.D)(),settings:(0,c.F)()}},data(){return{nip07available:!1}},methods:{signUp(){this.app.signIn("sign-up")},signIn(){this.app.signIn("sign-in")},async signInNip07(){const e=await _e.Z.getPublicKey(),t={pubkey:e,useExtension:!0};this.settings.addAccount(t),this.app.switchAccount(e),this.nostr.getProfile(e)}},mounted(){this.nip07available=_e.Z.isAvailable(),setTimeout((()=>this.nip07available=_e.Z.isAvailable()),300)}},Ie=(0,_.Z)(Te,[["render",Be],["__scopeId","data-v-5d183298"]]),Se=Ie,xe={class:"sign-in-dialog"},Re={class:"logo"},$e={key:1,style:{"font-size":"48px"}},Pe={key:2,class:"welcome"},Oe={class:"prompt"};function Ne(e,t,s,u,o,r){const a=(0,i.up)("q-btn"),c=(0,i.up)("UserAvatar"),D=(0,i.up)("SignUpForm"),d=(0,i.up)("SignInForm"),p=(0,i.up)("q-dialog"),h=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(p,{modelValue:u.app.signInDialog.open,"onUpdate:modelValue":t[5]||(t[5]=e=>u.app.signInDialog.open=e),onBeforeShow:r.updateFragment,onHide:r.onClose,ref:"signInDialog"},{default:(0,i.w5)((()=>[(0,i._)("div",xe,[r.showClose?(0,i.wy)(((0,i.wg)(),(0,i.j4)(a,{key:0,icon:"close",size:"md",class:"icon",flat:"",round:""},null,512)),[[h]]):(0,i.kq)("",!0),r.showBack?((0,i.wg)(),(0,i.j4)(a,{key:1,onClick:t[0]||(t[0]=e=>o.fragment="welcome"),icon:"arrow_back",size:"md",class:"icon",flat:"",round:""})):(0,i.kq)("",!0),(0,i._)("div",Re,[o.pubkey?((0,i.wg)(),(0,i.j4)(c,{key:0,pubkey:o.pubkey},null,8,["pubkey"])):((0,i.wg)(),(0,i.iD)("text",$e,"Logo"))]),"welcome"===o.fragment?((0,i.wg)(),(0,i.iD)("div",Pe,[(0,i._)("p",Oe,(0,l.zw)(s.prompt),1),r.nip07available?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"btn btn-primary",onClick:t[1]||(t[1]=(0,n.iM)((e=>r.signInNip07()),["stop"]))},(0,l.zw)(e.$t("Log in with Extension")),1)):(0,i.kq)("",!0),(0,i._)("button",{class:(0,l.C_)(["btn",{"btn-primary":!r.nip07available}]),onClick:t[2]||(t[2]=(0,n.iM)((e=>o.fragment="sign-up"),["stop"]))},(0,l.zw)(e.$t("Create Account")),3),r.nip07available?((0,i.wg)(),(0,i.iD)("a",{key:2,onClick:t[4]||(t[4]=(0,n.iM)((e=>o.fragment="sign-in"),["stop"]))},(0,l.zw)(e.$t("Log in with key")),1)):((0,i.wg)(),(0,i.iD)("button",{key:1,class:"btn",onClick:t[3]||(t[3]=(0,n.iM)((e=>o.fragment="sign-in"),["stop"]))},(0,l.zw)(e.$t("Log in")),1))])):(0,i.kq)("",!0),"sign-up"===o.fragment?((0,i.wg)(),(0,i.j4)(D,{key:3,onComplete:r.onComplete},null,8,["onComplete"])):(0,i.kq)("",!0),"sign-in"===o.fragment?((0,i.wg)(),(0,i.j4)(d,{key:4,onComplete:r.onComplete},null,8,["onComplete"])):(0,i.kq)("",!0),"private-key"===o.fragment?((0,i.wg)(),(0,i.j4)(d,{key:5,onComplete:r.onComplete,"private-key-only":""},null,8,["onComplete"])):(0,i.kq)("",!0)])])),_:1},8,["modelValue","onBeforeShow","onHide"])}const qe={class:"sign-up"},Ze={for:"username"},je=["disabled"];function Me(e,t,s,u,o,r){const a=(0,i.up)("q-form");return(0,i.wg)(),(0,i.iD)("div",qe,[(0,i._)("h3",null,(0,l.zw)(e.$t("Create Account")),1),(0,i.Wm)(a,{onSubmit:(0,n.iM)(r.signUp,["stop"])},{default:(0,i.w5)((()=>[(0,i._)("label",Ze,(0,l.zw)(e.$t("What's your name?")),1),(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.username=e),ref:"input",id:"username",autocomplete:"false"},null,512),[[n.nr,o.username]]),(0,i._)("button",{type:"submit",class:"btn btn-primary",disabled:!r.validUsername},(0,l.zw)(e.$t("Create")),9,je)])),_:1},8,["onSubmit"])])}var ze=s(7256),Ue=s(1153),Le=s(5155);const We={name:"SignUpForm",emits:["complete"],data(){return{username:null}},computed:{validUsername(){return this.username&&this.username.length>0}},methods:{async signUp(){if(!this.validUsername)return;const e=(0,ze.wQ)(),t=(0,c.F)(),s=t.addAccount({privkey:e}),n=(0,oe.q)();n.switchAccount(s.pubkey);const u=Ue.Z.metadata(s.pubkey,{name:this.username}).build();await n.signEvent(u),await(0,a.D)().publish(u)?this.$emit("complete",{pubkey:s.pubkey,name:this.username}):this.$q.notify({message:(0,Le.$t)("Failed to create profile"),color:"negative"})}},mounted(){this.$refs.input.focus()}};var Qe=s(8326);const Ve=(0,_.Z)(We,[["render",Me],["__scopeId","data-v-7a4eaac8"]]),Ke=Ve;S()(We,"components",{QForm:Qe.Z});const He={class:"sign-in"},Ye={for:"private-key"},Je=["placeholder"],Ge=["disabled"];function Xe(e,t,s,u,o,r){const a=(0,i.up)("q-form");return(0,i.wg)(),(0,i.iD)("div",He,[(0,i._)("h3",null,(0,l.zw)(e.$t(r.header)),1),(0,i.Wm)(a,{onSubmit:(0,n.iM)(r.signIn,["stop"])},{default:(0,i.w5)((()=>[(0,i._)("label",Ye,(0,l.zw)(e.$t(r.prompt)),1),(0,i.wy)((0,i._)("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=e=>o.key=e),placeholder:e.$t(r.placeholder),maxlength:"63",class:(0,l.C_)({valid:r.validKey,invalid:r.invalidKey})},null,10,Je),[[n.nr,o.key]]),(0,i._)("button",{type:"submit",class:"btn btn-primary",disabled:!r.validKey},(0,l.zw)(e.$t(r.buttonLabel)),9,Ge)])),_:1},8,["onSubmit"])])}var et=s(1560);const tt={name:"SignInForm",emits:["complete"],props:{privateKeyOnly:{type:Boolean,default:!1}},data(){return{key:null}},computed:{header(){return this.privateKeyOnly?"Private key needed":"Log in"},prompt(){return this.privateKeyOnly?"Paste your private key to continue":"Paste your public or private key"},placeholder(){return this.privateKeyOnly?"nsec…":"npub… / nsec…"},buttonLabel(){return this.privateKeyOnly?"Continue":"Log in"},validKey(){return this.isValidKey(this.key)},invalidKey(){return this.key&&this.key.length>=63&&!this.isValidKey(this.key)}},methods:{isValidKey(e){if(!e)return!1;try{const{data:t,prefix:s}=(0,et.Jx)(e.toLowerCase());return 32===t.byteLength&&("npub"===s&&!this.privateKeyOnly||"nsec"===s)}catch(t){return!1}},signIn(){if(!this.validKey)return;let e;e="npub"===(0,ie.t4)(this.key)?{pubkey:(0,ie.FX)(this.key)}:{privkey:(0,ie.FX)(this.key)};const t=(0,c.F)().addAccount(e);(0,oe.q)().switchAccount(t.pubkey),this.$emit("complete",{pubkey:t.pubkey})}},mounted(){this.$refs.input.focus()}},st=(0,_.Z)(tt,[["render",Xe],["__scopeId","data-v-30d43b28"]]),nt=st;S()(tt,"components",{QForm:Qe.Z});const ut={name:"SignInDialog",components:{UserAvatar:H.Z,SignInForm:nt,SignUpForm:Ke},props:{prompt:{type:String,default:""}},setup(){return{app:(0,oe.q)(),settings:(0,c.F)()}},data(){return{fragment:"welcome",backAllowed:!0,pubkey:null}},computed:{showClose(){return"welcome"===this.fragment||!this.backAllowed},showBack(){return!this.showClose},nip07available(){return _e.Z.isAvailable()}},methods:{onClose(){"function"===typeof this.app.signInDialog.callback&&this.app.signInDialog.callback.call(null,this.pubkey||!1),this.fragment="welcome",this.pubkey=null},onComplete({pubkey:e}){this.pubkey=e,this.$refs.signInDialog.hide()},updateFragment(){this.fragment=this.app.signInDialog.fragment||"welcome",this.backAllowed="welcome"===this.fragment},async signInNip07(){const e=await _e.Z.getPublicKey(),t={pubkey:e,useExtension:!0};this.settings.addAccount(t),this.app.switchAccount(e),this.onComplete({pubkey:e})}}},ot=(0,_.Z)(ut,[["render",Ne],["__scopeId","data-v-ab125d98"]]),it=ot;S()(ut,"components",{QDialog:ae.Z,QBtn:ce.Z}),S()(ut,"directives",{ClosePopup:De.Z});const rt={class:"create-post-dialog"};function at(e,t,s,n,u,o){const r=(0,i.up)("q-btn"),a=(0,i.up)("ListPost"),c=(0,i.up)("PostEditor"),D=(0,i.up)("q-dialog"),d=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(D,{modelValue:n.app.createPostDialog.open,"onUpdate:modelValue":t[1]||(t[1]=e=>n.app.createPostDialog.open=e),onBeforeShow:o.updateAncestor,onShow:t[2]||(t[2]=t=>e.$refs.postEditor.focus())},{default:(0,i.w5)((()=>[(0,i._)("div",rt,[(0,i.wy)((0,i.Wm)(r,{icon:"close",size:"md",flat:"",round:"",class:"icon"},null,512),[[d]]),u.ancestor?((0,i.wg)(),(0,i.j4)(a,{key:0,note:u.ancestor,"connector-bottom":""},null,8,["note"])):(0,i.kq)("",!0),(0,i.Wm)(c,{ref:"postEditor",class:(0,l.C_)(["post-editor",{standalone:!o.isReply}]),placeholder:o.placeholderText,connector:o.isReply,ancestor:u.ancestor,onPublish:t[0]||(t[0]=e=>n.app.createPostDialog.open=!1),compact:"",expanded:""},null,8,["class","placeholder","connector","ancestor"])])])),_:1},8,["modelValue","onBeforeShow"])}var ct=s(2017),lt=s(4995);const Dt={name:"CreatePostDialog",components:{ListPost:ct.Z,PostEditor:lt.Z},data(){return{ancestor:null}},setup(){return{app:(0,oe.q)(),nostr:(0,a.D)()}},computed:{paramAncestor(){return this.app.createPostDialog?.params?.ancestor},isReply(){return!!this.paramAncestor},placeholderText(){return this.isReply?"Post your reply":"What's happening?"}},methods:{updateAncestor(){this.ancestor=this.paramAncestor?this.nostr.getNote(this.paramAncestor):null}},async mounted(){this.updateAncestor()}},dt=(0,_.Z)(Dt,[["render",at],["__scopeId","data-v-22c96fc3"]]),pt=dt;S()(Dt,"components",{QDialog:ae.Z,QBtn:ce.Z}),S()(Dt,"directives",{ClosePopup:De.Z});const ht=e=>((0,i.dD)("data-v-a099118e"),e=e(),(0,i.Cn)(),e),mt={key:0,class:"following"},gt={class:"following-wrapper"},Ft={class:"following-header"},ft={class:"following-body"},bt=ht((()=>(0,i._)("div",{class:"following-gradient"},null,-1)));function yt(e,t,s,n,u,o){const r=(0,i.up)("UserCard");return n.app.isSignedIn&&o.contacts?.length?((0,i.wg)(),(0,i.iD)("div",mt,[(0,i._)("div",gt,[(0,i._)("div",Ft,[(0,i._)("h3",null,(0,l.zw)(e.$t("Following")),1)]),(0,i._)("div",ft,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.contacts,(t=>((0,i.wg)(),(0,i.j4)(r,{key:t.pubkey,pubkey:t.pubkey,class:"following-body-item",clickable:"",onClick:s=>e.goToProfile(t.pubkey)},null,8,["pubkey","onClick"])))),128))]),bt])])):(0,i.kq)("",!0)}var Ct=s(5198),Et=s(2929);const vt={name:"FollowingBox",components:{UserCard:Ct.Z},mixins:[Et.Z],setup(){return{app:(0,oe.q)(),nostr:(0,a.D)()}},computed:{pubkey(){return this.app.myPubkey},contacts(){return this.nostr.getContacts(this.pubkey)?.slice(0,20)}}},kt=(0,_.Z)(vt,[["render",yt],["__scopeId","data-v-a099118e"]]),wt=kt,At=(0,i.aZ)({name:"MainLayout",components:{FollowingBox:wt,MainMenu:Ee,SearchBox:ve.Z,WelcomeBox:Se,BaseIcon:A.Z,SignInDialog:it,CreatePostDialog:pt},data(){return{cachedPages:["FeedPage","Notifications","Messages","Inbox","Settings"],mobileMenuOpen:!1}},setup(){const e=(0,m.Z)();return e.screen.setSizes({sm:414,md:755,lg:1113,xl:1310}),e}});var Bt=s(7605),_t=s(2133);const Tt=(0,_.Z)(At,[["render",h],["__scopeId","data-v-d477c34c"]]),It=Tt;S()(At,"components",{QLayout:Bt.Z,QPageContainer:_t.Z}),S()(At,"directives",{ClosePopup:De.Z});const St=(0,i.aZ)({name:"App",components:{MainLayout:It},setup(){(0,c.F)().init(),(0,a.D)().init()}}),xt=(0,_.Z)(St,[["render",r]]),Rt=xt;var $t=s(3340),Pt=s(3746),Ot=s(1903);const Nt=(0,$t.h)((()=>{const e=(0,Pt.WB)();return e.use(Ot.Z),e}));var qt=s(8339);const Zt=[{path:"/",component:()=>Promise.all([s.e(4736),s.e(7691)]).then(s.bind(s,7691)),name:"home"},{path:"/profile/:pubkey(npub[a-z0-9A-Z]{59})/:tab(posts|replies|reactions|relays)?",component:()=>Promise.all([s.e(4736),s.e(6645)]).then(s.bind(s,6645)),name:"profile"},{path:"/profile/:pubkey(npub[a-z0-9A-Z]{59})/:tab(following|followers)",component:()=>Promise.all([s.e(4736),s.e(8729)]).then(s.bind(s,8729)),name:"followers"},{path:"/thread/:id(note[a-z0-9A-Z]{59})",component:()=>Promise.all([s.e(4736),s.e(5970)]).then(s.bind(s,5970)),name:"thread"},{path:"/notifications",component:()=>s.e(7890).then(s.bind(s,7890)),name:"notifications"},{path:"/messages",component:()=>s.e(9288).then(s.bind(s,9288)),name:"messages"},{path:"/messages/:pubkey(npub[a-z0-9A-Z]{59})",component:()=>Promise.all([s.e(4736),s.e(6745)]).then(s.bind(s,6745)),name:"conversation"},{path:"/settings",component:()=>Promise.all([s.e(4736),s.e(2613)]).then(s.bind(s,2613)),name:"settings"},{path:"/key",component:()=>s.e(6938).then(s.bind(s,6938)),name:"key"},{path:"/Following",component:()=>s.e(6678).then(s.bind(s,6678)),name:"Following"},{path:"/Traffic",component:()=>Promise.all([s.e(4736),s.e(6240)]).then(s.bind(s,6240)),name:"Traffic"},{path:"/SearchTag",component:()=>Promise.all([s.e(4736),s.e(4426)]).then(s.bind(s,4426)),name:"SearchTag"}],jt=Zt,Mt=(0,$t.BC)((function(){const e=qt.PO,t=(0,qt.p7)({scrollBehavior(e,t,s){return s||{top:0}},routes:jt,history:e("/FreeFromWeb/")});return t}));async function zt(e,t){const s=e(Rt);s.use(u.Z,t);const n="function"===typeof Nt?await Nt({}):Nt;s.use(n);const i=(0,o.Xl)("function"===typeof Mt?await Mt({store:n}):Mt);return n.use((({store:e})=>{e.router=i})),{app:s,store:n,router:i}}var Ut=s(6827);const Lt={config:{},plugins:{Notify:Ut.Z}},Wt="/FreeFromWeb/",Qt=/\/\//,Vt=e=>(Wt+e).replace(Qt,"/");async function Kt({app:e,router:t,store:s},n){let u=!1;const o=e=>{try{return Vt(t.resolve(e).href)}catch(s){}return Object(e)===e?null:e},i=e=>{if(u=!0,"string"===typeof e&&/^https?:\/\//.test(e))return void(window.location.href=e);const t=o(e);null!==t&&(window.location.href=t)},r=window.location.href.replace(window.location.origin,"");for(let c=0;!1===u&&c<n.length;c++)try{await n[c]({app:e,router:t,store:s,ssrContext:null,redirect:i,urlPath:r,publicPath:Wt})}catch(a){return a&&a.url?void i(a.url):void console.error("[Quasar] boot error:",a)}!0!==u&&(e.use(t),e.mount("#q-app"))}zt(n.ri,Lt).then((e=>{const[t,n]=void 0!==Promise.allSettled?["allSettled",e=>e.map((e=>{if("rejected"!==e.status)return e.value.default;console.error("[Quasar] boot error:",e.reason)}))]:["all",e=>e.map((e=>e.default))];return Promise[t]([Promise.resolve().then(s.bind(s,5155))]).then((t=>{const s=n(t).filter((e=>"function"===typeof e));Kt(e,s)}))}))},5155:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$t:()=>D,default:()=>l});var n=s(3340),u=s(7712);const o={thread:"Thread","Load {unread} unread":"Load {unread} unread"},i={About:"Presentación","Add an account":"Agregar cuenta","Add relay":"Agregar relay",April:"Abril",August:"Agosto",Cancels:"Cancelar","Click to decrypt":"Click para desencriptar",Close:"Cerrar",Continue:"Continuar",Create:"Crear","Create Account":"Crear una cuenta",December:"Diciembre","Decryption failed":"Fallo al desencriptar","Delete relay":"Eliminar relay","Do you really want to log out from":"¿Quieres Cerrar sesión de","Failed to create profile":"Fallo al crear el perfil","Failed to delete reaction":"Fallo al eliminar reacción","Failed to publish post":"No se pudo publicar la publicación","Failed to publish reaction":"Fallo al publicar reacción","Failed to send message":"Fallo al enviar mensaje","Failed to update followers":"Fallo al actualizar lista de seguidores","Failed to update profile":"Fallo al actualizar el perfil",February:"Febrero",Follow:"Seguir",Followers:"Seguidores",Following:"Seguidos",Global:"Global",Hilo:"Hilo",Home:"Inicio","icon in the recipient's profile.":"en elperfil del destinatario.",January:"Enero","Jot something down":"Apunta algo",July:"Julio",June:"Junio","Load {unread} unread":"Cargar {unread} sin leer","Load more":"Cargar más..","Loading...":"Cargando...","Log in":"Ingresar","Log in with Extension":"Ingresar con extensión","Log in with key":"Ingresar con clave","Log out":"Cerrar sesión","Logout from":"Cerrar sesión en","Make sure you have a backup of your private key! Otherwise it is impossible to log back in to your account.":"¡Asegúrate de tener una copia de seguridad de tu clave privada! De lo contrario, es imposible volver a iniciar sesión en su cuenta.",March:"Marzo","Mark all as read":"Marcar todo como leido",May:"Mayo",Message:"Mensaje",Messages:"Mensajes",Name:"Nombre","New to Nostr?":"¿Nuevo en Nostr?","NIP05 Identifier":"Identificador NIP05","NIP05 verified":"NIP05 verificado","No more items. Try again?":"No hay registros. ¿Intentar otra vez?","Nothing found.":"No hay registros.","Nothing here.":"Nada por aquí",Notifications:"Notificationes",November:"Noviembre",October:"Octubre","Paste your private key to continue":"Pega tu clave privada para continuar","Paste your public or private key":"Pega tu clave pública o privada","Picture URL":"Imagen de perfil",Post:"Postear","Post published to {numRelays} relays":"Posteo publicado en {numRelays} relays","Post your reply":"Postea tu respuesta",Posts:"Posteos","Private key needed":"Clave privada requira",Profile:"Perfil",Reactions:"Reacciones",Relays:"Relays",Replies:"Respuestas","Reply published to {numRelays} relays":"Repuesta publicada en {numRelays} relays","Replying to":"En respuesta a",Reset:"Resetear","Restore defaults":"Restaurar predeterminados",Save:"Guardar","Search profiles":"Buscar perfiles","Send private message":"Enviar mensaje privado",September:"Septiembre",Settings:"Preferencias",Key:"Key","This is the beginning of your message history with":"Este es el comienzo de su historial de mensajes con",thread:"Hilo",Thread:"Hilo","Tip with Bitcoin Lightning":"Dar propina con Bitcoin Lightning","To send a message, click on the":"Para enviar un mensaje, haga clic en el icono","Try again?":"¿Intentar otra vez?",Unfollow:"Dejar de seguir","What's happening?":"¿Qué estas pensando?","What's your name?":"Cual es tu nombre?"},r={en:o,es:i},[a="en"]=(navigator?.language||"").split("-"),c=(0,u.o)({locale:a,fallbackLocale:"en",globalInjection:!0,messages:r}),l=(0,n.xr)((({app:e})=>{e.use(c)})),D=c.global.t},1153:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});s(9665);var n=s(7498),u=s(2296);class o{constructor(e){this.event=new n.ZP({id:e.id,pubkey:e.pubkey||e.author,created_at:e.created_at||e.createdAt||u.Z.now(),kind:e.kind,tags:e.tags||[],content:e.content||"",sig:e.sig})}static post(e,t){return new o({kind:n.nS.NOTE,pubkey:e,content:t})}static reply(e,t,s){const u=[],i=e.eventRefs().root();return i&&u.push([n.Qy.EVENT,i]),u.push([n.Qy.EVENT,e.id]),u.push([n.Qy.PUBKEY,e.author]),new o({kind:n.nS.NOTE,pubkey:t,content:s,tags:u})}static reaction(e,t){const s=[];return s.push([n.Qy.EVENT,e.id]),s.push([n.Qy.PUBKEY,e.author]),new o({kind:n.nS.REACTION,pubkey:t,content:"❤️",tags:s})}static metadata(e,t){return new o({kind:n.nS.METADATA,pubkey:e,content:JSON.stringify(t)})}static contacts(e,t){const s=t.map((e=>[n.Qy.PUBKEY,e]));return new o({kind:n.nS.CONTACT,pubkey:e,tags:s})}static delete(e,t){const s=[];return s.push([n.Qy.EVENT,e.id]),new o({kind:n.nS.DELETE,pubkey:t,content:"delete",tags:s})}static share(e,t){const s=[];return s.push([n.Qy.EVENT,e.id,"","mention"]),s.push([n.Qy.PUBKEY,e.author]),new o({kind:n.nS.SHARE,pubkey:t,content:e.content,tags:s})}static message(e,t,s){const u=[[n.Qy.PUBKEY,t]];return new o({kind:n.nS.DM,pubkey:e,content:s,tags:u})}createdAt(e){return this.event.created_at=e,this}pubkeyTag(e){return this.event.tags.push([n.Qy.PUBKEY,e]),this}eventTag(e,t=null,s=null){const u=[n.Qy.EVENT,e];return t&&u.push(t),s&&u.push(s),this.event.tags.push(u),this}content(e){return this.event.content=e,this}build(){return new n.ZP(this.event)}}},6166:(e,t,s)=>{"use strict";s.d(t,{D:()=>B});s(9665);var n=s(3746),u=s(499),o=s(7498);class i{constructor(){this.listeners={}}on(e,t){this.addListener(e,{callback:t,once:!1})}once(e,t){this.addListener(e,{callback:t,once:!0})}off(e,t){const s=this.listeners[e];if(!s)return;const n=s.findIndex((e=>e.callback===t));n>=0&&s.splice(n,1)}addListener(e,t){this.listeners[e]?this.listeners[e].push(t):this.listeners[e]=[t]}emit(e,...t){const s=this.listeners[e];if(s){for(const u of s)try{u.callback.apply(null,t)}catch(n){console.error(`Exception thrown from '${e}' listener: ${n.message||n}`,n)}this.listeners[e]=s.filter((e=>!e.once))}}}class r extends i{constructor(e,t,s){super(),this.relay=e,this.subId=t,this.closeAfter=s,this.closed=!1}close(){this.closed||(this.closed=!0,this.relay.unsubscribe(this.subId),this.emit("close",this.relay,this.subId))}onEvent(e){const t=o.ZP.from(e);t.validate()?(this.emit("event",t,this.relay,this.subId),this.closeAfter===a.SINGLE&&this.close()):console.error(`Invalid event from ${this.relay}`,t)}onEose(){this.emit("eose",this.relay,this.subId),this.closeAfter===a.EOSE&&this.close()}}const a={SINGLE:"single",EOSE:"eose",NEVER:"never"};class c extends i{constructor(e,t){super(),this.url=e,this.socket=new l(e,t),this.socket.on("open",this.emit.bind(this,"open",this)),this.socket.on("close",this.emit.bind(this,"close",this)),this.socket.on("error",this.emit.bind(this,"error",this)),this.socket.on("message",this.onMessage.bind(this)),this.subs={},this.nextSubId=0}connect(){this.socket.connect()}disconnect(){this.socket.disconnect()}isConnected(){return this.socket.isConnected()}publish(e){return new Promise((t=>{if(!this.socket.send(["EVENT",e]))return t(!1);let s;const n=(u,o)=>{u===e.id&&o&&(clearTimeout(s),this.off("ok",n),t(!0))};s=setTimeout((()=>{this.off("ok",n),t(!1)}),4e3),this.on("ok",n)}))}subscribe(e,t=null,s=a.NEVER){console.log("Relay.js------------subscribe----------"),t||(t="sub"+this.nextSubId++);const n=new r(this,t,s);return this.subs[t]=n,this.socket.send(["REQ",t,e]),console.log("REQ------------REQ----------",n),n}unsubscribe(e){this.subs[e]&&(delete this.subs[e],this.socket.send(["CLOSE",e]))}onMessage(e){try{this.processMessage(e.data)}catch(t){console.error(`Invalid message from ${this.url}: ${t.message||t}`,e.data,t)}}processMessage(e){const t=JSON.parse(e);if(!Array.isArray(t)||!t.length)throw new Error("not a nostr message");const s=t[0];switch(s){case"EVENT":{c.enforceArrayLength(t,3);const[e,s,n]=t,u=this.subs[s];u&&u.onEvent(n),this.emit("event",s,n);break}case"EOSE":{c.enforceArrayLength(t,2);const[e,s]=t,n=this.subs[s];n&&n.onEose(),this.emit("eose",s);break}case"NOTICE":{c.enforceArrayLength(t,2);const[e,s]=t;this.emit("notice",s);break}case"OK":{c.enforceArrayLength(t,4);const[e,s,n,u]=t;this.emit("ok",s,n,u);break}default:throw new Error(`unknown message type '${s}'`)}}static enforceArrayLength(e,t){if(e.length!==t)throw new Error(`unexpected length (expected ${t}, got ${e.length})`);if(e.some((e=>void 0===e)))throw new Error(`required element missing (${t} needed)`)}toString(){return this.url}}class l extends i{constructor(e,t){super(),this.url=e,this.opts=Object.assign({reconnect:!0,reconnectAfter:3e3},t),this.socket=null,this.disconnected=!1,this.reconnectAfter=this.opts.reconnectAfter,this.reconnectTimer=null,window.addEventListener("online",this.connect.bind(this)),window.addEventListener("focus",this.connect.bind(this))}connect(){if(this.isConnected())return;this.disconnected=!1,this.reconnectTimer=null;const e=new WebSocket(this.url);e.onopen=this.onOpen.bind(this),e.onclose=this.onClose.bind(this),e.onerror=this.onError.bind(this),e.onmessage=this.onMessage.bind(this),this.socket=e}disconnect(){this.disconnected=!0,this.close()}reconnect(){this.disconnected||this.reconnectTimer||(console.log(`[RELAY] Scheduling reconnect to ${this.url} in ${this.reconnectAfter}ms`),this.reconnectTimer=setTimeout((()=>{console.log(`[RELAY] Reconnecting to ${this.url} now`),this.reconnectTimer=null,this.connect()}),this.reconnectAfter),this.reconnectAfter=Math.min(this.reconnectAfter*=2,3e5))}isConnected(){return this.socket&&this.socket.readyState===WebSocket.OPEN}close(){this.socket&&this.socket.close(),this.socket=null}send(e){if(!this.isConnected())return console.warn(`Not connected to ${this.url} (currently ${this.socket?.readyState})`),!1;try{return this.socket.send(JSON.stringify(e)),!0}catch(t){return!1}}onOpen(){this.emit("open",this),this.reconnectAfter=this.opts.reconnectAfter}onClose(){this.close(),this.emit("close",this),this.opts.reconnect&&this.reconnect()}onError(e){console.log(`Socket error from relay ${this.url}`,e),this.emit("error",e,this),this.isConnected()||(this.close(),this.opts.reconnect&&this.reconnect())}onMessage(e){this.emit("message",e,this)}}class D extends i{constructor(e,t){super(),this.subId=e,this.subs={};for(const s of t)this.subs[s.relay]=s,this.setupListeners(s)}setupListeners(e){e.on("event",this.emit.bind(this,"event")),e.on("eose",this.onEose.bind(this)),e.on("close",this.onClose.bind(this))}add(e){console.assert(e.subId===this.subId,"invalid subId"),this.subs[e.relay]=e,this.setupListeners(e)}close(e=null){if(e)this.subs[e]&&this.subs[e].close();else for(const t of Object.values(this.subs))t.close()}onEose(e){const t=this.subs[e];t&&(this.emit("eose",e,this.subId),t.eoseSeen||(t.eoseSeen=!0,Object.values(this.subs).every((e=>e.eoseSeen))&&this.emit("end",this.subId)))}onClose(e){delete this.subs[e],0===Object.keys(this.subs).length&&this.emit("close",this.subId)}}class d extends i{constructor(e,t=5){super(),this.relays={},this.minRelays=Math.min(t,e.length),this.subs={},this.nextSubId=0;for(const s of e)this.add(s)}add(e){if(this.relays[e])return;const t=new c(e);t.on("open",this.onOpen.bind(this)),t.on("close",this.emit.bind(this,"close",t)),t.on("event",this.emit.bind(this,"event",t)),t.on("eose",this.emit.bind(this,"eose",t)),t.on("notice",this.emit.bind(this,"notice",t)),t.on("ok",this.emit.bind(this,"ok",t)),this.relays[e]=t}remove(e){const t=this.relays[e];t&&(t.disconnect(),delete this.relays[e])}async publish(e){const t=[];for(const s of this.connectedRelays())t.push(s.publish(e));return Promise.all(t).then((e=>e.filter((e=>e)).length)).catch((e=>(console.error("Error while publishing",e),0)))}subscribe(e,t=null,s=a.NEVER){t||(t="sub"+this.nextSubId++);const n=new D(t,[]);n.on("close",this.unsubscribe.bind(this,t)),this.subs[t]={sub:n,filters:e,closeAfter:s};const u=this.connectedRelays();if(console.log("connectedRelays----------",u),u.length>=this.minRelays)for(const o of u)console.log("relay.subscribe----------"),n.add(o.subscribe(e,t,s));else this.subs[t].pending=!0;return n}unsubscribe(e){const t=this.subs[e];t&&(console.log(`[UNSUBSCRIBE] ${e}`),t.sub.close(),delete this.subs[e])}connect(){for(const e of Object.values(this.relays))e.connect()}disconnect(){for(const e of Object.values(this.relays))e.disconnect()}connectedRelays(){return Object.values(this.relays).filter((e=>e.isConnected()))}numConnectedRelays(){return this.connectedRelays().length}onOpen(e){console.log(`[RELAY] Connected to ${e}`);for(const t of Object.keys(this.subs)){const s=this.subs[t],n=this.connectedRelays();if(n.length>=this.minRelays)if(s.pending){s.pending=!1;for(const e of n)s.sub.add(e.subscribe(s.filters,t,s.closeAfter))}else s.sub.add(e.subscribe(s.filters,t,s.closeAfter))}this.emit("open",e)}}class p{constructor(e){this.pool=new d(e),this.pool.on("notice",this.onNotice.bind(this)),this.pool.on("ok",this.onOk.bind(this))}connect(){this.pool.connect()}disconnect(){this.pool.disconnect()}connectedRelays(){return this.pool.connectedRelays()}isConnectedTo(e){return this.connectedRelays().some((t=>t.url===e))}subscribe(e,t=null,s=a.NEVER){return this.pool.subscribe(e,t,s)}unsubscribe(e){this.pool.unsubscribe(e)}publish(e){return this.pool.publish(e)}fetch(e,t={}){return new Promise((s=>{const n={},u=this.pool.subscribe(e,t.subId,a.EOSE),o=setTimeout((()=>{u.close(),s(Object.values(n))}),t.timeout||4e3);u.on("event",(e=>{n[e.id]=e})),u.on("end",(()=>{u.close(),clearTimeout(o),s(Object.values(n))})),u.on("close",(()=>{clearTimeout(o),s(Object.values(n))}))}))}stream(e,t,s=(()=>{}),n={}){const u={},o=this.pool.subscribe(e,n.subId),i=setTimeout((()=>{s(Object.values(u))}),n.timeout||4e3);return o.on("event",(e=>{u[e.id]=e})),o.on("end",(()=>{clearTimeout(i),s(Object.values(u))})),o}onNotice(e,t){console.warn(`[NOTICE] from ${e}: ${t}`)}onOk(e,t,s,n){console.log(`[OK] from ${e}: eventId=${t}, wasSaved=${s}, message=${n}`)}}class h extends i{constructor(e,t,s,n,u={}){super(),this.client=e,this.subId=t,this.sub=null,this.fnGetId=s,this.fnCreateFilter=n,this.throttle=u.throttle||250,this.batchSize=u.batchSize||250,this.timeout=u.timeout||3e3,this.maxAttempts=u.maxAttempts||2,this.queue={},this.failed={},this.fetching=!1,this.fetchQueued=!1,this.fetchTimeout=null}add(e){if(!e)throw new Error(`invalid id ${e}`);void 0===this.queue[e]&&(this.failed[e]||(this.queue[e]=0,this.fetching||this.fetchQueued||(setTimeout(this.fetch.bind(this),this.throttle),this.fetchQueued=!0)))}fetch(){this.fetchQueued=!1,this.fetchTimeout&&clearTimeout(this.fetchTimeout);const e=Object.keys(this.queue).slice(0,this.batchSize);if(!e.length)return void(this.fetching=!1);const t=[];for(const n of e)this.queue[n]++,this.queue[n]>this.maxAttempts?(console.warn(`Failed to fetch ${this.subId} ${n}`),this.failed[n]=!0,delete this.queue[n]):t.push(n);if(!t.length)return void(this.fetching=!1);console.log(`Fetching ${this.subId}s ${t.length}/${Object.keys(this.queue).length} `),this.fetching=!0,this.fetchTimeout=setTimeout(this.fetch.bind(this),this.timeout);const s=this.client.subscribe(this.fnCreateFilter(t),this.subId);s.on("event",((e,n,u)=>{const o=this.fnGetId(e);this.queue[o]&&(delete this.queue[o],t.splice(t.indexOf(o),1),this.emit("event",e,n),0===Object.keys(this.queue).length?(this.fetchTimeout&&clearTimeout(this.fetchTimeout),this.fetching=!1,s.close()):0===t.length&&this.fetch())})),s.on("end",(()=>{this.fetching&&Object.keys(this.queue).length>0?this.fetch():(console.log("[COMPLETE]",this),this.fetchTimeout&&clearTimeout(this.fetchTimeout),this.fetching=!1,s.close())})),s.on("close",(()=>{this.fetching&&Object.keys(this.queue).length>0&&this.fetch()}))}}var m=s(2187),g=s(1156);const F=(0,n.Q_)("contact",{state:()=>({contacts:{},followers:{}}),getters:{getContacts(e){return t=>e.contacts[t]},getFollowers(e){return t=>e.followers[t]}},actions:{addEvent(e){console.assert(e.kind===o.nS.CONTACT);const t=this.contacts[e.pubkey];if(t&&t.lastUpdatedAt>=e.createdAt)return t;const s=[];s.lastUpdatedAt=e.createdAt;for(const n of e.pubkeyTags())s.push({pubkey:n.ref,relay:n.relay,name:n.marker});if(t)for(const n of t)this.removeFollower(n.pubkey,e.pubkey);for(const n of s)this.addFollower(n.pubkey,e.pubkey);return this.contacts[e.pubkey]=s,e},addFollower(e,t){this.followers[e]?this.followers[e].push(t):this.followers[e]=[t]},removeFollower(e,t){const s=this.followers[e];if(!s)return;const n=s.indexOf(t);n<0||s.splice(n,1)}}});var f=s(6840),b=s(734),y=s(3099),C=s(3413),E=s(2296);class v extends i{constructor(e){super(),this.sub=e,e.on("close",this.emit.bind(this,"close"))}close(e=null){this.sub.close(e)}}const k=(e,t)=>new h(e,t,(e=>e.id),(e=>({ids:e}))),w=e=>new h(e,"profile",(e=>e.pubkey),(e=>({kinds:[o.nS.METADATA],authors:e}))),A=e=>new h(e,"contact",(e=>e.pubkey),(e=>({kinds:[o.nS.CONTACT],authors:e}))),B=(0,n.Q_)("nostr",{state:()=>({seenBy:{}}),getters:{activeUser(){return(0,y.q)().myPubkey}},actions:{init(){const e=(0,f.F)();this.client=(0,u.Xl)(new p(e.relays)),this.client.connect(),this.profileQueue=w(this.client),this.profileQueue.on("event",this.addEvent.bind(this)),this.noteQueue=k(this.client,"note"),this.noteQueue.on("event",this.addEvent.bind(this)),this.contactQueue=A(this.client,"queue"),this.contactQueue.on("event",this.addEvent.bind(this)),this.userSubs=[],this.getProfiles(Object.keys(e.accounts)),this.activeUser&&this.subscribeForUser(this.activeUser)},addEvent(e,t=null){if(t?.url)if(this.seenBy[e.id])this.seenBy[e.id][t.url]=E.Z.now();else{this.seenBy[e.id]={[t.url]:E.Z.now()};const s=(0,b.a)();s.addEvent(e)}switch(e.kind){case o.nS.METADATA:return(0,g.O)().addEvent(e);case o.nS.NOTE:return(0,m.d)().addEvent(e);case o.nS.RELAY:break;case o.nS.CONTACT:return F().addEvent(e);case o.nS.DM:return(0,C.G)().addEvent(e);case o.nS.DELETE:return(0,m.d)().deleteEvent(e),e;case o.nS.SHARE:return e;case o.nS.REACTION:return(0,m.d)().addEvent(e);case o.nS.CHATROOM:return e;default:return e}},hasEvent(e){return!!this.seenBy[e]},async publish(e){const t=await this.client.publish(e);return t&&this.addEvent(e,{url:"<local>"}),t},subscribeForUser(e){this.unsubscribeForUser(),this.getProfile(e),this.getContacts(e),this.fetch({kinds:[o.nS.REACTION],authors:[e],limit:50}),this.fetch({kinds:[o.nS.DM],authors:[e],limit:400});const t=[],s=this.client.subscribe({kinds:[o.nS.METADATA,o.nS.CONTACT,o.nS.REACTION,o.nS.SHARE,o.nS.DM],authors:[e],limit:0},`user:${e.substr(0,40)}`);s.on("event",this.addEvent.bind(this)),t.push(s);const n=this.client.subscribe({kinds:[o.nS.NOTE,o.nS.REACTION,o.nS.SHARE,o.nS.DM],"#p":[e],limit:400},`notifications:${e.substr(0,40)}`);n.on("event",this.addEvent.bind(this)),t.push(n),this.userSubs=t},unsubscribeForUser(){for(const e of this.userSubs)e.close();this.userSubs=[]},getNotifications(e){const t=(0,m.d)();return t.notesByTag(e,m.i.CREATION_DATE_DESC)},getProfile(e){const t=(0,g.O)(),s=t.get(e);return s||this.profileQueue.add(e),s},getProfiles(e){const t=[];for(const s of e)t.push(this.getProfile(s));return t},getNote(e){const t=(0,m.d)();let s=t.get(e);return s||this.hasEvent(e)||this.noteQueue.add(e),s},getRepliesTo(e,t=m.i.CREATION_DATE_DESC){const s=(0,m.d)(),n=s.repliesTo(e,t);return n},getPostsByAuthor(e,t=m.i.CREATION_DATE_DESC){const s=(0,m.d)();return s.postsByAuthor(e,t)},fetchPostsByAuthor(e,t=100){return this.fetch({kinds:[o.nS.NOTE],authors:[e],limit:t})},getContacts(e){const t=F(),s=t.getContacts(e);return s||this.contactQueue.add(e),s},getFollowers(e){const t=F(),s=t.getFollowers(e);return s},fetchFollowers(e,t=500){return this.fetch({kinds:[o.nS.CONTACT],"#p":[e],limit:t})},getReactionsTo(e,t=m.i.CREATION_DATE_DESC){const s=(0,m.d)(),n=s.reactionsTo(e,t);return n},getOurReactionsTo(e,t=m.i.CREATION_DATE_DESC){if(!this.activeUser)return[];const s=(0,m.d)();return s.reactionsTo(e,t).filter((e=>e.author===this.activeUser))},fetchReactionsTo(e,t=500){return this.fetch({kinds:[o.nS.REACTION],"#e":[e]},t)},getReactionsByAuthor(e,t=m.i.CREATION_DATE_DESC){const s=(0,m.d)(),n=s.reactionsByAuthor(e,t);return n},fetchReactionsByAuthor(e,t=500){return this.fetch({kinds:[o.nS.REACTION],authors:[e],limit:t})},async fetch(e,t={}){return new Promise((s=>{const n={},u=this.client.subscribe(e,t.subId,a.EOSE);console.log("src/nostr/NostrStore------fetch执行");const o=setTimeout((()=>{const t=Object.values(n);console.log(`[TIMEOUT] fetch ${u.subId} (${t.length})`,e),u.close(),s(t)}),t.timeout||4e3);u.on("end",(()=>{const t=Object.values(n);console.log(`[COMPLETE] fetch ${u.subId} (${t.length})`,e),u.close(),clearTimeout(o),s(t)})),u.on("close",(()=>{clearTimeout(o),s(Object.values(n))})),u.on("event",((e,t)=>{const s=this.addEvent(e,t);s?n[e.id]=s:console.warn("Discarding event",e)}))}))},stream(e,t={}){let s={};const n=this.client.subscribe(e,t.subId),u=new v(n),o=setTimeout((()=>{const t=Object.values(s);console.log(`[TIMEOUT] stream ${n.subId} (${t.length})`,e),u.emit("init",t),s=null}),t.timeout||4e3);return n.on("end",(()=>{if(clearTimeout(o),!s)return;const t=Object.values(s);console.log(`[COMPLETE] stream ${n.subId} (${t.length})`,e),u.emit("init",t),s=null})),n.on("event",((e,t)=>{const n=this.hasEvent(e.id),o=this.addEvent(e,t);o?n||(s?s[e.id]=o:u.emit("update",o,t,u)):console.warn("Discarding event",e)})),u},streamThread(e){return this.stream({kinds:[o.nS.NOTE,o.nS.REACTION,o.nS.SHARE],"#e":[e],limit:500},{subId:`thread:${e.substr(0,40)}`})},streamNotifications(e){return this.stream({kinds:[o.nS.NOTE,o.nS.REACTION],"#p":[e],limit:50},{subId:`notifications:${e.substr(0,40)}`})},streamFullProfile(e){},cancelStream(e){Array.isArray(e)||(e=[e]);for(const t of e)this.client.unsubscribe(t)}}})},7175:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var n=s(1156),u=s(556),o=s(4520);class i{constructor(){this.profiles=(0,n.O)()}async queryProfiles(e){const t=new Set,[s,n]=e?.split("@")||[];return n?((await i.queryNip05(s,n)).forEach((e=>t.add(e))),this.profiles.findByNip05(e).forEach((e=>t.add(e)))):(0,o.iY)(e)&&"npub"===(0,o.t4)(e)?t.add((0,o.FX)(e)):this.profiles.findByName(e).forEach((e=>t.add(e))),Array.from(t)}static async queryNip05(e,t){const s=await u.Z.fetchNames(t);return s?e?Object.entries(s).filter((([t,s])=>t?.toLowerCase().startsWith(e.toLowerCase()))).map((([e,t])=>t)):Object.values(s):[]}}},7498:(e,t,s)=>{"use strict";s.d(t,{Qy:()=>o,Uu:()=>r,ZP:()=>a,nS:()=>u});s(9665);var n=s(7256);const u={METADATA:0,NOTE:1,RELAY:2,CONTACT:3,DM:4,DELETE:5,SHARE:6,REACTION:7,CHATROOM:42},o={PUBKEY:"p",EVENT:"e"};class i{constructor(e,t,s=null,n=null){this.type=e,this.ref=t,this.relay=s,this.marker=n}static from(e){if(e&&e[0]&&e[1])return new i(e[0],e[1],e[2]||null,e[3]||null)}}class r extends Array{constructor(e){super(...e.map((e=>e.ref))),this.tags=e}root(){return this.tags.find((e=>"root"===e.marker))?.ref||this[0]}ancestor(){return this.tags.find((e=>"reply"===e.marker))?.ref||this.tags.find((e=>"root"===e.marker))?.ref||this[this.length-1]}isEmpty(){return 0===this.length}}class a{constructor(e){this.id=e.id,this.pubkey=e.pubkey,this.created_at=e.createdAt||e.created_at,this.kind=e.kind,this.tags=e.tags||[],this.content=e.content,this.sig=e.sig}static from(e){return new a(e)}static parseTags(e){const t=[];for(const s of e){const e=i.from(s);e&&t.push(e)}return t}get author(){return this.pubkey}get createdAt(){return this.created_at}validate(){return(0,n.Z5)(this)&&(0,n.uM)(this)}hash(){return(0,n.s_)(this)}pubkeyTags(){return a.parseTags(this.tags).filter((e=>e.type===o.PUBKEY))}eventTags(){return a.parseTags(this.tags).filter((e=>e.type===o.EVENT))}pubkeyRefs(){return this.pubkeyTags().map((e=>e.ref))}eventRefs(){return new r(this.eventTags())}hasAncestor(){return this.eventTags().some((e=>"mention"!==e.marker))}}},4264:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});s(9665);var n=s(7498),u=s(4520);class o{constructor(e,t){this.id=e,this.kind=t.kind||n.nS.NOTE,this.author=t.author||t.pubkey,this.createdAt=t.createdAt,this.content=t.content||"",this.tags=t.tags||[]}static from(e){const t=o.isReaction(e)?o.normalizeReactionContent(e.content):e.content;return new o(e.id,{kind:e.kind,author:e.pubkey,createdAt:e.createdAt,content:t,tags:n.ZP.parseTags(e.tags)})}hasAncestor(){return this.eventTags().some((e=>"mention"!==e.marker))}canReply(){return this.kind===n.nS.NOTE}root(){return this.eventRefs().root()}ancestor(){return this.eventRefs().ancestor()}pubkeyTags(){return this.tags.filter((e=>e.type===n.Qy.PUBKEY))}eventTags(){return this.tags.filter((e=>e.type===n.Qy.EVENT))}pubkeyRefs(){return this.pubkeyTags().map((e=>e.ref))}eventRefs(){return new n.Uu(this.eventTags())}relatedPubkeys(){return[this.author].concat(this.pubkeyRefs())}contentTagRefs(){return o.contentTagRefs(this)}static contentTagRefs(e){const t=/#\[([0-9]+)]/g;let s,n=[];while(s=t.exec(e.content))n.push(s[1]);return n}isRepost(){return o.isRepost(this)}static isRepost(e){return!!/^#\[([0-9]+)]$/.test(e.content)&&e.tags[o.contentTagRefs(e)[0]]?.type===n.Qy.EVENT}static mentionsPubkey(e,t){return!!e.tags.some((e=>e.type===n.Qy.PUBKEY&&e.ref===t&&"mention"===e.marker))||o.contentTagRefs(e).map((t=>e.tags[t])).some((e=>e.type===n.Qy.PUBKEY&&e.ref===t))}isRepostOrTag(){return o.isRepostOrTag(this)}static isRepostOrTag(e){return/^#\[([0-9]+)]$/.test(e.content)}isReaction(){return o.isReaction(this)}static isReaction(e){return e.kind===n.nS.REACTION||e.hasAncestor()&&o.isReactionContent(e.content)}static isReactionContent(e){return"+"===e||""===e||(0,u.nB)(e)}static normalizeReactionContent(e){return(0,u.nB)(e)?e:"❤️"}}},3413:(e,t,s)=>{"use strict";s.d(t,{G:()=>a});s(9665);var n=s(3746),u=s(7498);class o{constructor(e,t){this.id=e,this.author=t.author||t.pubkey,this.createdAt=t.createdAt,this.kind=t.kind,this.content=t.content||"",this.tags=t.tags,this.recipients=t.recipients,this.ancestor=t.ancestor,this.plaintext=t.plaintext}static from(e){console.assert(e.kind===u.nS.DM);const t=e.pubkeyRefs();if(!t||!t.length)return;const s=e.eventRefs().ancestor();return new o(e.id,{author:e.pubkey,createdAt:e.createdAt,kind:e.kind,content:e.content,tags:e.tags,recipients:t,ancestor:s})}get recipient(){return this.recipients[0]}cachePlaintext(e){this.plaintext=e}}var i=s(2187),r=s(2296);const a=(0,n.Q_)("message",{state:()=>({messages:{},byRecipient:{},bySender:{}}),getters:{getConversations(e){return e=>{const t=[];for(const s of this.getCounterparties(e)){const n=this.getMessages(e,s),u=n.reduce(((e,t)=>e.createdAt>t.createdAt?e:t),{createdAt:0}),o=c().getLastRead(e,s),i=n.filter((e=>e.createdAt>o&&e.author===s)).length;t.push({pubkey:s,latestMessage:u,numUnread:i})}return t.sort(((e,t)=>t.latestMessage?.createdAt-e.latestMessage?.createdAt)),t}},getConversation(){return(e,t)=>this.getMessages(e,t).sort(i.i.CREATION_DATE_ASC)},getMessages(e){return(t,s)=>(e.byRecipient[t]?.[s]||[]).concat(t!==s&&e.bySender[t]?.[s]||[])},getCounterparties(e){return t=>{const s=new Set;return Object.keys(e.byRecipient[t]||{}).forEach((e=>s.add(e))),Object.keys(e.bySender[t]||{}).forEach((e=>s.add(e))),Array.from(s)}},getNumUnread(){return e=>this.getConversations(e).reduce(((e,t)=>e+t.numUnread),0)}},actions:{addEvent(e){const t=o.from(e);if(!t)return!1;if(this.messages[t.id])return this.messages[t.id];this.messages[t.id]=t,this.bySender[t.author]||(this.bySender[t.author]={});const s=this.bySender[t.author];for(const n of t.recipients){s[n]||(s[n]=[]),s[n].push(t),this.byRecipient[n]||(this.byRecipient[n]={});const e=this.byRecipient[n];e[t.author]||(e[t.author]=[]),e[t.author].push(t)}return t},markAsRead(e,t){return c().markAsRead(e,t)},markAllAsRead(e){const t=c();for(const s of this.getCounterparties(e))t.markAsRead(e,s)}}}),c=(0,n.Q_)("message-status",{state:()=>({lastRead:{}}),getters:{getLastRead(e){return(t,s)=>e.lastRead[t]?.[s]||0}},actions:{markAsRead(e,t){this.lastRead[e]||(this.lastRead[e]={}),this.lastRead[e][t]=r.Z.now()}},persist:!0})},2187:(e,t,s)=>{"use strict";s.d(t,{d:()=>r,i:()=>o});s(9665);var n=s(3746),u=s(4264);const o={CREATION_DATE_ASC:(e,t)=>e.createdAt-t.createdAt,CREATION_DATE_DESC:(e,t)=>t.createdAt-e.createdAt};class i{constructor(){this.byAuthor={},this.byAncestor={},this.byTag={}}add(e){i.addToIndex(this.byAuthor,e.author,e),e.hasAncestor()&&i.addToIndex(this.byAncestor,e.ancestor(),e);for(const t of e.pubkeyRefs())i.addToIndex(this.byTag,t,e)}remove(e){i.removeFromIndex(this.byAuthor,e.author,e.id),i.removeFromIndex(this.byAncestor,e.ancestor(),e.id);for(const t of e.pubkeyRefs())i.removeFromIndex(this.byTag,t,e.id)}static addToIndex(e,t,s){e[t]||(e[t]=[]),e[t].push(s)}static removeFromIndex(e,t,s){const n=e[t];if(!n)return;const u=n.findIndex((e=>e.id===s));u<0||(n.splice(u,1),n.length||delete e[t])}getByAuthor(e){return this.byAuthor[e]}getByAncestor(e){return this.byAncestor[e]}getByTag(e){return this.byTag[e]}}const r=(0,n.Q_)("note",{state:()=>({notes:{},postIndex:new i,reactionIndex:new i}),getters:{get(e){return t=>e.notes[t]},notesByAuthor(e){return(t,s=o.CREATION_DATE_ASC)=>(e.postIndex.getByAuthor(t)||[]).concat(e.reactionIndex.getByAuthor(t)||[]).sort(s)},notesByTag(e){return(t,s=o.CREATION_DATE_ASC)=>(e.postIndex.getByTag(t)||[]).concat(e.reactionIndex.getByTag(t)).sort(s)},repliesTo(e){return(t,s=o.CREATION_DATE_ASC)=>(e.postIndex.getByAncestor(t)||[]).sort(s)},postsByAuthor(e){return(t,s=o.CREATION_DATE_ASC)=>(e.postIndex.getByAuthor(t)||[]).sort(s)},postsByTag(e){return(t,s=o.CREATION_DATE_ASC)=>(e.postIndex.getByTag(t)||[]).sort(s)},reactionsTo(e){return(t,s=o.CREATION_DATE_ASC)=>(e.reactionIndex.getByAncestor(t)||[]).sort(s)},reactionsByAuthor(e){return(t,s=o.CREATION_DATE_ASC)=>(e.reactionIndex.getByAuthor(t)||[]).sort(s)},reactionsByTag(e){return(t,s=o.CREATION_DATE_ASC)=>(e.reactionIndex.getByTag(t)||[]).sort(s)}},actions:{addEvent(e){const t=u.Z.from(e);return!!t&&(this.notes[t.id]||(this.notes[t.id]=t,t.isReaction()?this.reactionIndex.add(t):this.postIndex.add(t)),this.notes[t.id])},deleteEvent(e){for(const t of e.eventRefs())this.deleteNote(t,e.pubkey)},deleteNote(e,t){const s=this.get(e);s&&s.author===t&&(s.isReaction()?this.reactionIndex.remove(s):this.postIndex.remove(s),delete this.notes[e])}}})},1156:(e,t,s)=>{"use strict";s.d(t,{O:()=>r});var n=s(3746),u=s(7498),o=s(556);class i{constructor(e,t,s){this.pubkey=e,this.lastUpdatedAt=t,this.name=s.name,this.about=s.about,this.picture=s.picture,this.nip05={url:s.nip05,verified:null},this.lud06=s.lud06,this.lud16=s.lud16}static from(e){console.assert(e.kind===u.nS.METADATA);try{const t=JSON.parse(e.content);return new i(e.pubkey,e.createdAt,t)}catch(t){return console.error(`Failed to parse METADATA event: ${t.message||t}`,e,t),null}}async isNip05Verified(){return null!==this.nip05.verified?this.nip05.verified:!!this.nip05.url&&(this.nip05.verified=await o.Z.verify(this.pubkey,this.nip05.url),this.nip05.verified)}}const r=(0,n.Q_)("profile",{state:()=>({profiles:{}}),getters:{get(e){return t=>e.profiles[t]},findByName(e){return t=>Object.values(e.profiles).filter((e=>e.name?.toLowerCase().startsWith(t?.toLowerCase()))).map((e=>e.pubkey))},findByNip05(e){return t=>Object.values(e.profiles).filter((e=>e.nip05.url?.toLowerCase().endsWith(t?.toLowerCase()))).map((e=>e.pubkey))}},actions:{addEvent(e){const t=i.from(e);if(!t)return!1;const s=this.profiles[t.pubkey];return(!s||s.lastUpdatedAt<t.lastUpdatedAt)&&(this.profiles[t.pubkey]=t),this.profiles[t.pubkey]}}})},734:(e,t,s)=>{"use strict";s.d(t,{a:()=>r});var n=s(3746),u=s(7498),o=s(4264),i=s(2187);const r=(0,n.Q_)("stat",{state:()=>({stats:{}}),getters:{get(e){return t=>e.stats[t]||{comments:0,reactions:0,shares:0}}},actions:{addEvent(e){switch(e.kind){case u.nS.NOTE:if(o.Z.isReaction(e)){const t=this.getOrInit(e.eventRefs().ancestor());t.reactions++}else if(o.Z.isRepostOrTag(e)){const t=this.getOrInit(e.eventRefs().ancestor());t.shares++}else for(const t of e.eventRefs()){const e=this.getOrInit(t);e.comments++}break;case u.nS.REACTION:{const t=e.eventRefs();if(t.isEmpty())break;const s=this.getOrInit(t.ancestor());s.reactions++;break}case u.nS.SHARE:{const t=e.eventRefs();if(t.isEmpty())break;const s=this.getOrInit(t.ancestor());s.shares++;break}case u.nS.DELETE:this.deleteEvent(e);break}},deleteEvent(e){for(const t of e.eventRefs())this.deleteNote(t,e.pubkey)},deleteNote(e,t){const s=(0,i.d)(),n=s.get(e);if(n&&n.author===t)if(n.isReaction()){const e=this.getOrInit(n.ancestor());e.reactions--}else if(n.isRepostOrTag()){const e=this.getOrInit(n.ancestor());e.shares--}else for(const u of n.eventRefs()){const e=this.getOrInit(u);e.comments--}},getOrInit(e){return this.stats[e]||(this.stats[e]={comments:0,reactions:0,shares:0}),this.stats[e]}}})},2929:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});s(9665);var n=s(4520);function u(e,t){return(0,n.iY)(e)?e:(0,n.jm)(e,t)}const o={methods:{goToProfile(e){this.$router.push({name:"profile",params:{pubkey:u(e,"npub")}})},goToThread(e){this.$router.push({name:"thread",params:{id:u(e,"note")}})},linkToProfile(e){return`/profile/${u(e,"npub")}`},linkToThread(e){return`/thread/${u(e,"note")}`}}}},3099:(e,t,s)=>{"use strict";s.d(t,{q:()=>a});s(9665);var n=s(3746),u=s(6840),o=s(6166),i=s(499),r=s(3556);const a=(0,n.Q_)("app",{state:()=>({signInDialog:{open:!1,fragment:null,callback:null},createPostDialog:{open:!1,params:{}},queue:(0,i.Xl)(new r.Z)}),getters:{activeAccount(){const e=(0,u.F)();return e.activeAccount},isSignedIn(){return!!this.activeAccount},myPubkey(){return this.activeAccount?.pubkey}},actions:{signIn(e="welcome"){return this.queue.push((()=>new Promise((t=>{this.signInDialog.callback=t,this.signInDialog.fragment=e,this.signInDialog.open=!0}))))},signInIfNeeded(e="welcome"){return this.isSignedIn?Promise.resolve(!0):this.signIn(e)},switchAccount(e){const t=(0,u.F)();t.switchAccount(e);const s=(0,o.D)();s.subscribeForUser(e)},async createPost(e={}){await this.signInIfNeeded()&&(this.createPostDialog.params=e,this.createPostDialog.open=!0)},async signEvent(e){if(await this.signInIfNeeded()&&(this.activeAccount.canSign()||await this.signIn("private-key")))return await this.activeAccount.sign(e)},async decryptMessage(e,t){if(await this.signInIfNeeded()&&(this.activeAccount.canDecrypt()||await this.signIn("private-key")))return await this.activeAccount.decrypt(e,t)},async encryptMessage(e,t){if(await this.signInIfNeeded()&&(this.activeAccount.canEncrypt()||await this.signIn("private-key")))return await this.activeAccount.encrypt(e,t)}}})},6840:(e,t,s)=>{"use strict";s.d(t,{F:()=>c});s(9665);var n=s(3746),u=s(7256),o=s(4968);class i{constructor(e){if(this.pubkey=e.pubkey||null,this.privkey=e.privkey||null,this.useExtension=e.useExtension||!1,this.privkey&&!this.pubkey&&(this.pubkey=(0,u.$3)(this.privkey)),!this.pubkey)throw new Error("pubkey is required")}canSign(){return!!this.privkey||this.useExtension&&o.Z.isAvailable()}async sign(e){if(e.id=(0,u.s_)(e),this.privkey)e.sig=(0,u.Y5)(e,this.privkey);else{if(!this.useExtension||!o.Z.isAvailable())throw new Error("cannot sign");{let{sig:t}=await o.Z.signEvent(e);e.sig=t}}return e}canDecrypt(){return this.canSign()}decrypt(e,t){if(this.privkey)return u._J.decrypt(this.privkey,e,t);if(this.useExtension&&o.Z.isAvailable())return o.Z.decrypt(e,t);throw new Error("cannot decrypt")}canEncrypt(){return this.canSign()}encrypt(e,t){if(this.privkey)return u._J.encrypt(this.privkey,e,t);if(this.useExtension&&o.Z.isAvailable())return o.Z.encrypt(e,t);throw new Error("cannot encrypt")}}const r=["wss://eden.nostr.land","wss://nostr.fmt.wiz.biz","wss://relay.damus.io","wss://nostr-pub.wellorder.net","wss://relay.nostr.info","wss://offchain.pub","wss://nos.lol","wss://brb.io","wss://relay.snort.social","wss://relay.current.fyi","wss://nostr.relayer.se"],a=2,c=(0,n.Q_)("settings",{state:()=>({accounts:{},pubkey:null,relays:[].concat(r),relaysVersion:0}),getters:{activeAccount(e){const t=e.accounts[e.pubkey];if(t)return new i(t)},hasAccount(e){return t=>!!e.accounts[t]},hasRelay(e){return t=>e.relays.indexOf(t)>=0}},actions:{init(){this.relaysVersion<a&&this.hasSubsetOfDefaultRelays()&&(this.relays=[].concat(r),this.relaysVersion=a)},addAccount(e){const t=new i(e);return this.accounts[t.pubkey]=t,this.pubkey||(this.pubkey=t.pubkey),t},removeAccount(e){if(delete this.accounts[e],this.pubkey===e){const e=Object.keys(this.accounts);e.length?this.pubkey=e[0]:this.pubkey=null}},switchAccount(e){if(!this.accounts[e])throw new Error(`unknown account ${e}`);this.pubkey=e},addRelay(e){this.hasRelay(e)||this.relays.push(e)},removeRelay(e){const t=this.relays.indexOf(e);t>=0&&this.relays.splice(t,1)},restoreDefaultRelays(){this.relays=[].concat(r)},hasDefaultRelays(){return this.relays.length===r.length&&this.relays.every(((e,t)=>e===r[t]))},hasSubsetOfDefaultRelays(){return this.relays.length<r.length&&this.relays.every(((e,t)=>r.indexOf(e)>=0))}},persist:!0})},2296:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var n=s(6801),u=s(2934),o=s(9252),i=s(5155);const r=["January","February","March","April","May","June","July","August","September","October","November","December"],[a="en"]=(navigator?.language||"").split("-");class c{static now(){return Math.floor(Date.now()/1e3)}static formatDate(e){const t=new Date(1e3*e),s=(0,i.$t)(r[t.getMonth()]),n=t.getFullYear()===(new Date).getFullYear(),u=n?"":" "+t.getFullYear();return`${t.getDate()} ${s}${u}`}static formatTime(e){const t=new Date(1e3*e),s=`0${t.getHours()}`.slice(-2),n=`0${t.getMinutes()}`.slice(-2);return`${s}:${n}`}static formatDateTime(e){return`${c.formatDate(e)}, ${c.formatTime(e)}`}static formatFromNow(e,t="long"){return"short"===t?c.formatFromNowShort(e):c.formatFromNowLong(e)}static formatFromNowLong(e){return(0,n.Z)(1e3*e,{locale:"es"===a?u.Z:o.Z})}static formatFromNowShort(e){const t=Math.max(c.now()-e,0),s=(e,s,n)=>Math.max(Math.floor((t+e*n)/(e*s)),1);return t<45?`${s(1,1,0)}s`:t<2700?`${s(1,60,15)}m`:t<79200?`${s(60,60,15)}h`:t<2246400?`${s(3600,24,2)}d`:t<82944e4?`${s(86400,30,4)}mo`:`${s(86400,10950,45)}y`}}},3556:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});s(9665);class n{constructor(){this.queue=[],this.working=!1}push(e){return new Promise(((t,s)=>{this.queue.push({fn:e,resolve:t,reject:s}),this.working||this.work().catch((e=>console.error(e)))}))}async work(){this.working=!0;while(this.queue.length>0){const t=this.queue.shift();try{const e=await t.fn();t.resolve(e)}catch(e){t.reject&&t.reject(e)}}this.working=!1}}},556:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var n=s(3688),u=s.n(n);class o{static async fetchPubkey(e){const[t,s]=e.split("@");if(!t||!s)return;const n=`https://${s}/.well-known/nostr.json?name=${t}`;try{const e=await u()(n),s=await e.json();if(!s||!s.names)return;return s.names[t]}catch(o){}}static async fetchNames(e){const t=`https://${e}/.well-known/nostr.json`;try{const e=await u()(t),s=await e.json();return s?.names}catch(s){}}static async verify(e,t){const s=await o.fetchPubkey(t);return s&&s===e}}},4968:(e,t,s)=>{"use strict";s.d(t,{Z:()=>u});s(9665);var n=s(3556);class u{static isAvailable(){return!!window.nostr}static enforceAvailable(){if(!u.isAvailable())throw new Error("Nip07 support not available")}static getPublicKey(){return u.enforceAvailable(),u.queue.push((()=>window.nostr.getPublicKey()))}static signEvent(e){return u.enforceAvailable(),u.queue.push((()=>window.nostr.signEvent(e)))}static encrypt(e,t){return u.enforceAvailable(),u.queue.push((()=>window.nostr.nip04.encrypt(e,t)))}static decrypt(e,t){return u.enforceAvailable(),u.queue.push((()=>window.nostr.nip04.decrypt(e,t)))}}u.queue=new n.Z},4520:(e,t,s)=>{"use strict";s.d(t,{FX:()=>a,Ku:()=>l,RI:()=>p,Sk:()=>d,iY:()=>i,jm:()=>c,nB:()=>o,t4:()=>r});s(5231),s(3075),s(548),s(2079),s(8218),s(6046),s(9665);var n=s(1560);const u=/^[#*0-9]\uFE0F?\u20E3|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26AA\u26B0\u26B1\u26BD\u26BE\u26C4\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0-\u26F5\u26F7\u26F8\u26FA\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B55\u3030\u303D\u3297\u3299]\uFE0F?|[\u261D\u270C\u270D](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\u270A\u270B](?:\uD83C[\uDFFB-\uDFFF])?|[\u23E9-\u23EC\u23F0\u23F3\u25FD\u2693\u26A1\u26AB\u26C5\u26CE\u26D4\u26EA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2795-\u2797\u27B0\u27BF\u2B50]|\u26F9(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\u2764\uFE0F?(?:\u200D(?:\uD83D\uDD25|\uD83E\uDE79))?|\uD83C(?:[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]\uFE0F?|[\uDF85\uDFC2\uDFC7](?:\uD83C[\uDFFB-\uDFFF])?|[\uDFC3\uDFC4\uDFCA](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDFCB\uDFCC](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uDDE6\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|\uDDE7\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|\uDDE8\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|\uDDE9\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|\uDDEA\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|\uDDEB\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|\uDDEC\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|\uDDED\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|\uDDEE\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|\uDDEF\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|\uDDF0\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|\uDDF1\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|\uDDF2\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|\uDDF3\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|\uDDF4\uD83C\uDDF2|\uDDF5\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|\uDDF6\uD83C\uDDE6|\uDDF7\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|\uDDF8\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|\uDDF9\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|\uDDFA\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|\uDDFB\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|\uDDFC\uD83C[\uDDEB\uDDF8]|\uDDFD\uD83C\uDDF0|\uDDFE\uD83C[\uDDEA\uDDF9]|\uDDFF\uD83C[\uDDE6\uDDF2\uDDFC]|\uDFF3\uFE0F?(?:\u200D(?:\u26A7\uFE0F?|\uD83C\uDF08))?|\uDFF4(?:\u200D\u2620\uFE0F?|\uDB40\uDC67\uDB40\uDC62\uDB40(?:\uDC65\uDB40\uDC6E\uDB40\uDC67|\uDC73\uDB40\uDC63\uDB40\uDC74|\uDC77\uDB40\uDC6C\uDB40\uDC73)\uDB40\uDC7F)?)|\uD83D(?:[\uDC08\uDC26](?:\u200D\u2B1B)?|[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]\uFE0F?|[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC](?:\uD83C[\uDFFB-\uDFFF])?|[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD74\uDD90](?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?|[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC25\uDC27-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDC-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uDC15(?:\u200D\uD83E\uDDBA)?|\uDC3B(?:\u200D\u2744\uFE0F?)?|\uDC41\uFE0F?(?:\u200D\uD83D\uDDE8\uFE0F?)?|\uDC68(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDC68\uDC69]\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?)|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?\uDC68\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D\uDC68\uD83C[\uDFFB-\uDFFE])))?))?|\uDC69(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:\uDC8B\u200D\uD83D)?[\uDC68\uDC69]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D(?:[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?|\uDC69\u200D\uD83D(?:\uDC66(?:\u200D\uD83D\uDC66)?|\uDC67(?:\u200D\uD83D[\uDC66\uDC67])?))|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFC-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFD-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFD\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D\uD83D(?:[\uDC68\uDC69]|\uDC8B\u200D\uD83D[\uDC68\uDC69])\uD83C[\uDFFB-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83D[\uDC68\uDC69]\uD83C[\uDFFB-\uDFFE])))?))?|\uDC6F(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDD75(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|\uDE2E(?:\u200D\uD83D\uDCA8)?|\uDE35(?:\u200D\uD83D\uDCAB)?|\uDE36(?:\u200D\uD83C\uDF2B\uFE0F?)?)|\uD83E(?:[\uDD0C\uDD0F\uDD18-\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5\uDEC3-\uDEC5\uDEF0\uDEF2-\uDEF8](?:\uD83C[\uDFFB-\uDFFF])?|[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD](?:\uD83C[\uDFFB-\uDFFF])?(?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDDDE\uDDDF](?:\u200D[\u2640\u2642]\uFE0F?)?|[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDE0-\uDDFF\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC2\uDECE-\uDEDB\uDEE0-\uDEE8]|\uDD3C(?:\u200D[\u2640\u2642]\uFE0F?|\uD83C[\uDFFB-\uDFFF])?|\uDDD1(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1))|\uD83C(?:\uDFFB(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFC-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFC(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFD-\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFD(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFE(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFD\uDFFF]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?|\uDFFF(?:\u200D(?:[\u2695\u2696\u2708]\uFE0F?|\u2764\uFE0F?\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1\uD83C[\uDFFB-\uDFFE]|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E(?:[\uDDAF-\uDDB3\uDDBC\uDDBD]|\uDD1D\u200D\uD83E\uDDD1\uD83C[\uDFFB-\uDFFF])))?))?|\uDEF1(?:\uD83C(?:\uDFFB(?:\u200D\uD83E\uDEF2\uD83C[\uDFFC-\uDFFF])?|\uDFFC(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFD-\uDFFF])?|\uDFFD(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])?|\uDFFE(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFD\uDFFF])?|\uDFFF(?:\u200D\uD83E\uDEF2\uD83C[\uDFFB-\uDFFE])?))?)$/;function o(e){return!/\w/.test(e)&&u.test(e)}function i(e){return/^(note|npub|nsec)[a-z0-9]{59}$/i.test(e)}function r(e){if(e&&!(e.length<4))return e.substr(0,4).toLowerCase()}function a(e){if(!e)return;let t;try{t=(0,n.Jx)(e.toLowerCase())?.data}catch(s){return void console.warn(`Failed to bech32decode ${e}`)}return t.reduce(((e,t)=>{let s=t.toString(16);return 1===s.length&&(s="0"+s),e+s}),"")}function c(e,t=""){if(!e||e.length%2!==0)return;let s=new Uint8Array(e.length/2);for(let n=0;n<s.length;n++)s[n]=parseInt(e.substr(2*n,2),16);return(0,n.cv)(t,s)}function l(e){if(!e)return e;let t=i(e)?9:5;return e.substr(0,t)+"…"+e.substr(-5)}const D=(e,t)=>{let s=null;if("[object String]"!==Object.prototype.toString.call(e))try{s=JSON.stringify(e)}catch(n){t(n)}else try{e=e.replace(/(\')/g,'"'),s=JSON.stringify(JSON.parse(e))}catch(n){t(n)}return s},d=(e,t)=>{let s="",n=0,u="&nbsp;&nbsp;&nbsp;&nbsp;",o=D(e,t);if(!o)return o;let i=[],r=null,a=null,c=[];return o=o.replace(/([\{\}])/g,"\r\n$1\r\n"),o=o.replace(/([\[\]])/g,"\r\n$1\r\n"),o=o.replace(/(\,)/g,"$1\r\n"),o=o.replace(/(\r\n\r\n)/g,"\r\n"),o=o.replace(/\r\n\,/g,","),c=o.split("\r\n"),c.forEach((function(e,t){let s=e.match(/\"/g)?e.match(/\"/g).length:0;s%2&&!r&&(r=t),s%2&&r&&r!=t&&(a=t),r&&a&&(i.push({start:r,end:a}),r=null,a=null)})),i.reverse().forEach((function(e,t){let s=c.slice(e.start,e.end+1);c.splice(e.start,e.end+1-e.start,s.join(""))})),o=c.join("\r\n"),o=o.replace(/\:\r\n\{/g,":{"),o=o.replace(/\:\r\n\[/g,":["),c=o.split("\r\n"),c.forEach((function(e,t){let o=0,i=0,r="";for(e.match(/\{$/)||e.match(/\[$/)?i+=1:e.match(/\}$/)||e.match(/\]$/)||e.match(/\},$/)||e.match(/\],$/)?0!==n&&(n-=1):i=0,o=0;o<n;o++)r+=u;s+=r+e+"<br />",n+=i})),s.trim().replace(new RegExp("^\\<br />+|\\<br />+$","g"),"")};function p(e,t,s){const n=[...s.content.matchAll(e)].map((e=>e[1])).filter(((e,t,s)=>s.indexOf(e)===t));if(console.log("taggedItems----------------@@@",n),n){console.log("handleTagged----------------@@@"),s.tags=s.tags||[];for(const e of n){const n=a(e.replace("@",""));if(!n)continue;const u=[t,n,"","mention"];s.tags.find((e=>e[0]===u[0]&&e[1]===u[1]))||s.tags.push(u);const o=s.tags.findIndex((e=>e[0]===u[0]&&e[1]===u[1]));s.content=s.content.replace(e,`#[${o}]`)}}return s}},7664:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var n=s(9835);function u(e,t,s,u,o,i){return(0,n.wg)(),(0,n.j4)((0,n.LL)(e.iconComponent))}const o=(0,n.aZ)({name:"BaseIcon",props:{icon:{type:String,default:"home"}},data(){return{name:this.icon}},computed:{iconComponent(){return this.name,(0,n.RC)((()=>s(8037)(`./${this.name}.vue`)))}},watch:{icon(e){this.name=e}}});var i=s(1639);const r=(0,i.Z)(o,[["render",u]]),a=r},3942:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(9835),u=s(1957);const o=["placeholder","disabled","rows"];function i(e,t,s,i,r,a){return(0,n.wy)(((0,n.wg)(),(0,n.iD)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.text=e),placeholder:e.$t(s.placeholder),disabled:s.disabled,rows:s.rows,onInput:t[1]||(t[1]=(...e)=>a.resize&&a.resize(...e)),onFocus:t[2]||(t[2]=(...e)=>a.resize&&a.resize(...e)),onKeydown:[t[3]||(t[3]=(0,u.D2)((0,u.iM)(((...e)=>a.onEnterPressed&&a.onEnterPressed(...e)),["exact"]),["enter"])),t[4]||(t[4]=(0,u.D2)((0,u.iM)(((...e)=>a.onCtrlEnterPressed&&a.onCtrlEnterPressed(...e)),["ctrl"]),["enter"]))],ref:"textarea"},null,40,o)),[[u.nr,r.text]])}const r={name:"AutoSizeTextarea",props:{modelValue:{type:[String,Number],required:!0},minHeight:{type:Number,default:null},maxHeight:{type:Number,default:null},placeholder:{type:String,default:"What's happening?"},disabled:{type:Boolean,default:!1},rows:{type:Number,default:2},submitOnEnter:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],data(){return{text:this.modelValue}},watch:{modelValue(e){this.text=e},text(e){this.$nextTick(this.resize),this.$emit("update:modelValue",e)}},methods:{resize(){this.$nextTick((()=>{const e=this.$refs.textarea;e.style.height="inherit";let t=e.scrollHeight;this.minHeight&&(t=Math.max(t,this.minHeight)),this.maxHeight&&(t=Math.min(t,this.maxHeight)),e.style.height=t+"px"}))},insertText(e){const t=this.$refs.textarea;if(t.setRangeText(e,t.selectionStart,t.selectionEnd),t.focus(),t.selectionStart===t.selectionEnd){const s=t.selectionStart+e.length;t.setSelectionRange(s,s)}this.$emit("update:modelValue",t.value)},focus(){this.$refs.textarea.focus()},onEnterPressed(e){this.submitOnEnter&&(e.preventDefault(),this.$emit("submit"))},onCtrlEnterPressed(e){this.submitOnEnter&&(e.preventDefault(),this.insertText("\n"))}},mounted(){this.text&&this.resize()}};var a=s(1639);const c=(0,a.Z)(r,[["render",i]]),l=c},2056:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var n=s(9835);function u(e,t,s,u,o,i){const r=(0,n.up)("Picker");return(0,n.wg)(),(0,n.j4)(r,{data:o.emojiIndex,native:!0,"show-skin-tones":!0,emoji:"thumbsup",title:"",color:"#ee517d",onSelect:i.onSelect},null,8,["data","onSelect"])}var o=s(2859),i=s(502);const r={name:"EmojiPicker",components:{Picker:i.cW},emits:["select"],data(){return{emojiIndex:new i.xd(o)}},methods:{onSelect(e){this.$emit("select",e)}}};var a=s(1639);const c=(0,a.Z)(r,[["render",u]]),l=c},4995:(e,t,s)=>{"use strict";s.d(t,{Z:()=>q});var n=s(9835),u=s(6970);const o=e=>((0,n.dD)("data-v-291e5afc"),e=e(),(0,n.Cn)(),e),i={class:"post-editor-author"},r={key:0,class:"connector-top"},a=o((()=>(0,n._)("div",{class:"connector-line"},null,-1))),c=[a],l={class:"post-editor-content"},D={class:"input-section"},d={class:"controls"},p={class:"controls-media"},h={class:"controls-media-item"},m={class:"controls-media-item disabled"},g={class:"controls-submit"},F=["disabled"],f={key:1},b={key:0,class:"post-editor-fake-submit"},y={class:"btn btn-primary btn-sm",disabled:""};function C(e,t,s,o,a,C){const E=(0,n.up)("UserAvatar"),v=(0,n.up)("AutoSizeTextarea"),k=(0,n.up)("BaseIcon"),w=(0,n.up)("EmojiPicker"),A=(0,n.up)("q-menu"),B=(0,n.up)("q-spinner");return(0,n.wg)(),(0,n.iD)("div",{class:(0,u.C_)(["post-editor",{compact:s.compact,collapsed:a.collapsed,connector:s.connector}])},[(0,n._)("div",i,[s.connector?((0,n.wg)(),(0,n.iD)("div",r,c)):(0,n.kq)("",!0),(0,n.Wm)(E,{pubkey:o.app.myPubkey},null,8,["pubkey"])]),(0,n._)("div",l,[(0,n._)("div",D,[(0,n.Wm)(v,{modelValue:a.content,"onUpdate:modelValue":t[0]||(t[0]=e=>a.content=e),ref:"textarea",placeholder:s.placeholder,disabled:a.publishing,onFocusOnce:t[1]||(t[1]=e=>a.collapsed=!1)},null,8,["modelValue","placeholder","disabled"])]),(0,n._)("div",d,[(0,n._)("div",p,[(0,n._)("div",h,[(0,n.Wm)(k,{icon:"emoji"}),(0,n.Wm)(A,{ref:"menuEmojiPicker"},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{onSelect:C.onEmojiSelected},null,8,["onSelect"])])),_:1},512)]),(0,n._)("div",m,[(0,n.Wm)(k,{icon:"image"})])]),(0,n._)("div",g,[(0,n._)("button",{disabled:!C.hasContent()||a.publishing,onClick:t[2]||(t[2]=(...e)=>C.publishPost&&C.publishPost(...e)),class:"btn btn-primary btn-sm"},[a.publishing?((0,n.wg)(),(0,n.j4)(B,{key:0})):((0,n.wg)(),(0,n.iD)("span",f,(0,u.zw)(e.$t("Post")),1))],8,F)])])]),a.collapsed?((0,n.wg)(),(0,n.iD)("div",b,[(0,n._)("button",y,(0,u.zw)(e.$t("Post")),1)])):(0,n.kq)("",!0)],2)}s(9665);var E=s(3942),v=s(5501),k=s(7664),w=s(2056),A=s(3099),B=s(6166),_=s(1153),T=s(5155),I=s(4520);const S={name:"PostEditor",components:{AutoSizeTextarea:E.Z,BaseIcon:k.Z,UserAvatar:v.Z,EmojiPicker:w.Z},props:{ancestor:{type:Object,default:null},placeholder:{type:String,default:"What's happening?"},compact:{type:Boolean,default:!1},connector:{type:Boolean,default:!1},expanded:{type:Boolean,default:!1}},emits:["publish"],data(){return{content:"",collapsed:this.compact&&!this.expanded,publishing:!1}},setup(){return{app:(0,A.q)(),nostr:(0,B.D)()}},methods:{hasContent(){return this.content.trim().length>0},onEmojiSelected(e){this.$refs.menuEmojiPicker.hide(),this.$refs.textarea.insertText(e.native)},focus(){this.$refs.textarea.focus()},reset(){this.content=""},async publishPost(){const e=/(?:^|\s)((?:@)?npub[a-zA-Z0-9]{59,60})(?![\w/])/gi,t=/(?:^|\s)((?:@)?note[a-zA-Z0-9]{59,60})(?![\w/])/gi,s=/(#\w+)/g;this.publishing=!0;const n=this.ancestor?_.Z.reply(this.ancestor,this.app.myPubkey,this.content).build():_.Z.post(this.app.myPubkey,this.content).build();(0,I.RI)(t,"e",n),(0,I.RI)(e,"p",n);const u=[...n.content.matchAll(s)].map((e=>e[0].slice(1)));if(u.length){n.tags=n.tags||[];for(const e of u)n.tags.find((t=>"t"===t[0]&&t[1]===e))||n.tags.push(["t",e])}if(console.log("event----------------",n),!await this.app.signEvent(n))return;console.log("--------event",n);const o=await this.nostr.publish(n);if(o){this.reset(),this.$emit("publish",n),console.log("--------numRelays",o);const e=this.ancestor?"Reply":"Post";this.$q.notify({message:(0,T.$t)(`${e} published to `+o+" relays",{numRelays:o}),color:"positive"})}else this.$q.notify({message:(0,T.$t)("Failed to publish post"),color:"negative"});this.publishing=!1}}};var x=s(1639),R=s(6362),$=s(3940),P=s(9984),O=s.n(P);const N=(0,x.Z)(S,[["render",C],["__scopeId","data-v-291e5afc"]]),q=N;O()(S,"components",{QMenu:R.Z,QSpinner:$.Z})},2017:(e,t,s)=>{"use strict";s.d(t,{Z:()=>Y});var n=s(9835),u=s(6970),o=s(1957);const i=e=>((0,n.dD)("data-v-37613c90"),e=e(),(0,n.Cn)(),e),r={class:"post-author"},a={class:"connector-top"},c={key:0,class:"connector-line"},l={class:"connector-bottom"},D={key:0,class:"connector-line"},d={class:"post-content"},p={class:"post-content-header"},h={class:"author-line"},m=i((()=>(0,n._)("span",null,"·",-1))),g={class:"created-at"},F={key:0,class:"in-reply-to"},f={class:"sign-in-dialog"},b={class:"title"},y={style:{"font-size":"24px"}},C={class:"content"},E=["innerHTML"],v={class:"post-content-body"},k={key:0,class:"post-content-actions"};function w(e,t,s,i,w,A){const B=(0,n.up)("UserAvatar"),_=(0,n.up)("UserName"),T=(0,n.up)("q-icon"),I=(0,n.up)("q-item-section"),S=(0,n.up)("q-separator"),x=(0,n.up)("q-item"),R=(0,n.up)("q-list"),$=(0,n.up)("q-menu"),P=(0,n.up)("q-btn"),O=(0,n.up)("q-dialog"),N=(0,n.up)("PostRenderer"),q=(0,n.up)("PostActions"),Z=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)("div",{class:(0,u.C_)(["post",{clickable:s.clickable}]),onClick:t[11]||(t[11]=(0,o.iM)((t=>s.clickable&&e.goToThread(s.note.id)),["stop"]))},[(0,n._)("div",r,[(0,n._)("div",a,[s.connectorTop?((0,n.wg)(),(0,n.iD)("div",c)):(0,n.kq)("",!0)]),(0,n.Wm)(B,{pubkey:s.note.author,clickable:"",onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"]))},null,8,["pubkey"]),(0,n._)("div",l,[s.connectorBottom?((0,n.wg)(),(0,n.iD)("div",D)):(0,n.kq)("",!0)])]),(0,n._)("div",d,[(0,n._)("div",p,[(0,n._)("p",h,[(0,n.Wm)(_,{pubkey:s.note.author,clickable:"","show-verified":"",onClick:t[1]||(t[1]=(0,o.iM)((()=>{}),["stop"]))},null,8,["pubkey"]),m,(0,n._)("span",g,(0,u.zw)(A.createdAt),1)]),s.note.hasAncestor()?((0,n.wg)(),(0,n.iD)("p",F,[(0,n.Uk)((0,u.zw)(e.$t("Replying to"))+" ",1),(0,n._)("a",{onClick:t[2]||(t[2]=(0,o.iM)((t=>e.goToProfile(A.ancestor?.author)),["stop"]))},[A.ancestor?.author?((0,n.wg)(),(0,n.j4)(_,{key:0,pubkey:A.ancestor?.author},null,8,["pubkey"])):(0,n.kq)("",!0)])])):(0,n.kq)("",!0),(0,n.Wm)(P,{color:"primary",icon:"more_horiz",onClick:t[8]||(t[8]=(0,o.iM)((()=>{}),["stop"])),round:"",outline:"",size:"xs",class:"btntip"},{default:(0,n.w5)((()=>[(0,n.Wm)($,{class:"bg-black",offset:[75,5]},{default:(0,n.w5)((()=>[(0,n.Wm)(R,{style:{"min-width":"100px"}},{default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.j4)(x,{clickable:"",onClick:t[7]||(t[7]=(0,o.iM)((()=>{}),["stop"]))},{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[(0,n._)("text",{onClick:t[3]||(t[3]=(0,o.iM)(((...e)=>A.copyUserId&&A.copyUserId(...e)),["stop"]))},[(0,n.Wm)(T,{name:"content_copy",class:"iconbox"}),(0,n.Uk)("Copy User ID ")]),(0,n._)("text",{onClick:t[4]||(t[4]=(0,o.iM)(((...e)=>A.copyNoteId&&A.copyNoteId(...e)),["stop"]))},[(0,n.Wm)(T,{name:"content_copy",class:"iconbox"}),(0,n.Uk)("Copy Note ID ")]),(0,n._)("text",{onClick:t[5]||(t[5]=(0,o.iM)(((...e)=>A.info&&A.info(...e)),["stop"]))},[(0,n.Wm)(T,{name:"content_copy",class:"iconbox"}),(0,n.Uk)("Copy Raw Data ")]),s.note.author==i.app.activeAccount.pubkey?((0,n.wg)(),(0,n.iD)("text",{key:0,onClick:t[6]||(t[6]=(0,o.iM)((e=>A.del()),["stop"]))},[(0,n.Wm)(T,{name:"cancel",class:"iconbox"}),(0,n.Uk)("Delete ")])):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(S)])),_:1})),[[Z]])])),_:1})])),_:1})])),_:1})]),(0,n.Wm)(O,{modelValue:w.metadataDialog,"onUpdate:modelValue":t[10]||(t[10]=e=>w.metadataDialog=e)},{default:(0,n.w5)((()=>[(0,n._)("div",f,[(0,n.wy)((0,n.Wm)(P,{icon:"close",size:"md",class:"icon",flat:"",round:""},null,512),[[Z]]),(0,n._)("div",b,[(0,n._)("text",y,[(0,n.Uk)(" raw event data "),(0,n.Wm)(P,{icon:"content_copy",size:"md",flat:"",round:"",color:"primary",onClick:t[9]||(t[9]=e=>A.copystr(w.CopyStr))})])]),(0,n._)("div",C,[(0,n._)("div",{innerHTML:w.noteStr},null,8,E)])])])),_:1},8,["modelValue"]),(0,n._)("div",v,[(0,n.Wm)(N,{note:s.note},null,8,["note"])]),A.showActions?((0,n.wg)(),(0,n.iD)("div",k,[(0,n.Wm)(q,{note:s.note},null,8,["note"])])):(0,n.kq)("",!0)])],2)}var A=s(5501),B=s(9715),_=s(8500),T=s(8993),I=s(3099),S=s(6166),x=s(2929),R=s(2296),$=s(4520),P=s(1153);const O={name:"ListPost",mixins:[x.Z],components:{PostActions:T.Z,UserAvatar:A.Z,UserName:B.Z,PostRenderer:_.Z},props:{note:{type:Object,required:!0},connectorTop:{type:Boolean,default:!1},connectorBottom:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},actions:{type:Boolean,default:!1}},setup(){return{app:(0,I.q)(),nostr:(0,S.D)()}},data(){return{refreshCounter:0,refreshTimer:null,metadataDialog:!1,noteStr:"",CopyStr:""}},computed:{ancestor(){return this.note.hasAncestor()?this.nostr.getNote(this.note.ancestor()):null},showActions(){return this.actions&&this.note.canReply()},createdAt(){return this.refreshCounter,this.formatPostDate(this.note.createdAt)}},methods:{formatPostDate(e){const t=this.$q.screen.lt.md?"short":"long";return R.Z.formatFromNow(e,t)},info(){this.metadataDialog=!0,console.log("str----",this.note.id);let e=(0,$.Sk)(this.nostr.getNote(this.note.id)),t=JSON.stringify(this.nostr.getNote(this.note.id));console.log("str----",this.nostr.getNote(this.note.id)),this.noteStr=e,this.CopyStr=t},async copystr(e){e&&(console.log("str----",e),await navigator.clipboard.writeText(e).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})})))},async del(){const e=P.Z["delete"](this.note,this.app.myPubkey).build();e.id=this.note.id,console.log("event--------------------",e),await this.app.signEvent(e)&&(await this.nostr.publish(e)||this.$q.notify({message:$t("Failed to publish reaction"),color:"negative"}))},async copyNoteId(){const e=(0,$.jm)(this.note.id,"note");await navigator.clipboard.writeText(e).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})}))},async copyUserId(){const e=(0,$.jm)(this.note.author,"npub");await navigator.clipboard.writeText(e).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})}))}},mounted(){const e=R.Z.now()-this.note.createdAt>=3600?3600:60;this.refreshTimer=setInterval((()=>this.refreshCounter++),1e3*e)},unmounted(){clearInterval(this.refreshTimer)}};var N=s(1639),q=s(8879),Z=s(6362),j=s(3246),M=s(490),z=s(1233),U=s(2857),L=s(926),W=s(7743),Q=s(2146),V=s(9984),K=s.n(V);const H=(0,N.Z)(O,[["render",w],["__scopeId","data-v-37613c90"]]),Y=H;K()(O,"components",{QBtn:q.Z,QMenu:Z.Z,QList:j.Z,QItem:M.Z,QItemSection:z.Z,QIcon:U.Z,QSeparator:L.Z,QDialog:W.Z}),K()(O,"directives",{ClosePopup:Q.Z})},8993:(e,t,s)=>{"use strict";s.d(t,{Z:()=>B});var n=s(9835),u=s(6970),o=s(1957);const i={class:"sign-in-dialog"},r={class:"title"},a={style:{"font-size":"24px"}},c={class:"content"},l=["innerHTML"];function D(e,t,s,D,d,p){const h=(0,n.up)("BaseIcon"),m=(0,n.up)("q-btn"),g=(0,n.up)("q-dialog"),F=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.iD)("div",{class:(0,u.C_)(["post-actions",s.flavor])},[(0,n._)("div",{class:"action-item comment",onClick:t[0]||(t[0]=(0,o.iM)(((...e)=>p.comment&&p.comment(...e)),["stop"]))},[(0,n.Wm)(h,{icon:"comment"}),(0,n._)("span",null,(0,u.zw)(p.stats.comments||""),1)]),(0,n._)("div",{class:"action-item repost",onClick:t[1]||(t[1]=(0,o.iM)(((...e)=>p.repost&&p.repost(...e)),["stop"]))},[(0,n.Wm)(h,{icon:"repost"}),(0,n._)("span",null,(0,u.zw)(p.stats.shares||""),1)]),(0,n._)("div",{class:(0,u.C_)(["action-item like",{active:p.liked}]),onClick:t[2]||(t[2]=(0,o.iM)(((...e)=>p.like&&p.like(...e)),["stop"]))},[(0,n.Wm)(h,{icon:p.liked?"like_filled":"like"},null,8,["icon"]),(0,n._)("span",null,(0,u.zw)(p.stats.reactions||""),1)],2),(0,n.Wm)(g,{modelValue:d.metadataDialog,"onUpdate:modelValue":t[4]||(t[4]=e=>d.metadataDialog=e)},{default:(0,n.w5)((()=>[(0,n._)("div",i,[(0,n.wy)((0,n.Wm)(m,{icon:"close",size:"md",class:"icon",flat:"",round:""},null,512),[[F]]),(0,n._)("div",r,[(0,n._)("text",a,[(0,n.Uk)(" raw event data "),(0,n.Wm)(m,{icon:"bookmarks",size:"md",flat:"",round:"",color:"primary",onClick:t[3]||(t[3]=e=>p.copystr(d.CopyStr))})])]),(0,n._)("div",c,[(0,n._)("div",{innerHTML:d.noteStr},null,8,l)])])])),_:1},8,["modelValue"])],2)}var d=s(7664),p=s(6166),h=s(734),m=s(3099),g=s(1153),F=s(5155),f=s(4520);const b={name:"PostActions",components:{BaseIcon:d.Z},emits:["comment","repost"],data(){return{metadataDialog:!1,noteStr:"",CopyStr:""}},props:{note:{type:Object,required:!0},flavor:{type:String,default:"list"}},setup(){return{app:(0,m.q)(),stat:(0,h.a)(),nostr:(0,p.D)()}},computed:{stats(){return this.stat.get(this.note.id)},ourReactions(){return this.nostr.getOurReactionsTo(this.note.id)},liked(){return this.ourReactions.length>0}},methods:{info(){this.metadataDialog=!0;let e=(0,f.Sk)(this.nostr.getNote(this.note.id)),t=JSON.stringify(this.nostr.getNote(this.note.id));console.log("str----",this.nostr.getNote(this.note.id)),this.noteStr=e,this.CopyStr=t},comment(){"list"===this.flavor?this.app.createPost({ancestor:this.note.id}):this.$emit("comment")},async repost(){if("list"===this.flavor){const e=g.Z.share(this.note,this.app.myPubkey).build();if(console.log("shareevent-----",e),!await this.app.signEvent(e))return;await this.nostr.publish(e)||this.$q.notify({message:(0,F.$t)("Failed to publish reaction"),color:"negative"})}else this.$emit("repost")},like(){return this.liked?this.deleteLike():this.publishLike()},async copystr(e){e&&(console.log("str----",e),await navigator.clipboard.writeText(e).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})})))},async publishLike(){const e=g.Z.reaction(this.note,this.app.myPubkey).build();await this.app.signEvent(e)&&(await this.nostr.publish(e)||this.$q.notify({message:(0,F.$t)("Failed to publish reaction"),color:"negative"}))},async deleteLike(){const e=this.ourReactions.map((e=>e.id)),t=g.Z["delete"](this.app.myPubkey,e).build();await this.app.signEvent(t)&&(await this.nostr.publish(t)||this.$q.notify({message:(0,F.$t)("Failed to delete reaction"),color:"negative"}))}}};var y=s(1639),C=s(7743),E=s(8879),v=s(2146),k=s(9984),w=s.n(k);const A=(0,y.Z)(b,[["render",D],["__scopeId","data-v-66598c19"]]),B=A;w()(b,"components",{QDialog:C.Z,QBtn:E.Z}),w()(b,"directives",{ClosePopup:v.Z})},8500:(e,t,s)=>{"use strict";s.d(t,{Z:()=>Y});var n=s(9835);function u(e,t,s,u,o,i){const r=(0,n.up)("BaseMarkdown");return(0,n.wg)(),(0,n.j4)(r,{content:i.content},null,8,["content"])}var o=s(6970),i=s(1957);const r={ref:"src",class:"hidden break-word-wrap"},a={ref:"append",class:"hidden break-word-wrap"},c=["innerHTML"];function l(e,t,s,u,l,D){const d=(0,n.up)("q-btn"),p=(0,n.up)("BaseInvoice");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",r,[(0,n.WI)(e.$slots,"default")],512),(0,n._)("div",a,[(0,n.WI)(e.$slots,"append")],512),(0,n._)("div",{innerHTML:l.html,ref:"html",class:(0,o.C_)(["break-word-wrap dynamic-content markdown",s.longForm?"long-form":""]),onClick:t[0]||(t[0]=(...e)=>D.handleClicks&&D.handleClicks(...e))},null,10,c),s.longForm?((0,n.wg)(),(0,n.j4)(d,{key:0,id:"long-form-button",dense:"",outline:"",rounded:"",color:"accent",class:"text-weight-light q-ma-sm justify-between",style:{"letter-spacing":".1rem","justify-content":"space-between"},label:"show full post",onClick:(0,i.iM)(D.expand,["stop"])},null,8,["onClick"])):(0,n.kq)("",!0),l.invoice?((0,n.wg)(),(0,n.j4)(p,{key:1,invoice:l.invoice},null,8,["invoice"])):(0,n.kq)("",!0)],64)}s(9665);var D=s(7678),d=s.n(D),p=s(1994),h=s.n(p),m=s(4879),g=s.n(m),F=s(7984),f=s.n(F),b=s(651),y=s.n(b),C=s(8621);const E=e=>((0,n.dD)("data-v-467e0116"),e=e(),(0,n.Cn)(),e),v={style:{border:"3px double var(--q-accent)",padding:".5rem",margin:".3rem"}},k={class:"flex row no-wrap justify-between full-width"},w=E((()=>(0,n._)("div",{class:"text-bold",style:{"font-size":"1.1rem"}},"lightning invoice",-1))),A={key:0},B={key:1},_={class:"flex row no-wrap justify-start q-pt-xs",style:{gap:".5rem"}},T={key:0,class:"break-word-wrap",style:{"overflow-y":"auto","max-height":"170px"}},I={ref:"qr",style:{"object-fit":"cover","min-height":"200px","min-width":"200px"}};function S(e,t,s,u,r,a){const c=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.iD)("div",v,[(0,n._)("div",k,[(0,n._)("div",{style:(0,o.j5)([{"font-size":".8rem"},r.showQr?"":"width: 60%"]),class:"flex column"},[w,a.description?((0,n.wg)(),(0,n.iD)("div",A,"desc: "+(0,o.zw)(a.description),1)):(0,n.kq)("",!0),(0,n._)("div",null,"amount: "+(0,o.zw)(a.amount?`${a.amount} sats`:"none specified"),1),(0,n._)("div",null,"created date: "+(0,o.zw)(a.created),1),a.expires?((0,n.wg)(),(0,n.iD)("div",B,"expires date: "+(0,o.zw)(a.expires),1)):(0,n.kq)("",!0),(0,n._)("div",_,[(0,n.Wm)(c,{label:"show qr",icon:"qr_code_2",outline:"",size:"sm",dense:"",unelevated:"",class:"q-pr-xs",onClick:(0,i.iM)(a.renderQr,["stop"])},null,8,["onClick"])])],4),(0,n._)("div",{class:"flex column",style:(0,o.j5)([{"font-size":".7rem",padding:".4rem"},r.showQr?"":"width: 40%"])},[r.showQr?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",T,(0,o.zw)(a.request),1)),(0,n.wy)((0,n._)("img",I,null,512),[[i.F8,r.showQr]])],4)])])}const x={name:"BaseInvoice",props:{invoice:{type:Object,required:!0}},components:{},data(){return{showQr:!1}},computed:{includesAmount(){return"separator"!==this.invoice.sections[2].name},amount(){return this.includesAmount?this.invoice.sections[2].value/1e3:null},description(){return this.includesAmount?this.invoice.sections[6].value:this.invoice.sections[5].value},created(){return this.includesAmount?parseInt(this.invoice.sections[4].value):parseInt(this.invoice.sections[3].value)},expires(){let e=this.includesAmount?parseInt(this.invoice.sections[8].value):parseInt(this.invoice.sections[7].value),t=parseInt(e);return isNaN(t)?null:this.created+t},request(){return this.invoice.paymentRequest}},mounted(){},methods:{renderQr(e){this.showQr=!0},toSvgString(e,t){let s="#FFFFFF",n="#000000";if(t<0)throw new RangeError("Border must be non-negative");let u=[];for(let r=0;r<e.size;r++)for(let s=0;s<e.size;s++)e.getModule(s,r)&&u.push(`M${s+t},${r+t}h1v1h-1z`);let o=`<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 ${e.size+2*t} ${e.size+2*t}" stroke="none">\n\t<rect width="100%" height="100%" fill="${s}"/>\n\t<path d="${u.join(" ")}" fill="${n}"/>\n</svg>\n`,i=new Blob([o],{type:"image/svg+xml"});return URL.createObjectURL(i)}}};var R=s(1639),$=s(8879),P=s(9984),O=s.n(P);const N=(0,R.Z)(x,[["render",S],["__scopeId","data-v-467e0116"]]),q=N;O()(x,"components",{QBtn:$.Z});const Z=/\bhttps:\/\/(www.|m.)?youtu(be.com|.be)\/(watch\?v=|shorts\/)?(?<v>[a-zA-Z0-9_-]{11})(&t=(?<s>[0-9]+)s)?/,j=d()({html:!1,breaks:!0,linkify:!0});j.use(h()).use(g()).use(f()).use(y()).use((e=>{const t=e.renderer.rules.link_open||function(e,t,s,n,u){return u.renderToken(e,t,s)};e.core.ruler.before("normalize","auto-imager",(e=>{e.src=e.src.replace(/https?:[^ \n]+/g,(e=>{if(e){let t=e.split("?")[0];if(t.endsWith(".gif")||t.endsWith(".png")||t.endsWith(".jpeg")||t.endsWith(".jpg")||t.endsWith(".svg")||t.endsWith(".mp4")||t.endsWith(".webm")||t.endsWith(".ogg"))return`![](${e})`}return e}))})),e.renderer.rules.image=(e,t)=>{let s=e[t].attrs[[e[t].attrIndex("src")]][1],n=s.split("?")[0];return n.endsWith(".gif")||n.endsWith(".png")||n.endsWith(".jpeg")||n.endsWith(".jpg")||n.endsWith(".svg")?`<img src="${s}" loading='lazy' style="max-width: 90%; max-height: 50vh;">`:n.endsWith(".mp4")||n.endsWith(".webm")||n.endsWith(".ogg")?`<video src="${s}" controls style="max-width: 90%; max-height: 50vh;"></video>`:void 0},e.renderer.rules.link_open=function(e,s,n,u,o){const i=e[s],r=i.attrIndex("href"),a=i.attrs[r][1].match(Z);if(a){const t=e[s+1];t&&"text"===t.type&&(t.content="");let n=`https://www.youtube.com/embed/${a.groups.v}`;return a.groups.s&&(n+=`?start=${a.groups.s}`),`<iframe anonymous async style="height: 15rem; width: 90%; object-fit: cover;" src="${n}"\n          title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>\n          </iframe>`}const c=/^https?:\/\//;if(c.test(i.attrs[r][1])){let t=i.attrIndex("target");t<0?e[s].attrPush(["target","_blank"]):e[s].attrs[t][1]="_blank"}return t(e,s,n,u,o)}})),j.linkify.tlds(["onion","eth"],!0).add("bitcoin:",null).add("lightning:",null).add("http:",{validate(e,t,s){const n=e.slice(t);return s.re.http||(s.re.http=new RegExp("^\\/\\/"+s.re.src_auth+s.re.src_host_port_strict+s.re.src_path,"i")),s.re.http.test(n)?n.match(s.re.http)[0].length:0},normalize(e,t){if(t.__text_cache__.length<150||e.text<23)return;let s=new URL(e.url),n=s.host;if((s.pathname+s.search+s.hash).length>10){let t=e.text.slice(-7);"/"===t[0]&&(t=t.slice(1)),n+=`/…/${t}`}e.text=n}}).set({fuzzyEmail:!1});const M={name:"BaseMarkdown",emits:["expand","resized"],components:{BaseInvoice:q},data(){return{html:"",invoice:null}},props:{content:{type:String,required:!0},longForm:{type:Boolean,default:!1}},computed:{parsedContent(){const e=/\b(?<i>(lnbc|LNBC)[0-9a-zA-Z]*1[0-9a-zA-Z]+)\b/g,t=(e,t)=>{try{return this.invoice=C.decode(e),""}catch(s){return console.log("invoice parsing error",s),e}};let s=this.content.replace(e,t);return s}},mounted(){this.render()},updated(){this.render()},watch:{content(){this.render()}},methods:{render(){this.html=j.render(this.parsedContent)+this.$refs.append.innerHTML,this.$refs.html.querySelectorAll("img").forEach((e=>{e.addEventListener("click",(t=>{t.stopPropagation(),document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():e.requestFullscreen(),this.$emit("resized")})),e.addEventListener("load",(e=>{this.$emit("resized")}))}))},handleClicks(e){let{target:t}=e;if(t&&t.matches(".dynamic-content a:not([href*='://'])")&&t.href){const{altKey:s,ctrlKey:n,metaKey:u,shiftKey:o,button:i,defaultPrevented:r}=e;if(u||s||n||o)return;if(r)return;if(void 0!==i&&0!==i)return;if(t&&t.getAttribute){const e=t.getAttribute("target");if(/\b_blank\b/i.test(e))return}const a=new URL(t.href),c=a.pathname;window.location.pathname!==c&&e.preventDefault&&(e.preventDefault(),e.stopPropagation(),this.$router.push(c))}else t&&t.matches(".dynamic-content a[href*='://']")&&t.href&&e.stopPropagation()},expand(e){this.$emit("expand")}}},z=(0,R.Z)(M,[["render",l]]),U=z;O()(M,"components",{QBtn:$.Z});var L=s(6166),W=s(7498),Q=s(4520),V=s(2929);const K={name:"PostRenderer",components:{BaseMarkdown:U},mixins:[V.Z],props:{note:{type:Object,required:!0}},setup(){return{nostr:(0,L.D)()}},computed:{content(){let e=this.note.content;return e=this.replaceBech32Refs(e),e=this.replaceTagRefs(e),e}},methods:{replaceTagRefs(e){return e?e.replace(/#\[([0-9]+)]/gi,((e,t)=>{const s=this.note.tags[t];if(!s)return e;const n=this.renderTag(s);return n||e})):e},renderTag(e){switch(e.type){case W.Qy.PUBKEY:{const t=(0,Q.jm)(e.ref,"npub");return this.renderProfileRef(t)}case W.Qy.EVENT:{const t=(0,Q.jm)(e.ref,"note");return this.renderNoteRef(t)}}},replaceBech32Refs(e){return e?e.replace(/@((npub|note)[a-z0-9]{59})/gi,((e,t,s)=>{switch(s){case"npub":return this.renderProfileRef(t);case"note":return this.renderNoteRef(t);default:return e}})):e},renderProfileRef(e){const t=this.nostr.getProfile((0,Q.FX)(e)),s=t?t.name:(0,Q.Ku)(e);if(!e||!s)return;const n=this.linkToProfile(e);return`[${s}](${n})`},renderNoteRef(e){if(!e)return;const t=(0,Q.Ku)(e),s=this.linkToThread(e);return`[${t}](${s})`}}},H=(0,R.Z)(K,[["render",u]]),Y=H},7573:(e,t,s)=>{"use strict";s.d(t,{Z:()=>B});var n=s(9835),u=s(6970),o=s(1957);const i={class:"relative-position"},r={class:"searchbox-wrapper"},a={class:"searchbox-icon"},c={class:"searchbox-input"},l=["placeholder"],D={key:0,class:"searchbox-results"},d={key:0,class:"query-example"},p=(0,n._)("b",null,"npub…",-1),h=(0,n._)("b",null,"[user]@domain",-1),m=(0,n._)("b",null,"name",-1);function g(e,t,s,g,F,f){const b=(0,n.up)("BaseIcon"),y=(0,n.up)("q-form"),C=(0,n.up)("UserCard");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n._)("div",{class:(0,u.C_)(["searchbox",{focused:F.focused}])},[(0,n._)("div",r,[(0,n._)("div",a,[(0,n.Wm)(b,{icon:"search"})]),(0,n._)("div",c,[(0,n.Wm)(y,{onSubmit:(0,o.iM)(f.search,["stop"])},{default:(0,n.w5)((()=>[(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>F.query=e),ref:"input",type:"text",placeholder:e.$t("Search profiles"),onFocus:t[1]||(t[1]=(...e)=>f.toggleFocus&&f.toggleFocus(...e)),onBlur:t[2]||(t[2]=(...e)=>f.toggleFocus&&f.toggleFocus(...e)),onKeyup:[t[3]||(t[3]=(...e)=>f.search&&f.search(...e)),t[4]||(t[4]=(0,o.D2)((t=>e.$refs.input.blur()),["esc"]))]},null,40,l),[[o.nr,F.query]])])),_:1},8,["onSubmit"])])])],2),(0,n.Wm)(o.uT,{name:"fade"},{default:(0,n.w5)((()=>[F.focused?((0,n.wg)(),(0,n.iD)("div",D,[F.results.length?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",d,[p,(0,n.Uk)(" or "),h,(0,n.Uk)(" or "),m])),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(F.results,(t=>((0,n.wg)(),(0,n.j4)(C,{key:t,pubkey:t,class:"searchbox-results-item",clickable:"",onMousedown:s=>e.goToProfile(t)},null,8,["pubkey","onMousedown"])))),128))])):(0,n.kq)("",!0)])),_:1})])}var F=s(7664),f=s(7175),b=s(5198),y=s(2929);const C={name:"SearchBox",mixins:[y.Z],components:{UserCard:b.Z,BaseIcon:F.Z},setup(){return{provider:new f.Z}},data(){return{focused:!1,query:"",results:[]}},methods:{toggleFocus(){this.focused=!this.focused},async search(){this.query?this.results=(await this.provider.queryProfiles(this.query)).slice(0,200):this.results=[]}}};var E=s(1639),v=s(8326),k=s(9984),w=s.n(k);const A=(0,E.Z)(C,[["render",g]]),B=A;w()(C,"components",{QForm:v.Z})},7328:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var n=s(9835),u=s(6970);function o(e,t,s,o,i,r){return o.app.isSignedIn?((0,n.wg)(),(0,n.iD)("button",{key:0,class:(0,u.C_)(["btn btn-sm",{"btn-primary":!r.isFollowing}]),onClick:t[0]||(t[0]=(...e)=>r.toggleFollow&&r.toggleFollow(...e))},(0,u.zw)(e.$t(r.isFollowing?"Unfollow":"Follow")),3)):(0,n.kq)("",!0)}s(9665);var i=s(6166),r=s(3099),a=s(1153),c=s(5155);const l={name:"FollowButton",props:{pubkey:{type:String,required:!0}},setup(){return{app:(0,r.q)(),nostr:(0,i.D)()}},computed:{contacts(){return this.nostr.getContacts(this.app.myPubkey)},isFollowing(){return this.contacts?.length&&this.contacts.find((e=>e.pubkey===this.pubkey))}},methods:{async updateContacts(e){const t=a.Z.contacts(this.app.myPubkey,e.map((e=>e.pubkey))).build();await this.app.signEvent(t)&&(await this.nostr.publish(t)||this.$q.notify({message:(0,c.$t)("Failed to update followers"),color:"negative"}))},toggleFollow(){return this.isFollowing?this.unfollow():this.follow()},async follow(){const e=[].concat(this.contacts||[]);e.push({pubkey:this.pubkey}),await this.updateContacts(e)},async unfollow(){const e=[].concat(this.contacts||[]),t=e.findIndex((e=>e.pubkey===this.pubkey));e.splice(t,1),await this.updateContacts(e)}}};var D=s(1639);const d=(0,D.Z)(l,[["render",o]]),p=d},5501:(e,t,s)=>{"use strict";s.d(t,{Z:()=>y});var n=s(9835),u=s(6970);const o=["src"];function i(e,t,s,i,r,a){const c=(0,n.up)("Identicon"),l=(0,n.up)("q-avatar");return(0,n.wg)(),(0,n.j4)(l,{class:(0,u.C_)({"cursor-pointer":s.clickable}),size:s.size,onClick:t[1]||(t[1]=t=>s.clickable&&e.goToProfile(s.pubkey))},{default:(0,n.w5)((()=>[a.hasAvatar&&!r.avatarFetchFailed?((0,n.wg)(),(0,n.iD)("img",{key:0,src:a.avatarUrl,ref:"image",loading:"lazy",onErrorOnce:t[0]||(t[0]=(...e)=>a.onFetchFailed&&a.onFetchFailed(...e))},null,40,o)):(0,n.kq)("",!0),!a.hasAvatar||r.avatarFetchFailed?((0,n.wg)(),(0,n.j4)(c,{key:1,pubkey:s.pubkey},null,8,["pubkey"])):(0,n.kq)("",!0)])),_:1},8,["class","size"])}function r(e,t,s,u,o,i){return(0,n.wg)(),(0,n.iD)("svg")}var a=s(6932);const c={name:"Identicon",props:{pubkey:{type:String,required:!0}},watch:{pubkey(e){(0,a.Fz)(this.$el,e)}},mounted(){(0,a.Fz)(this.$el,this.pubkey)}};var l=s(1639);const D=(0,l.Z)(c,[["render",r]]),d=D;var p=s(2929),h=s(6166);const m={mixins:[p.Z],components:{Identicon:d},props:{pubkey:{type:String,required:!0},clickable:{type:Boolean,default:!1},size:{type:String,default:""}},data(){return{avatarFetchFailed:!1}},setup(){return{nostr:(0,h.D)()}},computed:{hasAvatar(){return!!this.avatarUrl},avatarUrl(){return this.nostr.getProfile(this.pubkey)?.picture}},methods:{onFetchFailed(){this.avatarFetchFailed=!0}}};var g=s(1357),F=s(9984),f=s.n(F);const b=(0,l.Z)(m,[["render",i]]),y=b;f()(m,"components",{QAvatar:g.Z})},5198:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var n=s(9835);const u={class:"user-card"};function o(e,t,s,o,i,r){const a=(0,n.up)("UserAvatar"),c=(0,n.up)("UserName"),l=(0,n.up)("FollowButton");return(0,n.wg)(),(0,n.iD)("div",u,[(0,n.Wm)(a,{pubkey:s.pubkey,clickable:s.clickable},null,8,["pubkey","clickable"]),(0,n.Wm)(c,{pubkey:s.pubkey,clickable:s.clickable,class:"username","two-line":"","show-verified":""},null,8,["pubkey","clickable"]),s.followButton?((0,n.wg)(),(0,n.j4)(l,{key:0,pubkey:s.pubkey},null,8,["pubkey"])):(0,n.kq)("",!0)])}var i=s(5501),r=s(9715),a=s(7328);const c={name:"UserCard",components:{FollowButton:a.Z,UserName:r.Z,UserAvatar:i.Z},props:{pubkey:{type:String,required:!0},clickable:{type:Boolean,default:!1},followButton:{type:Boolean,default:!1}}};var l=s(1639);const D=(0,l.Z)(c,[["render",o],["__scopeId","data-v-0608d065"]]),d=D},9715:(e,t,s)=>{"use strict";s.d(t,{Z:()=>S});var n=s(9835),u=s(6970);const o={class:"name"},i={key:0};function r(e,t,s,r,a,c){const l=(0,n.up)("Bech32Label"),D=(0,n.up)("Nip05Badge");return(0,n.wg)(),(0,n.iD)("span",{class:(0,u.C_)(["username",{"two-line":s.twoLine,clickable:s.clickable,header:s.header,wrap:s.wrap}])},[(0,n._)("span",o,[(0,n._)("a",{onClick:t[0]||(t[0]=t=>s.clickable&&e.goToProfile(s.pubkey))},[c.profile?.name?((0,n.wg)(),(0,n.iD)("span",i,(0,u.zw)(c.profile.name),1)):((0,n.wg)(),(0,n.j4)(l,{key:1,prefix:"npub",hex:s.pubkey},null,8,["hex"]))]),s.showVerified?((0,n.wg)(),(0,n.j4)(D,{key:0,pubkey:s.pubkey,size:s.header?"18px":"14px",class:"verified-badge"},null,8,["pubkey","size"])):(0,n.kq)("",!0)]),s.twoLine&&c.profile?.name?((0,n.wg)(),(0,n.j4)(l,{key:0,prefix:"npub",hex:s.pubkey,class:"pubkey"},null,8,["hex"])):(0,n.kq)("",!0)],2)}const a={key:0,class:"nip05-badge"},c={class:"nip05-badge-text"};function l(e,t,s,o,i,r){const l=(0,n.up)("q-tooltip"),D=(0,n.up)("q-icon");return i.verified?((0,n.wg)(),(0,n.iD)("span",a,[(0,n.Wm)(D,{name:"verified",size:s.size,color:"primary"},{default:(0,n.w5)((()=>[(0,n.Wm)(l,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,u.zw)(e.$t("NIP05 verified")),1)])),_:1})])),_:1},8,["size"]),(0,n._)("span",c,(0,u.zw)(r.nip05),1)])):(0,n.kq)("",!0)}var D=s(6166);const d={name:"Nip05Badge",props:{pubkey:{type:String,required:!0},size:{type:String,default:"14px"}},setup(){return{nostr:(0,D.D)()}},data(){return{verified:!1}},computed:{profile(){return this.nostr.getProfile(this.pubkey)},nip05(){if(this.profile?.nip05.url)return this.profile.nip05.url.split("@").filter((e=>"_"!==e&&e?.toLowerCase()!==this.profile.name?.toLowerCase())).join("@")}},watch:{async profile(){this.verified=await(this.profile?.isNip05Verified())}},async mounted(){this.verified=await(this.profile?.isNip05Verified())}};var p=s(1639),h=s(2857),m=s(6858),g=s(9984),F=s.n(g);const f=(0,p.Z)(d,[["render",l],["__scopeId","data-v-532ce941"]]),b=f;F()(d,"components",{QIcon:h.Z,QTooltip:m.Z});const y={class:"bech32"},C={class:"bech32-prefix"},E={class:"bech32-value"};function v(e,t,s,o,i,r){return(0,n.wg)(),(0,n.iD)("span",y,[(0,n._)("span",C,(0,u.zw)(r.computedPrefix),1),(0,n._)("span",E,(0,u.zw)(r.value),1)])}var k=s(4520);const w={name:"Bech32Label",props:{bech32:{type:String,default:null},hex:{type:String,default:null},prefix:{type:String,default:""}},computed:{computedPrefix(){return this.bech32?this.bech32.substring(0,4):this.prefix},value(){const e=this.bech32?this.bech32.substring(4):(0,k.jm)(this.hex,"");return(0,k.Ku)(e)}}},A=(0,p.Z)(w,[["render",v],["__scopeId","data-v-d0e11f58"]]),B=A;var _=s(2929);const T={mixins:[_.Z],components:{Bech32Label:B,Nip05Badge:b},props:{pubkey:{type:String,required:!0},clickable:{type:Boolean,default:!1},twoLine:{type:Boolean,default:!1},wrap:{type:Boolean,default:!1},header:{type:Boolean,default:!1},showVerified:{type:Boolean,default:!1}},setup(){return{nostr:(0,D.D)()}},computed:{profile(){return this.nostr.getProfile(this.pubkey)}}},I=(0,p.Z)(T,[["render",r],["__scopeId","data-v-4ca90600"]]),S=I},8037:(e,t,s)=>{var n={"./back.vue":[2840,2840],"./bookmarks.vue":[9513,9513],"./calendar.vue":[5863,3965],"./close.vue":[4266,4266],"./comment.vue":[8204,8204],"./copy.vue":[4768,4768],"./editTweet.vue":[4562,4562],"./emoji.vue":[3664,3664],"./explore.vue":[8882,8882],"./gif.vue":[2782,2782],"./graph.vue":[8404,8404],"./hamburger.vue":[1561,1561],"./help.vue":[1607,1607],"./home.vue":[2405,2405],"./image.vue":[1302,1302],"./key.vue":[2605,2605],"./left.vue":[6062,6062],"./like.vue":[7235,7235],"./like_filled.vue":[6084,6084],"./link.vue":[9714,9714],"./lists.vue":[2270,2270],"./messages.vue":[6476,6476],"./moments.vue":[3012,3012],"./more.vue":[9833,9833],"./notifications.vue":[8023,8023],"./pen.vue":[4935,4935],"./profile.vue":[4909,4909],"./repost.vue":[5710,5710],"./right.vue":[5941,5941],"./search.vue":[5267,5267],"./settings.vue":[3995,3995],"./share.vue":[9726,9726],"./smile.vue":[1210,1210],"./tick.vue":[4107,4107],"./topics.vue":[4962,5863],"./trash.vue":[8395,8395],"./twitter.vue":[6092,6092]};function u(e){if(!s.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],u=t[0];return s.e(t[1]).then((()=>s(u)))}u.keys=()=>Object.keys(n),u.id=8037,e.exports=u},5856:()=>{},6601:()=>{}},t={};function s(n){var u=t[n];if(void 0!==u)return u.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=e,(()=>{var e=[];s.O=(t,n,u,o)=>{if(!n){var i=1/0;for(l=0;l<e.length;l++){for(var[n,u,o]=e[l],r=!0,a=0;a<n.length;a++)(!1&o||i>=o)&&Object.keys(s.O).every((e=>s.O[e](n[a])))?n.splice(a--,1):(r=!1,o<i&&(i=o));if(r){e.splice(l--,1);var c=u();void 0!==c&&(t=c)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,u,o]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(n,u){if(1&u&&(n=this(n)),8&u)return n;if("object"===typeof n&&n){if(4&u&&n.__esModule)return n;if(16&u&&"function"===typeof n.then)return n}var o=Object.create(null);s.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var r=2&u&&n;"object"==typeof r&&!~e.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((e=>i[e]=()=>n[e]));return i["default"]=()=>n,s.d(o,i),o}})(),(()=>{s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[]))})(),(()=>{s.u=e=>"js/"+e+"."+{1210:"351b6a4d",1302:"4ea76635",1561:"d5754ede",1607:"47b0825b",2270:"7725ea3c",2405:"425a8755",2605:"c27e2b65",2613:"2731314e",2782:"c568bb21",2840:"d59aec6b",3012:"b6d965ff",3664:"046a78ae",3965:"8ea3c375",3995:"eff6a0d2",4107:"d6207984",4266:"47f584a3",4426:"85570c04",4562:"8f7a92e4",4768:"d24c84bc",4909:"7ac3b25c",4935:"a2231032",5267:"971fcb09",5710:"6a5dd099",5863:"ec2f153b",5941:"d6ea279d",5970:"5e751030",6062:"9b7b2321",6084:"7038574b",6092:"a5696b41",6240:"421c1097",6476:"e4df2ba7",6645:"d506bdd5",6678:"b52f6f56",6745:"a1851db8",6938:"4de545fb",7235:"4ede04fa",7691:"4a91d8a2",7890:"584f54aa",8023:"078bf12f",8204:"08311b1c",8395:"37e9ef5c",8404:"ae3018ec",8729:"5909a011",8882:"c91cb55b",9288:"f789c29a",9513:"e1152aee",9714:"cf19b8a8",9726:"a417f6de",9833:"b26cc6a4"}[e]+".js"})(),(()=>{s.miniCssF=e=>"css/"+e+"."+{2613:"ffc28232",4426:"b1686b48",5970:"e34dc78c",6240:"279a4195",6645:"a9ede23b",6678:"1a653d26",6745:"2c412bf7",6938:"35740548",7691:"aeb8ebd6",7890:"ef7a8c62",8729:"e6edd6f7",9288:"80f4de1a"}[e]+".css"})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="FreeFromWeb:";s.l=(n,u,o,i)=>{if(e[n])e[n].push(u);else{var r,a;if(void 0!==o)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var D=c[l];if(D.getAttribute("src")==n||D.getAttribute("data-webpack")==t+o){r=D;break}}r||(a=!0,r=document.createElement("script"),r.charset="utf-8",r.timeout=120,s.nc&&r.setAttribute("nonce",s.nc),r.setAttribute("data-webpack",t+o),r.src=n),e[n]=[u];var d=(t,s)=>{r.onerror=r.onload=null,clearTimeout(p);var u=e[n];if(delete e[n],r.parentNode&&r.parentNode.removeChild(r),u&&u.forEach((e=>e(s))),t)return t(s)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=d.bind(null,r.onerror),r.onload=d.bind(null,r.onload),a&&document.head.appendChild(r)}}})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{s.p="/FreeFromWeb/"})(),(()=>{if("undefined"!==typeof document){var e=(e,t,s,n,u)=>{var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var i=s=>{if(o.onerror=o.onload=null,"load"===s.type)n();else{var i=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.href||t,a=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");a.code="CSS_CHUNK_LOAD_FAILED",a.type=i,a.request=r,o.parentNode.removeChild(o),u(a)}};return o.onerror=o.onload=i,o.href=t,s?s.parentNode.insertBefore(o,s.nextSibling):document.head.appendChild(o),o},t=(e,t)=>{for(var s=document.getElementsByTagName("link"),n=0;n<s.length;n++){var u=s[n],o=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(o===e||o===t))return u}var i=document.getElementsByTagName("style");for(n=0;n<i.length;n++){u=i[n],o=u.getAttribute("data-href");if(o===e||o===t)return u}},n=n=>new Promise(((u,o)=>{var i=s.miniCssF(n),r=s.p+i;if(t(i,r))return u();e(n,r,null,u,o)})),u={2143:0};s.f.miniCss=(e,t)=>{var s={2613:1,4426:1,5970:1,6240:1,6645:1,6678:1,6745:1,6938:1,7691:1,7890:1,8729:1,9288:1};u[e]?t.push(u[e]):0!==u[e]&&s[e]&&t.push(u[e]=n(e).then((()=>{u[e]=0}),(t=>{throw delete u[e],t})))}}})(),(()=>{var e={2143:0};s.f.j=(t,n)=>{var u=s.o(e,t)?e[t]:void 0;if(0!==u)if(u)n.push(u[2]);else{var o=new Promise(((s,n)=>u=e[t]=[s,n]));n.push(u[2]=o);var i=s.p+s.u(t),r=new Error,a=n=>{if(s.o(e,t)&&(u=e[t],0!==u&&(e[t]=void 0),u)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;r.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",r.name="ChunkLoadError",r.type=o,r.request=i,u[1](r)}};s.l(i,a,"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var u,o,[i,r,a]=n,c=0;if(i.some((t=>0!==e[t]))){for(u in r)s.o(r,u)&&(s.m[u]=r[u]);if(a)var l=a(s)}for(t&&t(n);c<i.length;c++)o=i[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(l)},n=globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=s.O(void 0,[4736],(()=>s(2019)));n=s.O(n)})();