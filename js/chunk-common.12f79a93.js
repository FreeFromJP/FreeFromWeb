"use strict";(globalThis["webpackChunkFreeFromWeb"]=globalThis["webpackChunkFreeFromWeb"]||[]).push([[3064],{9944:(t,e,o)=>{function n(t=100){return{data(){return{displayPriority:0}},mounted(){this.runDisplayPriority()},methods:{runDisplayPriority(){const e=()=>{requestAnimationFrame((()=>{this.displayPriority++,this.displayPriority<t&&e()}))};e()},defer(t){return this.displayPriority>=t}}}}o.d(e,{Z:()=>n})},396:(t,e,o)=>{o.d(e,{Z:()=>a});var n=o(4520);const s=new Set,a=s;s.isBot=s.has.bind(s),s.add=t=>Set.prototype.add.call(s,(0,n.FX)(t))},3027:(t,e,o)=>{o.d(e,{Z:()=>u});var n=o(9835);const s={ref:"button",class:"async-load-button"};function a(t,e,o,a,r,i){const c=(0,n.up)("q-btn");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(c,{loading:t.loading,label:t.$t(t.noMore?t.labelNoMore:t.label),onClick:t.load,size:"md",flat:""},null,8,["loading","label","onClick"])],512)}const r=(0,n.aZ)({name:"AsyncLoadButton",emits:["loading","loaded"],props:{loadFn:{type:Function,required:!0},label:{type:String,default:"Load more"},labelNoMore:{type:String,default:"No more items. Try again?"},autoload:{type:Boolean,default:!1}},data(){return{loading:!1,noMore:!1,observer:null}},methods:{async load(){if(this.loading)return;this.loading=!0,this.$emit("loading");const t=await this.loadFn();this.noMore=!t||!t.length,this.loading=!1,this.$emit("loaded",t)}},mounted(){this.autoload&&(this.observer=new IntersectionObserver(this.load.bind(this),{root:null,threshold:.5}),this.observer.observe(this.$refs.button))},unmounted(){this.observer&&this.observer.disconnect()}});var i=o(1639),c=o(8879),l=o(9984),d=o.n(l);const p=(0,i.Z)(r,[["render",a],["__scopeId","data-v-25cf639a"]]),u=p;d()(r,"components",{QBtn:c.Z})},6401:(t,e,o)=>{o.d(e,{Z:()=>y});var n=o(9835),s=o(6970);const a={key:0,class:"list-placeholder"},r={key:1};function i(t,e,o,i,c,l){const d=(0,n.up)("q-spinner");return o.count?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",a,[o.loading?((0,n.wg)(),(0,n.j4)(d,{key:0,size:"sm"})):((0,n.wg)(),(0,n.iD)("p",r,(0,s.zw)(t.$t(o.label)),1))]))}const c={name:"ListPlaceholder",props:{count:{type:Number,default:0},loading:{type:Boolean,default:!1},label:{type:String,default:"Nothing here."}}};var l=o(1639),d=o(3940),p=o(9984),u=o.n(p);const h=(0,l.Z)(c,[["render",i],["__scopeId","data-v-fdc49960"]]),y=h;u()(c,"components",{QSpinner:d.Z})},528:(t,e,o)=>{o.d(e,{Z:()=>u});var n=o(9835),s=o(6970);function a(t,e,o,a,r,i){const c=(0,n.up)("PostRenderer");return i.note?((0,n.wg)(),(0,n.j4)(c,{key:0,note:i.note},null,8,["note"])):r.decryptFailed?((0,n.wg)(),(0,n.iD)("span",{key:2,class:"decrypt-failed",onClick:e[1]||(e[1]=(...t)=>i.decrypt&&i.decrypt(...t))},(0,s.zw)(t.$t("Decryption failed")),1)):((0,n.wg)(),(0,n.iD)("span",{key:1,class:"click-to-decrypt",onClick:e[0]||(e[0]=t=>o.clickToDecrypt&&i.decrypt())},(0,s.zw)(t.$t("Click to decrypt")),1))}var r=o(3099),i=o(8500),c=o(4264);const l={name:"EncryptedMessage",components:{PostRenderer:i.Z},props:{message:{type:Object,required:!0},clickToDecrypt:{type:Boolean,default:!1}},setup(){return{app:(0,r.q)()}},data(){return{decryptFailed:!1}},computed:{note(){if(!this.message?.plaintext)return;const t=new c.Z(this.message.id,this.message);return t.content=this.message.plaintext,t}},methods:{async decrypt(){if(!this.message.plaintext)try{const t=this.message.id,e=this.message.author===this.app.myPubkey?this.message.recipient:this.message.author,o=await this.app.decryptMessage(e,this.message.content);this.message.id===t&&this.message.cachePlaintext(o)}catch(t){console.error("Failed to decrypt message",t),this.decryptFailed=!0}}},async mounted(){this.app.activeAccount.canDecrypt()&&await this.decrypt()},watch:{async message(){this.app.activeAccount.canDecrypt()&&await this.decrypt()}}};var d=o(1639);const p=(0,d.Z)(l,[["render",a],["__scopeId","data-v-4b8c32d4"]]),u=p},9010:(t,e,o)=>{o.d(e,{Z:()=>u});var n=o(9835),s=o(6970);const a={key:0},r={class:"addon"};function i(t,e,o,i,c,l){const d=(0,n.up)("base-icon");return(0,n.wg)(),(0,n.iD)("div",{class:(0,s.C_)(["page-header",{dense:t.dense}])},[t.backButton?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"back-button",onClick:e[0]||(e[0]=e=>t.$router.go(-1))},[(0,n.Wm)(d,{icon:"back"})])):(0,n.kq)("",!0),(0,n._)("div",{class:(0,s.C_)({"profile-info":!!t.subline})},[(0,n.WI)(t.$slots,"default",{},(()=>[(0,n._)("h2",null,(0,s.zw)(t.$t(t.title||t.titleFromRoute()||"Home")),1),t.subline?((0,n.wg)(),(0,n.iD)("span",a,(0,s.zw)(t.subline),1)):(0,n.kq)("",!0)]))],2),(0,n._)("div",r,[(0,n.WI)(t.$slots,"addon")])],2)}var c=o(7664);const l=(0,n.aZ)({name:"PageHeader",components:{BaseIcon:c.Z},props:{title:{type:String,default:void 0},subline:{type:String,default:void 0},backButton:{type:Boolean,default:!1},logo:{type:Boolean,default:!1},dense:{type:Boolean,default:!1}},methods:{titleFromRoute(){const t=this.$route.name?.toLowerCase();return t?.charAt(0).toUpperCase()+t?.substring(1)}}});var d=o(1639);const p=(0,d.Z)(l,[["render",i]]),u=p},2051:(t,e,o)=>{o.d(e,{Z:()=>d});var n=o(9835);const s={class:"thread"};function a(t,e,o,a,r,i){const c=(0,n.up)("ListPost");return(0,n.wg)(),(0,n.iD)("div",s,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredThread,((t,e)=>((0,n.wg)(),(0,n.j4)(c,{key:t.id,note:t,"connector-top":i.filteredThread.length>1&&e>0,"connector-bottom":i.filteredThread.length>1&&e<i.filteredThread.length-1||o.forceBottomConnector,actions:"",clickable:""},null,8,["note","connector-top","connector-bottom"])))),128))])}var r=o(1533);const i={name:"Thread",components:{ListPost:r.Z},props:{thread:{type:Array,required:!0},forceBottomConnector:{type:Boolean,default:!1}},computed:{filteredThread(){return this.thread.filter((t=>!!t))}}};var c=o(1639);const l=(0,c.Z)(i,[["render",a],["__scopeId","data-v-70ea85be"]]),d=l},384:(t,e,o)=>{o.d(e,{Z:()=>H});var n=o(9835);const s={class:"thread"};function a(t,e,o,a,r,i){const c=(0,n.up)("ListPost");return(0,n.wg)(),(0,n.iD)("div",s,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredThread,((t,e)=>((0,n.wg)(),(0,n.j4)(c,{key:t.id,note:t,"connector-top":i.filteredThread.length>1&&e>0,"connector-bottom":i.filteredThread.length>1&&e<i.filteredThread.length-1||o.forceBottomConnector,raw:o.raw,actions:"",clickable:"",ref_for:!0,ref:"ListPost"},null,8,["note","connector-top","connector-bottom","raw"])))),128))])}var r=o(6970),i=o(1957);const c=t=>((0,n.dD)("data-v-bb97ac0e"),t=t(),(0,n.Cn)(),t),l={class:"post-author"},d={class:"connector-top"},p={key:0,class:"connector-line"},u={class:"connector-bottom"},h={key:0,class:"connector-line"},y={class:"post-content"},m={class:"post-content-header"},g={class:"author-line"},b=c((()=>(0,n._)("span",null,"Â·",-1))),f={class:"created-at"},k={key:0,class:"in-reply-to"},w={class:"post-content-body"};function v(t,e,o,s,a,c){const v=(0,n.up)("UserAvatar"),_=(0,n.up)("UserName"),Z=(0,n.up)("PostRenderer"),T=(0,n.up)("q-btn"),C=(0,n.up)("json-viewer");return(0,n.wg)(),(0,n.iD)("div",{class:(0,r.C_)(["post",{clickable:o.clickable,myPubkeybg:s.app.myPubkey==o.note.author}]),onClick:e[6]||(e[6]=(0,i.iM)((e=>o.clickable&&t.goToThread(o.note.id)),["stop"]))},[(0,n._)("div",l,[(0,n._)("div",d,[o.connectorTop?((0,n.wg)(),(0,n.iD)("div",p)):(0,n.kq)("",!0)]),(0,n.Wm)(v,{pubkey:o.note.author,clickable:"",onClick:e[0]||(e[0]=(0,i.iM)((()=>{}),["stop"]))},null,8,["pubkey"]),(0,n._)("div",u,[o.connectorBottom?((0,n.wg)(),(0,n.iD)("div",h)):(0,n.kq)("",!0)])]),(0,n._)("div",y,[(0,n._)("div",m,[(0,n._)("p",g,[(0,n.Wm)(_,{pubkey:o.note.author,clickable:"","show-verified":"",onClick:e[1]||(e[1]=(0,i.iM)((()=>{}),["stop"]))},null,8,["pubkey"]),b,(0,n._)("span",f,(0,r.zw)(c.createdAt),1)]),o.note.hasAncestor()?((0,n.wg)(),(0,n.iD)("p",k,[(0,n.Uk)((0,r.zw)(t.$t("Replying to"))+" ",1),(0,n._)("a",{onClick:e[2]||(e[2]=(0,i.iM)((e=>t.goToProfile(c.ancestor?.author)),["stop"]))},[c.ancestor?.author?((0,n.wg)(),(0,n.j4)(_,{key:0,pubkey:c.ancestor?.author},null,8,["pubkey"])):(0,n.kq)("",!0)])])):(0,n.kq)("",!0)]),(0,n._)("div",w,[(0,n.Wm)(Z,{note:o.note},null,8,["note"])]),s.formState.opendata?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(T,{key:0,color:"primary",size:"sm",onClick:e[3]||(e[3]=(0,i.iM)((t=>c.openToggle()),["stop"])),label:"raw data",class:"qbtn-style","icon-right":"arrow_drop_down"})),s.formState.opendata?((0,n.wg)(),(0,n.j4)(T,{key:1,color:"primary",size:"sm",onClick:e[4]||(e[4]=(0,i.iM)((t=>c.openToggle()),["stop"])),label:"raw data",class:"qbtn-style","icon-right":"arrow_drop_up"})):(0,n.kq)("",!0),s.formState.opendata?((0,n.wg)(),(0,n.j4)(C,{key:2,value:o.note,clickable:"",onClick:e[5]||(e[5]=(0,i.iM)((()=>{}),["stop"])),theme:"my-awesome-json-theme"},null,8,["value"])):(0,n.kq)("",!0)])],2)}var _=o(499),Z=o(8803),T=o.n(Z),C=o(5501),P=o(9715),q=o(8500),D=o(8993),B=o(3099),S=o(6166),$=o(2929),A=o(2296),F=o(4520),j=o(1153);const I={name:"ListPost",mixins:[$.Z],components:{PostActions:D.Z,UserAvatar:C.Z,UserName:P.Z,PostRenderer:q.Z,JsonViewer:T()},props:{note:{type:Object,required:!0},connectorTop:{type:Boolean,default:!1},connectorBottom:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},actions:{type:Boolean,default:!1},raw:Boolean},setup(t){const e=(0,_.qj)({opendata:!1});return(0,n.YP)((()=>t.raw),(t=>{console.log("newProps.raw--------",t),e.opendata=t})),{app:(0,B.q)(),nostr:(0,S.D)(),formState:e}},data(){return{refreshCounter:0,refreshTimer:null,metadataDialog:!1,noteStr:"",CopyStr:""}},computed:{ancestor(){return this.note.hasAncestor()?this.nostr.getNote(this.note.ancestor()):null},showActions(){return this.actions&&this.note.canReply()},createdAt(){return this.refreshCounter,this.formatPostDate(this.note.createdAt)}},methods:{openToggle(){this.formState.opendata=!this.formState.opendata},formatPostDate(t){const e=this.$q.screen.lt.md?"short":"long";return A.Z.formatFromNow(t,e)},info(){this.metadataDialog=!0,console.log("str----",this.note.id);let t=(0,F.Sk)(this.nostr.getNote(this.note.id)),e=JSON.stringify(this.nostr.getNote(this.note.id));console.log("str----",this.nostr.getNote(this.note.id)),this.noteStr=t,this.CopyStr=e},async copystr(t){t&&(console.log("str----",t),await navigator.clipboard.writeText(t).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})})))},async del(){const t=j.Z["delete"](this.note,this.app.myPubkey).build();t.id=this.note.id,console.log("event--------------------",t),await this.app.signEvent(t)&&(await this.nostr.publish(t)||this.$q.notify({message:$t("Failed to publish reaction"),color:"negative"}))},async copyNoteId(){const t=(0,F.jm)(this.note.id,"note");await navigator.clipboard.writeText(t).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})}))},async copyUserId(){const t=(0,F.jm)(this.note.author,"npub");await navigator.clipboard.writeText(t).then((()=>{this.$q.notify({message:"Replication Success",color:"positive",timeout:1e3,position:"top"})}))}},mounted(){const t=A.Z.now()-this.note.createdAt>=3600?3600:60;this.refreshTimer=setInterval((()=>this.refreshCounter++),1e3*t)},unmounted(){clearInterval(this.refreshTimer)}};var M=o(1639),N=o(8879),z=o(9984),R=o.n(z);const L=(0,M.Z)(I,[["render",v],["__scopeId","data-v-bb97ac0e"]]),W=L;R()(I,"components",{QBtn:N.Z});const x={name:"Thread",components:{ListPost:W},props:{thread:{type:Array,required:!0},forceBottomConnector:{type:Boolean,default:!1},raw:Boolean},setup(t){(0,n.YP)((()=>t.raw),(t=>{}))},computed:{filteredThread(){return this.thread.filter((t=>!!t))}}},U=(0,M.Z)(x,[["render",a],["__scopeId","data-v-51f7054e"]]),H=U}}]);